(function(){const t=document.createElement("link").relList;if(t&&t.supports&&t.supports("modulepreload"))return;for(const r of document.querySelectorAll('link[rel="modulepreload"]'))n(r);new MutationObserver(r=>{for(const s of r)if(s.type==="childList")for(const o of s.addedNodes)o.tagName==="LINK"&&o.rel==="modulepreload"&&n(o)}).observe(document,{childList:!0,subtree:!0});function e(r){const s={};return r.integrity&&(s.integrity=r.integrity),r.referrerPolicy&&(s.referrerPolicy=r.referrerPolicy),r.crossOrigin==="use-credentials"?s.credentials="include":r.crossOrigin==="anonymous"?s.credentials="omit":s.credentials="same-origin",s}function n(r){if(r.ep)return;r.ep=!0;const s=e(r);fetch(r.href,s)}})();function et(i,t,e,n){return new(e||(e=Promise))(function(r,s){function o(l){try{c(n.next(l))}catch(u){s(u)}}function a(l){try{c(n.throw(l))}catch(u){s(u)}}function c(l){var u;l.done?r(l.value):(u=l.value,u instanceof e?u:new e(function(d){d(u)})).then(o,a)}c((n=n.apply(i,t||[])).next())})}let yi=class{constructor(){this.listeners={}}on(t,e,n){if(this.listeners[t]||(this.listeners[t]=new Set),this.listeners[t].add(e),n==null?void 0:n.once){const r=()=>{this.un(t,r),this.un(t,e)};return this.on(t,r),r}return()=>this.un(t,e)}un(t,e){var n;(n=this.listeners[t])===null||n===void 0||n.delete(e)}once(t,e){return this.on(t,e,{once:!0})}unAll(){this.listeners={}}emit(t,...e){this.listeners[t]&&this.listeners[t].forEach(n=>n(...e))}};const Wr={decode:function(i,t){return et(this,void 0,void 0,function*(){const e=new AudioContext({sampleRate:t});return e.decodeAudioData(i).finally(()=>e.close())})},createBuffer:function(i,t){return typeof i[0]=="number"&&(i=[i]),function(e){const n=e[0];if(n.some(r=>r>1||r<-1)){const r=n.length;let s=0;for(let o=0;o<r;o++){const a=Math.abs(n[o]);a>s&&(s=a)}for(const o of e)for(let a=0;a<r;a++)o[a]/=s}}(i),{duration:t,length:i[0].length,sampleRate:i[0].length/t,numberOfChannels:i.length,getChannelData:e=>i==null?void 0:i[e],copyFromChannel:AudioBuffer.prototype.copyFromChannel,copyToChannel:AudioBuffer.prototype.copyToChannel}}};function _s(i,t){const e=t.xmlns?document.createElementNS(t.xmlns,i):document.createElement(i);for(const[n,r]of Object.entries(t))if(n==="children")for(const[s,o]of Object.entries(t))typeof o=="string"?e.appendChild(document.createTextNode(o)):e.appendChild(_s(s,o));else n==="style"?Object.assign(e.style,r):n==="textContent"?e.textContent=r:e.setAttribute(n,r.toString());return e}function Yr(i,t,e){const n=_s(i,t||{});return e==null||e.appendChild(n),n}var La=Object.freeze({__proto__:null,createElement:Yr,default:Yr});const Ea={fetchBlob:function(i,t,e){return et(this,void 0,void 0,function*(){const n=yield fetch(i,e);if(n.status>=400)throw new Error(`Failed to fetch ${i}: ${n.status} (${n.statusText})`);return function(r,s){et(this,void 0,void 0,function*(){if(!r.body||!r.headers)return;const o=r.body.getReader(),a=Number(r.headers.get("Content-Length"))||0;let c=0;const l=d=>et(this,void 0,void 0,function*(){c+=(d==null?void 0:d.length)||0;const p=Math.round(c/a*100);s(p)}),u=()=>et(this,void 0,void 0,function*(){let d;try{d=yield o.read()}catch{return}d.done||(l(d.value),yield u())});u()})}(n.clone(),t),n.blob()})}};class Na extends yi{constructor(t){super(),this.isExternalMedia=!1,t.media?(this.media=t.media,this.isExternalMedia=!0):this.media=document.createElement("audio"),t.mediaControls&&(this.media.controls=!0),t.autoplay&&(this.media.autoplay=!0),t.playbackRate!=null&&this.onMediaEvent("canplay",()=>{t.playbackRate!=null&&(this.media.playbackRate=t.playbackRate)},{once:!0})}onMediaEvent(t,e,n){return this.media.addEventListener(t,e,n),()=>this.media.removeEventListener(t,e,n)}getSrc(){return this.media.currentSrc||this.media.src||""}revokeSrc(){const t=this.getSrc();t.startsWith("blob:")&&URL.revokeObjectURL(t)}canPlayType(t){return this.media.canPlayType(t)!==""}setSrc(t,e){const n=this.getSrc();if(t&&n===t)return;this.revokeSrc();const r=e instanceof Blob&&(this.canPlayType(e.type)||!t)?URL.createObjectURL(e):t;try{this.media.src=r}catch{this.media.src=t}}destroy(){this.media.pause(),this.isExternalMedia||(this.media.remove(),this.revokeSrc(),this.media.src="",this.media.load())}setMediaElement(t){this.media=t}play(){return et(this,void 0,void 0,function*(){return this.media.play()})}pause(){this.media.pause()}isPlaying(){return!this.media.paused&&!this.media.ended}setTime(t){this.media.currentTime=t}getDuration(){return this.media.duration}getCurrentTime(){return this.media.currentTime}getVolume(){return this.media.volume}setVolume(t){this.media.volume=t}getMuted(){return this.media.muted}setMuted(t){this.media.muted=t}getPlaybackRate(){return this.media.playbackRate}isSeeking(){return this.media.seeking}setPlaybackRate(t,e){e!=null&&(this.media.preservesPitch=e),this.media.playbackRate=t}getMediaElement(){return this.media}setSinkId(t){return this.media.setSinkId(t)}}let Rn=class Un extends yi{constructor(t,e){super(),this.timeouts=[],this.isScrollable=!1,this.audioData=null,this.resizeObserver=null,this.lastContainerWidth=0,this.isDragging=!1,this.subscriptions=[],this.subscriptions=[],this.options=t;const n=this.parentFromOptionsContainer(t.container);this.parent=n;const[r,s]=this.initHtml();n.appendChild(r),this.container=r,this.scrollContainer=s.querySelector(".scroll"),this.wrapper=s.querySelector(".wrapper"),this.canvasWrapper=s.querySelector(".canvases"),this.progressWrapper=s.querySelector(".progress"),this.cursor=s.querySelector(".cursor"),e&&s.appendChild(e),this.initEvents()}parentFromOptionsContainer(t){let e;if(typeof t=="string"?e=document.querySelector(t):t instanceof HTMLElement&&(e=t),!e)throw new Error("Container not found");return e}initEvents(){const t=e=>{const n=this.wrapper.getBoundingClientRect(),r=e.clientX-n.left,s=e.clientY-n.top;return[r/n.width,s/n.height]};if(this.wrapper.addEventListener("click",e=>{const[n,r]=t(e);this.emit("click",n,r)}),this.wrapper.addEventListener("dblclick",e=>{const[n,r]=t(e);this.emit("dblclick",n,r)}),this.options.dragToSeek!==!0&&typeof this.options.dragToSeek!="object"||this.initDrag(),this.scrollContainer.addEventListener("scroll",()=>{const{scrollLeft:e,scrollWidth:n,clientWidth:r}=this.scrollContainer,s=e/n,o=(e+r)/n;this.emit("scroll",s,o,e,e+r)}),typeof ResizeObserver=="function"){const e=this.createDelay(100);this.resizeObserver=new ResizeObserver(()=>{e().then(()=>this.onContainerResize()).catch(()=>{})}),this.resizeObserver.observe(this.scrollContainer)}}onContainerResize(){const t=this.parent.clientWidth;t===this.lastContainerWidth&&this.options.height!=="auto"||(this.lastContainerWidth=t,this.reRender())}initDrag(){this.subscriptions.push(function(t,e,n,r,s=3,o=0,a=100){if(!t)return()=>{};const c=matchMedia("(pointer: coarse)").matches;let l=()=>{};const u=d=>{if(d.button!==o)return;d.preventDefault(),d.stopPropagation();let p=d.clientX,f=d.clientY,y=!1;const G=Date.now(),V=z=>{if(z.preventDefault(),z.stopPropagation(),c&&Date.now()-G<a)return;const tt=z.clientX,ft=z.clientY,wt=tt-p,Dt=ft-f;if(y||Math.abs(wt)>s||Math.abs(Dt)>s){const Et=t.getBoundingClientRect(),{left:ti,top:Vr}=Et;y||(n==null||n(p-ti,f-Vr),y=!0),e(wt,Dt,tt-ti,ft-Vr),p=tt,f=ft}},F=z=>{if(y){const tt=z.clientX,ft=z.clientY,wt=t.getBoundingClientRect(),{left:Dt,top:Et}=wt;r==null||r(tt-Dt,ft-Et)}l()},Z=z=>{z.relatedTarget&&z.relatedTarget!==document.documentElement||F(z)},_t=z=>{y&&(z.stopPropagation(),z.preventDefault())},R=z=>{y&&z.preventDefault()};document.addEventListener("pointermove",V),document.addEventListener("pointerup",F),document.addEventListener("pointerout",Z),document.addEventListener("pointercancel",Z),document.addEventListener("touchmove",R,{passive:!1}),document.addEventListener("click",_t,{capture:!0}),l=()=>{document.removeEventListener("pointermove",V),document.removeEventListener("pointerup",F),document.removeEventListener("pointerout",Z),document.removeEventListener("pointercancel",Z),document.removeEventListener("touchmove",R),setTimeout(()=>{document.removeEventListener("click",_t,{capture:!0})},10)}};return t.addEventListener("pointerdown",u),()=>{l(),t.removeEventListener("pointerdown",u)}}(this.wrapper,(t,e,n)=>{this.emit("drag",Math.max(0,Math.min(1,n/this.wrapper.getBoundingClientRect().width)))},t=>{this.isDragging=!0,this.emit("dragstart",Math.max(0,Math.min(1,t/this.wrapper.getBoundingClientRect().width)))},t=>{this.isDragging=!1,this.emit("dragend",Math.max(0,Math.min(1,t/this.wrapper.getBoundingClientRect().width)))}))}getHeight(t,e){var n;const r=((n=this.audioData)===null||n===void 0?void 0:n.numberOfChannels)||1;if(t==null)return 128;if(!isNaN(Number(t)))return Number(t);if(t==="auto"){const s=this.parent.clientHeight||128;return e!=null&&e.every(o=>!o.overlay)?s/r:s}return 128}initHtml(){const t=document.createElement("div"),e=t.attachShadow({mode:"open"});return e.innerHTML=`
      <style>
        :host {
          user-select: none;
          min-width: 1px;
        }
        :host audio {
          display: block;
          width: 100%;
        }
        :host .scroll {
          overflow-x: auto;
          overflow-y: hidden;
          width: 100%;
          position: relative;
        }
        :host .noScrollbar {
          scrollbar-color: transparent;
          scrollbar-width: none;
        }
        :host .noScrollbar::-webkit-scrollbar {
          display: none;
          -webkit-appearance: none;
        }
        :host .wrapper {
          position: relative;
          overflow: visible;
          z-index: 2;
        }
        :host .canvases {
          min-height: ${this.getHeight(this.options.height,this.options.splitChannels)}px;
        }
        :host .canvases > div {
          position: relative;
        }
        :host canvas {
          display: block;
          position: absolute;
          top: 0;
          image-rendering: pixelated;
        }
        :host .progress {
          pointer-events: none;
          position: absolute;
          z-index: 2;
          top: 0;
          left: 0;
          width: 0;
          height: 100%;
          overflow: hidden;
        }
        :host .progress > div {
          position: relative;
        }
        :host .cursor {
          pointer-events: none;
          position: absolute;
          z-index: 5;
          top: 0;
          left: 0;
          height: 100%;
          border-radius: 2px;
        }
      </style>

      <div class="scroll" part="scroll">
        <div class="wrapper" part="wrapper">
          <div class="canvases" part="canvases"></div>
          <div class="progress" part="progress"></div>
          <div class="cursor" part="cursor"></div>
        </div>
      </div>
    `,[t,e]}setOptions(t){if(this.options.container!==t.container){const e=this.parentFromOptionsContainer(t.container);e.appendChild(this.container),this.parent=e}t.dragToSeek!==!0&&typeof this.options.dragToSeek!="object"||this.initDrag(),this.options=t,this.reRender()}getWrapper(){return this.wrapper}getWidth(){return this.scrollContainer.clientWidth}getScroll(){return this.scrollContainer.scrollLeft}setScroll(t){this.scrollContainer.scrollLeft=t}setScrollPercentage(t){const{scrollWidth:e}=this.scrollContainer,n=e*t;this.setScroll(n)}destroy(){var t,e;this.subscriptions.forEach(n=>n()),this.container.remove(),(t=this.resizeObserver)===null||t===void 0||t.disconnect(),(e=this.unsubscribeOnScroll)===null||e===void 0||e.call(this)}createDelay(t=10){let e,n;const r=()=>{e&&clearTimeout(e),n&&n()};return this.timeouts.push(r),()=>new Promise((s,o)=>{r(),n=o,e=setTimeout(()=>{e=void 0,n=void 0,s()},t)})}convertColorValues(t){if(!Array.isArray(t))return t||"";if(t.length<2)return t[0]||"";const e=document.createElement("canvas"),n=e.getContext("2d"),r=e.height*(window.devicePixelRatio||1),s=n.createLinearGradient(0,0,0,r),o=1/(t.length-1);return t.forEach((a,c)=>{const l=c*o;s.addColorStop(l,a)}),s}getPixelRatio(){return Math.max(1,window.devicePixelRatio||1)}renderBarWaveform(t,e,n,r){const s=t[0],o=t[1]||t[0],a=s.length,{width:c,height:l}=n.canvas,u=l/2,d=this.getPixelRatio(),p=e.barWidth?e.barWidth*d:1,f=e.barGap?e.barGap*d:e.barWidth?p/2:0,y=e.barRadius||0,G=c/(p+f)/a,V=y&&"roundRect"in n?"roundRect":"rect";n.beginPath();let F=0,Z=0,_t=0;for(let R=0;R<=a;R++){const z=Math.round(R*G);if(z>F){const wt=Math.round(Z*u*r),Dt=wt+Math.round(_t*u*r)||1;let Et=u-wt;e.barAlign==="top"?Et=0:e.barAlign==="bottom"&&(Et=l-Dt),n[V](F*(p+f),Et,p,Dt,y),F=z,Z=0,_t=0}const tt=Math.abs(s[R]||0),ft=Math.abs(o[R]||0);tt>Z&&(Z=tt),ft>_t&&(_t=ft)}n.fill(),n.closePath()}renderLineWaveform(t,e,n,r){const s=o=>{const a=t[o]||t[0],c=a.length,{height:l}=n.canvas,u=l/2,d=n.canvas.width/c;n.moveTo(0,u);let p=0,f=0;for(let y=0;y<=c;y++){const G=Math.round(y*d);if(G>p){const F=u+(Math.round(f*u*r)||1)*(o===0?-1:1);n.lineTo(p,F),p=G,f=0}const V=Math.abs(a[y]||0);V>f&&(f=V)}n.lineTo(p,u)};n.beginPath(),s(0),s(1),n.fill(),n.closePath()}renderWaveform(t,e,n){if(n.fillStyle=this.convertColorValues(e.waveColor),e.renderFunction)return void e.renderFunction(t,n);let r=e.barHeight||1;if(e.normalize){const s=Array.from(t[0]).reduce((o,a)=>Math.max(o,Math.abs(a)),0);r=s?1/s:1}e.barWidth||e.barGap||e.barAlign?this.renderBarWaveform(t,e,n,r):this.renderLineWaveform(t,e,n,r)}renderSingleCanvas(t,e,n,r,s,o,a){const c=this.getPixelRatio(),l=document.createElement("canvas");l.width=Math.round(n*c),l.height=Math.round(r*c),l.style.width=`${n}px`,l.style.height=`${r}px`,l.style.left=`${Math.round(s)}px`,o.appendChild(l);const u=l.getContext("2d");if(this.renderWaveform(t,e,u),l.width>0&&l.height>0){const d=l.cloneNode(),p=d.getContext("2d");p.drawImage(l,0,0),p.globalCompositeOperation="source-in",p.fillStyle=this.convertColorValues(e.progressColor),p.fillRect(0,0,l.width,l.height),a.appendChild(d)}}renderMultiCanvas(t,e,n,r,s,o){const a=this.getPixelRatio(),{clientWidth:c}=this.scrollContainer;if(c*a>=n)return void this.renderSingleCanvas(t,e,c,r,0,s,o);const l=n/a;let u=Math.min(Un.MAX_CANVAS_WIDTH,c,l),d={};if(e.barWidth||e.barGap){const V=e.barWidth||.5,F=V+(e.barGap||V/2);u%F!=0&&(u=Math.floor(u/F)*F)}const p=V=>{if(V<0||V>=f||d[V])return;d[V]=!0;const F=V*u,Z=Math.min(l-F,u);if(Z<=0)return;const _t=t.map(R=>{const z=Math.floor(F/l*R.length),tt=Math.floor((F+Z)/l*R.length);return R.slice(z,tt)});this.renderSingleCanvas(_t,e,Z,r,F,s,o)},f=Math.ceil(l/u),y=this.scrollContainer.scrollLeft/l,G=Math.floor(y*f);p(G-1),p(G),p(G+1),f>1&&(this.unsubscribeOnScroll=this.on("scroll",()=>{const{scrollLeft:V}=this.scrollContainer,F=Math.floor(V/l*f);Object.keys(d).length>Un.MAX_NODES&&(s.innerHTML="",o.innerHTML="",d={}),p(F-1),p(F),p(F+1)}))}renderChannel(t,e,n,r){var{overlay:s}=e,o=function(u,d){var p={};for(var f in u)Object.prototype.hasOwnProperty.call(u,f)&&d.indexOf(f)<0&&(p[f]=u[f]);if(u!=null&&typeof Object.getOwnPropertySymbols=="function"){var y=0;for(f=Object.getOwnPropertySymbols(u);y<f.length;y++)d.indexOf(f[y])<0&&Object.prototype.propertyIsEnumerable.call(u,f[y])&&(p[f[y]]=u[f[y]])}return p}(e,["overlay"]);const a=document.createElement("div"),c=this.getHeight(o.height,o.splitChannels);a.style.height=`${c}px`,s&&r>0&&(a.style.marginTop=`-${c}px`),this.canvasWrapper.style.minHeight=`${c}px`,this.canvasWrapper.appendChild(a);const l=a.cloneNode();this.progressWrapper.appendChild(l),this.renderMultiCanvas(t,o,n,c,a,l)}render(t){return et(this,void 0,void 0,function*(){var e;this.timeouts.forEach(c=>c()),this.timeouts=[],this.canvasWrapper.innerHTML="",this.progressWrapper.innerHTML="",this.options.width!=null&&(this.scrollContainer.style.width=typeof this.options.width=="number"?`${this.options.width}px`:this.options.width);const n=this.getPixelRatio(),r=this.scrollContainer.clientWidth,s=Math.ceil(t.duration*(this.options.minPxPerSec||0));this.isScrollable=s>r;const o=this.options.fillParent&&!this.isScrollable,a=(o?r:s)*n;if(this.wrapper.style.width=o?"100%":`${s}px`,this.scrollContainer.style.overflowX=this.isScrollable?"auto":"hidden",this.scrollContainer.classList.toggle("noScrollbar",!!this.options.hideScrollbar),this.cursor.style.backgroundColor=`${this.options.cursorColor||this.options.progressColor}`,this.cursor.style.width=`${this.options.cursorWidth}px`,this.audioData=t,this.emit("render"),this.options.splitChannels)for(let c=0;c<t.numberOfChannels;c++){const l=Object.assign(Object.assign({},this.options),(e=this.options.splitChannels)===null||e===void 0?void 0:e[c]);this.renderChannel([t.getChannelData(c)],l,a,c)}else{const c=[t.getChannelData(0)];t.numberOfChannels>1&&c.push(t.getChannelData(1)),this.renderChannel(c,this.options,a,0)}Promise.resolve().then(()=>this.emit("rendered"))})}reRender(){var t;if((t=this.unsubscribeOnScroll)===null||t===void 0||t.call(this),delete this.unsubscribeOnScroll,!this.audioData)return;const{scrollWidth:e}=this.scrollContainer,{right:n}=this.progressWrapper.getBoundingClientRect();if(this.render(this.audioData),this.isScrollable&&e!==this.scrollContainer.scrollWidth){const{right:r}=this.progressWrapper.getBoundingClientRect();let s=r-n;s*=2,s=s<0?Math.floor(s):Math.ceil(s),s/=2,this.scrollContainer.scrollLeft+=s}}zoom(t){this.options.minPxPerSec=t,this.reRender()}scrollIntoView(t,e=!1){const{scrollLeft:n,scrollWidth:r,clientWidth:s}=this.scrollContainer,o=t*r,a=n,c=n+s,l=s/2;if(this.isDragging)o+30>c?this.scrollContainer.scrollLeft+=30:o-30<a&&(this.scrollContainer.scrollLeft-=30);else{(o<a||o>c)&&(this.scrollContainer.scrollLeft=o-(this.options.autoCenter?l:0));const u=o-n-l;e&&this.options.autoCenter&&u>0&&(this.scrollContainer.scrollLeft+=Math.min(u,10))}{const u=this.scrollContainer.scrollLeft,d=u/r,p=(u+s)/r;this.emit("scroll",d,p,u,u+s)}}renderProgress(t,e){if(isNaN(t))return;const n=100*t;this.canvasWrapper.style.clipPath=`polygon(${n}% 0, 100% 0, 100% 100%, ${n}% 100%)`,this.progressWrapper.style.width=`${n}%`,this.cursor.style.left=`${n}%`,this.cursor.style.transform=`translateX(-${Math.round(n)===100?this.options.cursorWidth:0}px)`,this.isScrollable&&this.options.autoScroll&&this.scrollIntoView(t,e)}exportImage(t,e,n){return et(this,void 0,void 0,function*(){const r=this.canvasWrapper.querySelectorAll("canvas");if(!r.length)throw new Error("No waveform data");if(n==="dataURL"){const s=Array.from(r).map(o=>o.toDataURL(t,e));return Promise.resolve(s)}return Promise.all(Array.from(r).map(s=>new Promise((o,a)=>{s.toBlob(c=>{c?o(c):a(new Error("Could not export image"))},t,e)})))})}};Rn.MAX_CANVAS_WIDTH=8e3,Rn.MAX_NODES=10;let xa=class extends yi{constructor(){super(...arguments),this.unsubscribe=()=>{}}start(){this.unsubscribe=this.on("tick",()=>{requestAnimationFrame(()=>{this.emit("tick")})}),this.emit("tick")}stop(){this.unsubscribe()}destroy(){this.unsubscribe()}},Hr=class extends yi{constructor(t=new AudioContext){super(),this.bufferNode=null,this.playStartTime=0,this.playedDuration=0,this._muted=!1,this._playbackRate=1,this._duration=void 0,this.buffer=null,this.currentSrc="",this.paused=!0,this.crossOrigin=null,this.seeking=!1,this.autoplay=!1,this.addEventListener=this.on,this.removeEventListener=this.un,this.audioContext=t,this.gainNode=this.audioContext.createGain(),this.gainNode.connect(this.audioContext.destination)}load(){return et(this,void 0,void 0,function*(){})}get src(){return this.currentSrc}set src(t){if(this.currentSrc=t,this._duration=void 0,!t)return this.buffer=null,void this.emit("emptied");fetch(t).then(e=>{if(e.status>=400)throw new Error(`Failed to fetch ${t}: ${e.status} (${e.statusText})`);return e.arrayBuffer()}).then(e=>this.currentSrc!==t?null:this.audioContext.decodeAudioData(e)).then(e=>{this.currentSrc===t&&(this.buffer=e,this.emit("loadedmetadata"),this.emit("canplay"),this.autoplay&&this.play())})}_play(){var t;if(!this.paused)return;this.paused=!1,(t=this.bufferNode)===null||t===void 0||t.disconnect(),this.bufferNode=this.audioContext.createBufferSource(),this.buffer&&(this.bufferNode.buffer=this.buffer),this.bufferNode.playbackRate.value=this._playbackRate,this.bufferNode.connect(this.gainNode);let e=this.playedDuration*this._playbackRate;e>=this.duration&&(e=0,this.playedDuration=0),this.bufferNode.start(this.audioContext.currentTime,e),this.playStartTime=this.audioContext.currentTime,this.bufferNode.onended=()=>{this.currentTime>=this.duration&&(this.pause(),this.emit("ended"))}}_pause(){var t;this.paused=!0,(t=this.bufferNode)===null||t===void 0||t.stop(),this.playedDuration+=this.audioContext.currentTime-this.playStartTime}play(){return et(this,void 0,void 0,function*(){this.paused&&(this._play(),this.emit("play"))})}pause(){this.paused||(this._pause(),this.emit("pause"))}stopAt(t){var e,n;const r=t-this.currentTime;(e=this.bufferNode)===null||e===void 0||e.stop(this.audioContext.currentTime+r),(n=this.bufferNode)===null||n===void 0||n.addEventListener("ended",()=>{this.bufferNode=null,this.pause()},{once:!0})}setSinkId(t){return et(this,void 0,void 0,function*(){return this.audioContext.setSinkId(t)})}get playbackRate(){return this._playbackRate}set playbackRate(t){this._playbackRate=t,this.bufferNode&&(this.bufferNode.playbackRate.value=t)}get currentTime(){return(this.paused?this.playedDuration:this.playedDuration+(this.audioContext.currentTime-this.playStartTime))*this._playbackRate}set currentTime(t){const e=!this.paused;e&&this._pause(),this.playedDuration=t/this._playbackRate,e&&this._play(),this.emit("seeking"),this.emit("timeupdate")}get duration(){var t,e;return(t=this._duration)!==null&&t!==void 0?t:((e=this.buffer)===null||e===void 0?void 0:e.duration)||0}set duration(t){this._duration=t}get volume(){return this.gainNode.gain.value}set volume(t){this.gainNode.gain.value=t,this.emit("volumechange")}get muted(){return this._muted}set muted(t){this._muted!==t&&(this._muted=t,this._muted?this.gainNode.disconnect():this.gainNode.connect(this.audioContext.destination))}canPlayType(t){return/^(audio|video)\//.test(t)}getGainNode(){return this.gainNode}getChannelData(){const t=[];if(!this.buffer)return t;const e=this.buffer.numberOfChannels;for(let n=0;n<e;n++)t.push(this.buffer.getChannelData(n));return t}};const Ra={waveColor:"#999",progressColor:"#555",cursorWidth:1,minPxPerSec:0,fillParent:!0,interact:!0,dragToSeek:!1,autoScroll:!0,autoCenter:!0,sampleRate:8e3};let kn=class ws extends Na{static create(t){return new ws(t)}constructor(t){const e=t.media||(t.backend==="WebAudio"?new Hr:void 0);super({media:e,mediaControls:t.mediaControls,autoplay:t.autoplay,playbackRate:t.audioRate}),this.plugins=[],this.decodedData=null,this.subscriptions=[],this.mediaSubscriptions=[],this.abortController=null,this.options=Object.assign({},Ra,t),this.timer=new xa;const n=e?void 0:this.getMediaElement();this.renderer=new Rn(this.options,n),this.initPlayerEvents(),this.initRendererEvents(),this.initTimerEvents(),this.initPlugins();const r=this.options.url||this.getSrc()||"";Promise.resolve().then(()=>{this.emit("init");const{peaks:s,duration:o}=this.options;(r||s&&o)&&this.load(r,s,o).catch(()=>null)})}updateProgress(t=this.getCurrentTime()){return this.renderer.renderProgress(t/this.getDuration(),this.isPlaying()),t}initTimerEvents(){this.subscriptions.push(this.timer.on("tick",()=>{if(!this.isSeeking()){const t=this.updateProgress();this.emit("timeupdate",t),this.emit("audioprocess",t)}}))}initPlayerEvents(){this.isPlaying()&&(this.emit("play"),this.timer.start()),this.mediaSubscriptions.push(this.onMediaEvent("timeupdate",()=>{const t=this.updateProgress();this.emit("timeupdate",t)}),this.onMediaEvent("play",()=>{this.emit("play"),this.timer.start()}),this.onMediaEvent("pause",()=>{this.emit("pause"),this.timer.stop()}),this.onMediaEvent("emptied",()=>{this.timer.stop()}),this.onMediaEvent("ended",()=>{this.emit("finish")}),this.onMediaEvent("seeking",()=>{this.emit("seeking",this.getCurrentTime())}),this.onMediaEvent("error",t=>{this.emit("error",t.error)}))}initRendererEvents(){this.subscriptions.push(this.renderer.on("click",(t,e)=>{this.options.interact&&(this.seekTo(t),this.emit("interaction",t*this.getDuration()),this.emit("click",t,e))}),this.renderer.on("dblclick",(t,e)=>{this.emit("dblclick",t,e)}),this.renderer.on("scroll",(t,e,n,r)=>{const s=this.getDuration();this.emit("scroll",t*s,e*s,n,r)}),this.renderer.on("render",()=>{this.emit("redraw")}),this.renderer.on("rendered",()=>{this.emit("redrawcomplete")}),this.renderer.on("dragstart",t=>{this.emit("dragstart",t)}),this.renderer.on("dragend",t=>{this.emit("dragend",t)}));{let t;this.subscriptions.push(this.renderer.on("drag",e=>{if(!this.options.interact)return;let n;this.renderer.renderProgress(e),clearTimeout(t),this.isPlaying()?n=0:this.options.dragToSeek===!0?n=200:typeof this.options.dragToSeek=="object"&&this.options.dragToSeek!==void 0&&(n=this.options.dragToSeek.debounceTime),t=setTimeout(()=>{this.seekTo(e)},n),this.emit("interaction",e*this.getDuration()),this.emit("drag",e)}))}}initPlugins(){var t;!((t=this.options.plugins)===null||t===void 0)&&t.length&&this.options.plugins.forEach(e=>{this.registerPlugin(e)})}unsubscribePlayerEvents(){this.mediaSubscriptions.forEach(t=>t()),this.mediaSubscriptions=[]}setOptions(t){this.options=Object.assign({},this.options,t),this.renderer.setOptions(this.options),t.audioRate&&this.setPlaybackRate(t.audioRate),t.mediaControls!=null&&(this.getMediaElement().controls=t.mediaControls)}registerPlugin(t){return t._init(this),this.plugins.push(t),this.subscriptions.push(t.once("destroy",()=>{this.plugins=this.plugins.filter(e=>e!==t)})),t}getWrapper(){return this.renderer.getWrapper()}getWidth(){return this.renderer.getWidth()}getScroll(){return this.renderer.getScroll()}setScroll(t){return this.renderer.setScroll(t)}setScrollTime(t){const e=t/this.getDuration();this.renderer.setScrollPercentage(e)}getActivePlugins(){return this.plugins}loadAudio(t,e,n,r){return et(this,void 0,void 0,function*(){var s;if(this.emit("load",t),!this.options.media&&this.isPlaying()&&this.pause(),this.decodedData=null,!e&&!n){const a=this.options.fetchParams||{};window.AbortController&&!a.signal&&(this.abortController=new AbortController,a.signal=(s=this.abortController)===null||s===void 0?void 0:s.signal);const c=l=>this.emit("loading",l);e=yield Ea.fetchBlob(t,c,a)}this.setSrc(t,e);const o=yield new Promise(a=>{const c=r||this.getDuration();c?a(c):this.mediaSubscriptions.push(this.onMediaEvent("loadedmetadata",()=>a(this.getDuration()),{once:!0}))});if(!t&&!e){const a=this.getMediaElement();a instanceof Hr&&(a.duration=o)}if(n)this.decodedData=Wr.createBuffer(n,o||0);else if(e){const a=yield e.arrayBuffer();this.decodedData=yield Wr.decode(a,this.options.sampleRate)}this.decodedData&&(this.emit("decode",this.getDuration()),this.renderer.render(this.decodedData)),this.emit("ready",this.getDuration())})}load(t,e,n){return et(this,void 0,void 0,function*(){try{return yield this.loadAudio(t,void 0,e,n)}catch(r){throw this.emit("error",r),r}})}loadBlob(t,e,n){return et(this,void 0,void 0,function*(){try{return yield this.loadAudio("",t,e,n)}catch(r){throw this.emit("error",r),r}})}zoom(t){if(!this.decodedData)throw new Error("No audio loaded");this.renderer.zoom(t),this.emit("zoom",t)}getDecodedData(){return this.decodedData}exportPeaks({channels:t=2,maxLength:e=8e3,precision:n=1e4}={}){if(!this.decodedData)throw new Error("The audio has not been decoded yet");const r=Math.min(t,this.decodedData.numberOfChannels),s=[];for(let o=0;o<r;o++){const a=this.decodedData.getChannelData(o),c=[],l=a.length/e;for(let u=0;u<e;u++){const d=a.slice(Math.floor(u*l),Math.ceil((u+1)*l));let p=0;for(let f=0;f<d.length;f++){const y=d[f];Math.abs(y)>Math.abs(p)&&(p=y)}c.push(Math.round(p*n)/n)}s.push(c)}return s}getDuration(){let t=super.getDuration()||0;return t!==0&&t!==1/0||!this.decodedData||(t=this.decodedData.duration),t}toggleInteraction(t){this.options.interact=t}setTime(t){super.setTime(t),this.updateProgress(t),this.emit("timeupdate",t)}seekTo(t){const e=this.getDuration()*t;this.setTime(e)}playPause(){return et(this,void 0,void 0,function*(){return this.isPlaying()?this.pause():this.play()})}stop(){this.pause(),this.setTime(0)}skip(t){this.setTime(this.getCurrentTime()+t)}empty(){this.load("",[[0]],.001)}setMediaElement(t){this.unsubscribePlayerEvents(),super.setMediaElement(t),this.initPlayerEvents()}exportImage(){return et(this,arguments,void 0,function*(t="image/png",e=1,n="dataURL"){return this.renderer.exportImage(t,e,n)})}destroy(){var t;this.emit("destroy"),(t=this.abortController)===null||t===void 0||t.abort(),this.plugins.forEach(e=>e.destroy()),this.subscriptions.forEach(e=>e()),this.unsubscribePlayerEvents(),this.timer.destroy(),this.renderer.destroy(),super.destroy()}};kn.BasePlugin=class extends yi{constructor(i){super(),this.subscriptions=[],this.options=i}onInit(){}_init(i){this.wavesurfer=i,this.onInit()}destroy(){this.emit("destroy"),this.subscriptions.forEach(i=>i())}},kn.dom=La;let Ss=class{constructor(){this.listeners={}}on(t,e,n){if(this.listeners[t]||(this.listeners[t]=new Set),this.listeners[t].add(e),n==null?void 0:n.once){const r=()=>{this.un(t,r),this.un(t,e)};return this.on(t,r),r}return()=>this.un(t,e)}un(t,e){var n;(n=this.listeners[t])===null||n===void 0||n.delete(e)}once(t,e){return this.on(t,e,{once:!0})}unAll(){this.listeners={}}emit(t,...e){this.listeners[t]&&this.listeners[t].forEach(n=>n(...e))}},Ua=class extends Ss{constructor(t){super(),this.subscriptions=[],this.options=t}onInit(){}_init(t){this.wavesurfer=t,this.onInit()}destroy(){this.emit("destroy"),this.subscriptions.forEach(t=>t())}};function Ti(i,t,e,n,r=3,s=0,o=100){if(!i)return()=>{};const a=matchMedia("(pointer: coarse)").matches;let c=()=>{};const l=u=>{if(u.button!==s)return;u.preventDefault(),u.stopPropagation();let d=u.clientX,p=u.clientY,f=!1;const y=Date.now(),G=R=>{if(R.preventDefault(),R.stopPropagation(),a&&Date.now()-y<o)return;const z=R.clientX,tt=R.clientY,ft=z-d,wt=tt-p;if(f||Math.abs(ft)>r||Math.abs(wt)>r){const Dt=i.getBoundingClientRect(),{left:Et,top:ti}=Dt;f||(e==null||e(d-Et,p-ti),f=!0),t(ft,wt,z-Et,tt-ti),d=z,p=tt}},V=R=>{if(f){const z=R.clientX,tt=R.clientY,ft=i.getBoundingClientRect(),{left:wt,top:Dt}=ft;n==null||n(z-wt,tt-Dt)}c()},F=R=>{R.relatedTarget&&R.relatedTarget!==document.documentElement||V(R)},Z=R=>{f&&(R.stopPropagation(),R.preventDefault())},_t=R=>{f&&R.preventDefault()};document.addEventListener("pointermove",G),document.addEventListener("pointerup",V),document.addEventListener("pointerout",F),document.addEventListener("pointercancel",F),document.addEventListener("touchmove",_t,{passive:!1}),document.addEventListener("click",Z,{capture:!0}),c=()=>{document.removeEventListener("pointermove",G),document.removeEventListener("pointerup",V),document.removeEventListener("pointerout",F),document.removeEventListener("pointercancel",F),document.removeEventListener("touchmove",_t),setTimeout(()=>{document.removeEventListener("click",Z,{capture:!0})},10)}};return i.addEventListener("pointerdown",l),()=>{c(),i.removeEventListener("pointerdown",l)}}function Is(i,t){const e=t.xmlns?document.createElementNS(t.xmlns,i):document.createElement(i);for(const[n,r]of Object.entries(t))if(n==="children")for(const[s,o]of Object.entries(t))typeof o=="string"?e.appendChild(document.createTextNode(o)):e.appendChild(Is(s,o));else n==="style"?Object.assign(e.style,r):n==="textContent"?e.textContent=r:e.setAttribute(n,r.toString());return e}function ii(i,t,e){const n=Is(i,t||{});return e==null||e.appendChild(n),n}let Jr=class extends Ss{constructor(t,e,n=0){var r,s,o,a,c,l,u,d;super(),this.totalDuration=e,this.numberOfChannels=n,this.minLength=0,this.maxLength=1/0,this.contentEditable=!1,this.subscriptions=[],this.subscriptions=[],this.id=t.id||`region-${Math.random().toString(32).slice(2)}`,this.start=this.clampPosition(t.start),this.end=this.clampPosition((r=t.end)!==null&&r!==void 0?r:t.start),this.drag=(s=t.drag)===null||s===void 0||s,this.resize=(o=t.resize)===null||o===void 0||o,this.color=(a=t.color)!==null&&a!==void 0?a:"rgba(0, 0, 0, 0.1)",this.minLength=(c=t.minLength)!==null&&c!==void 0?c:this.minLength,this.maxLength=(l=t.maxLength)!==null&&l!==void 0?l:this.maxLength,this.channelIdx=(u=t.channelIdx)!==null&&u!==void 0?u:-1,this.contentEditable=(d=t.contentEditable)!==null&&d!==void 0?d:this.contentEditable,this.element=this.initElement(),this.setContent(t.content),this.setPart(),this.renderPosition(),this.initMouseEvents()}clampPosition(t){return Math.max(0,Math.min(this.totalDuration,t))}setPart(){const t=this.start===this.end;this.element.setAttribute("part",`${t?"marker":"region"} ${this.id}`)}addResizeHandles(t){const e={position:"absolute",zIndex:"2",width:"6px",height:"100%",top:"0",cursor:"ew-resize",wordBreak:"keep-all"},n=ii("div",{part:"region-handle region-handle-left",style:Object.assign(Object.assign({},e),{left:"0",borderLeft:"2px solid rgba(0, 0, 0, 0.5)",borderRadius:"2px 0 0 2px"})},t),r=ii("div",{part:"region-handle region-handle-right",style:Object.assign(Object.assign({},e),{right:"0",borderRight:"2px solid rgba(0, 0, 0, 0.5)",borderRadius:"0 2px 2px 0"})},t);this.subscriptions.push(Ti(n,s=>this.onResize(s,"start"),()=>null,()=>this.onEndResizing(),1),Ti(r,s=>this.onResize(s,"end"),()=>null,()=>this.onEndResizing(),1))}removeResizeHandles(t){const e=t.querySelector('[part*="region-handle-left"]'),n=t.querySelector('[part*="region-handle-right"]');e&&t.removeChild(e),n&&t.removeChild(n)}initElement(){const t=this.start===this.end;let e=0,n=100;this.channelIdx>=0&&this.channelIdx<this.numberOfChannels&&(n=100/this.numberOfChannels,e=n*this.channelIdx);const r=ii("div",{style:{position:"absolute",top:`${e}%`,height:`${n}%`,backgroundColor:t?"none":this.color,borderLeft:t?"2px solid "+this.color:"none",borderRadius:"2px",boxSizing:"border-box",transition:"background-color 0.2s ease",cursor:this.drag?"grab":"default",pointerEvents:"all"}});return!t&&this.resize&&this.addResizeHandles(r),r}renderPosition(){const t=this.start/this.totalDuration,e=(this.totalDuration-this.end)/this.totalDuration;this.element.style.left=100*t+"%",this.element.style.right=100*e+"%"}toggleCursor(t){var e;this.drag&&(!((e=this.element)===null||e===void 0)&&e.style)&&(this.element.style.cursor=t?"grabbing":"grab")}initMouseEvents(){const{element:t}=this;t&&(t.addEventListener("click",e=>this.emit("click",e)),t.addEventListener("mouseenter",e=>this.emit("over",e)),t.addEventListener("mouseleave",e=>this.emit("leave",e)),t.addEventListener("dblclick",e=>this.emit("dblclick",e)),t.addEventListener("pointerdown",()=>this.toggleCursor(!0)),t.addEventListener("pointerup",()=>this.toggleCursor(!1)),this.subscriptions.push(Ti(t,e=>this.onMove(e),()=>this.toggleCursor(!0),()=>{this.toggleCursor(!1),this.drag&&this.emit("update-end")})),this.contentEditable&&this.content&&(this.content.addEventListener("click",e=>this.onContentClick(e)),this.content.addEventListener("blur",()=>this.onContentBlur())))}_onUpdate(t,e){if(!this.element.parentElement)return;const{width:n}=this.element.parentElement.getBoundingClientRect(),r=t/n*this.totalDuration,s=e&&e!=="start"?this.start:this.start+r,o=e&&e!=="end"?this.end:this.end+r,a=o-s;s>=0&&o<=this.totalDuration&&s<=o&&a>=this.minLength&&a<=this.maxLength&&(this.start=s,this.end=o,this.renderPosition(),this.emit("update",e))}onMove(t){this.drag&&this._onUpdate(t)}onResize(t,e){this.resize&&this._onUpdate(t,e)}onEndResizing(){this.resize&&this.emit("update-end")}onContentClick(t){t.stopPropagation(),t.target.focus(),this.emit("click",t)}onContentBlur(){this.emit("update-end")}_setTotalDuration(t){this.totalDuration=t,this.renderPosition()}play(){this.emit("play")}setContent(t){var e;if((e=this.content)===null||e===void 0||e.remove(),t){if(typeof t=="string"){const n=this.start===this.end;this.content=ii("div",{style:{padding:`0.2em ${n?.2:.4}em`,display:"inline-block"},textContent:t})}else this.content=t;this.contentEditable&&(this.content.contentEditable="true"),this.content.setAttribute("part","region-content"),this.element.appendChild(this.content)}else this.content=void 0}setOptions(t){var e,n;if(t.color&&(this.color=t.color,this.element.style.backgroundColor=this.color),t.drag!==void 0&&(this.drag=t.drag,this.element.style.cursor=this.drag?"grab":"default"),t.start!==void 0||t.end!==void 0){const r=this.start===this.end;this.start=this.clampPosition((e=t.start)!==null&&e!==void 0?e:this.start),this.end=this.clampPosition((n=t.end)!==null&&n!==void 0?n:r?this.start:this.end),this.renderPosition(),this.setPart()}if(t.content&&this.setContent(t.content),t.id&&(this.id=t.id,this.setPart()),t.resize!==void 0&&t.resize!==this.resize){const r=this.start===this.end;this.resize=t.resize,this.resize&&!r?this.addResizeHandles(this.element):this.removeResizeHandles(this.element)}}remove(){this.emit("remove"),this.subscriptions.forEach(t=>t()),this.element.remove(),this.element=null}};class nr extends Ua{constructor(t){super(t),this.regions=[],this.regionsContainer=this.initRegionsContainer()}static create(t){return new nr(t)}onInit(){if(!this.wavesurfer)throw Error("WaveSurfer is not initialized");this.wavesurfer.getWrapper().appendChild(this.regionsContainer);let t=[];this.subscriptions.push(this.wavesurfer.on("timeupdate",e=>{const n=this.regions.filter(r=>r.start<=e&&(r.end===r.start?r.start+.05:r.end)>=e);n.forEach(r=>{t.includes(r)||this.emit("region-in",r)}),t.forEach(r=>{n.includes(r)||this.emit("region-out",r)}),t=n}))}initRegionsContainer(){return ii("div",{style:{position:"absolute",top:"0",left:"0",width:"100%",height:"100%",zIndex:"3",pointerEvents:"none"}})}getRegions(){return this.regions}avoidOverlapping(t){t.content&&setTimeout(()=>{const e=t.content,n=e.getBoundingClientRect(),r=this.regions.map(s=>{if(s===t||!s.content)return 0;const o=s.content.getBoundingClientRect();return n.left<o.left+o.width&&o.left<n.left+n.width?o.height:0}).reduce((s,o)=>s+o,0);e.style.marginTop=`${r}px`},10)}adjustScroll(t){var e,n;const r=(n=(e=this.wavesurfer)===null||e===void 0?void 0:e.getWrapper())===null||n===void 0?void 0:n.parentElement;if(!r)return;const{clientWidth:s,scrollWidth:o}=r;if(o<=s)return;const a=r.getBoundingClientRect(),c=t.element.getBoundingClientRect(),l=c.left-a.left,u=c.right-a.left;l<0?r.scrollLeft+=l:u>s&&(r.scrollLeft+=u-s)}virtualAppend(t,e,n){const r=()=>{if(!this.wavesurfer)return;const s=this.wavesurfer.getWidth(),o=this.wavesurfer.getScroll(),a=e.clientWidth,c=this.wavesurfer.getDuration(),l=Math.round(t.start/c*a);l+(Math.round((t.end-t.start)/c*a)||1)>o&&l<o+s?e.appendChild(n):n.remove()};setTimeout(()=>{if(!this.wavesurfer)return;r();const s=this.wavesurfer.on("scroll",r);this.subscriptions.push(t.once("remove",s),s)},0)}saveRegion(t){this.virtualAppend(t,this.regionsContainer,t.element),this.avoidOverlapping(t),this.regions.push(t);const e=[t.on("update",n=>{n||this.adjustScroll(t),this.emit("region-update",t,n)}),t.on("update-end",()=>{this.avoidOverlapping(t),this.emit("region-updated",t)}),t.on("play",()=>{var n,r;(n=this.wavesurfer)===null||n===void 0||n.play(),(r=this.wavesurfer)===null||r===void 0||r.setTime(t.start)}),t.on("click",n=>{this.emit("region-clicked",t,n)}),t.on("dblclick",n=>{this.emit("region-double-clicked",t,n)}),t.once("remove",()=>{e.forEach(n=>n()),this.regions=this.regions.filter(n=>n!==t),this.emit("region-removed",t)})];this.subscriptions.push(...e),this.emit("region-created",t)}addRegion(t){var e,n;if(!this.wavesurfer)throw Error("WaveSurfer is not initialized");const r=this.wavesurfer.getDuration(),s=(n=(e=this.wavesurfer)===null||e===void 0?void 0:e.getDecodedData())===null||n===void 0?void 0:n.numberOfChannels,o=new Jr(t,r,s);return r?this.saveRegion(o):this.subscriptions.push(this.wavesurfer.once("ready",a=>{o._setTotalDuration(a),this.saveRegion(o)})),o}enableDragSelection(t,e=3){var n;const r=(n=this.wavesurfer)===null||n===void 0?void 0:n.getWrapper();if(!(r&&r instanceof HTMLElement))return()=>{};let s=null,o=0;return Ti(r,(a,c,l)=>{s&&s._onUpdate(a,l>o?"end":"start")},a=>{var c,l;if(o=a,!this.wavesurfer)return;const u=this.wavesurfer.getDuration(),d=(l=(c=this.wavesurfer)===null||c===void 0?void 0:c.getDecodedData())===null||l===void 0?void 0:l.numberOfChannels,{width:p}=this.wavesurfer.getWrapper().getBoundingClientRect(),f=a/p*u,y=(a+5)/p*u;s=new Jr(Object.assign(Object.assign({},t),{start:f,end:y}),u,d),this.regionsContainer.appendChild(s.element)},()=>{s&&(this.saveRegion(s),s=null)},e)}clearRegions(){this.regions.forEach(t=>t.remove())}destroy(){this.clearRegions(),super.destroy(),this.regionsContainer.remove()}}function ka(i){return i&&i.__esModule&&Object.prototype.hasOwnProperty.call(i,"default")?i.default:i}var Bs={exports:{}},k={};/** @license React v16.13.1
 * react-is.production.min.js
 *
 * Copyright (c) Facebook, Inc. and its affiliates.
 *
 * This source code is licensed under the MIT license found in the
 * LICENSE file in the root directory of this source tree.
 */var Q=typeof Symbol=="function"&&Symbol.for,rr=Q?Symbol.for("react.element"):60103,sr=Q?Symbol.for("react.portal"):60106,pn=Q?Symbol.for("react.fragment"):60107,yn=Q?Symbol.for("react.strict_mode"):60108,mn=Q?Symbol.for("react.profiler"):60114,gn=Q?Symbol.for("react.provider"):60109,bn=Q?Symbol.for("react.context"):60110,or=Q?Symbol.for("react.async_mode"):60111,vn=Q?Symbol.for("react.concurrent_mode"):60111,_n=Q?Symbol.for("react.forward_ref"):60112,wn=Q?Symbol.for("react.suspense"):60113,Pa=Q?Symbol.for("react.suspense_list"):60120,Sn=Q?Symbol.for("react.memo"):60115,In=Q?Symbol.for("react.lazy"):60116,za=Q?Symbol.for("react.block"):60121,$a=Q?Symbol.for("react.fundamental"):60117,ja=Q?Symbol.for("react.responder"):60118,Va=Q?Symbol.for("react.scope"):60119;function vt(i){if(typeof i=="object"&&i!==null){var t=i.$$typeof;switch(t){case rr:switch(i=i.type,i){case or:case vn:case pn:case mn:case yn:case wn:return i;default:switch(i=i&&i.$$typeof,i){case bn:case _n:case In:case Sn:case gn:return i;default:return t}}case sr:return t}}}function Os(i){return vt(i)===vn}k.AsyncMode=or;k.ConcurrentMode=vn;k.ContextConsumer=bn;k.ContextProvider=gn;k.Element=rr;k.ForwardRef=_n;k.Fragment=pn;k.Lazy=In;k.Memo=Sn;k.Portal=sr;k.Profiler=mn;k.StrictMode=yn;k.Suspense=wn;k.isAsyncMode=function(i){return Os(i)||vt(i)===or};k.isConcurrentMode=Os;k.isContextConsumer=function(i){return vt(i)===bn};k.isContextProvider=function(i){return vt(i)===gn};k.isElement=function(i){return typeof i=="object"&&i!==null&&i.$$typeof===rr};k.isForwardRef=function(i){return vt(i)===_n};k.isFragment=function(i){return vt(i)===pn};k.isLazy=function(i){return vt(i)===In};k.isMemo=function(i){return vt(i)===Sn};k.isPortal=function(i){return vt(i)===sr};k.isProfiler=function(i){return vt(i)===mn};k.isStrictMode=function(i){return vt(i)===yn};k.isSuspense=function(i){return vt(i)===wn};k.isValidElementType=function(i){return typeof i=="string"||typeof i=="function"||i===pn||i===vn||i===mn||i===yn||i===wn||i===Pa||typeof i=="object"&&i!==null&&(i.$$typeof===In||i.$$typeof===Sn||i.$$typeof===gn||i.$$typeof===bn||i.$$typeof===_n||i.$$typeof===$a||i.$$typeof===ja||i.$$typeof===Va||i.$$typeof===za)};k.typeOf=vt;Bs.exports=k;var Wa=Bs.exports,As=Wa,Ya={$$typeof:!0,render:!0,defaultProps:!0,displayName:!0,propTypes:!0},Ha={$$typeof:!0,compare:!0,defaultProps:!0,displayName:!0,propTypes:!0,type:!0},Ds={};Ds[As.ForwardRef]=Ya;Ds[As.Memo]=Ha;var Fs={exports:{}},P={};/*
object-assign
(c) Sindre Sorhus
@license MIT
*/var Gr=Object.getOwnPropertySymbols,Ja=Object.prototype.hasOwnProperty,Ga=Object.prototype.propertyIsEnumerable;function qa(i){if(i==null)throw new TypeError("Object.assign cannot be called with null or undefined");return Object(i)}function Ka(){try{if(!Object.assign)return!1;var i=new String("abc");if(i[5]="de",Object.getOwnPropertyNames(i)[0]==="5")return!1;for(var t={},e=0;e<10;e++)t["_"+String.fromCharCode(e)]=e;var n=Object.getOwnPropertyNames(t).map(function(s){return t[s]});if(n.join("")!=="0123456789")return!1;var r={};return"abcdefghijklmnopqrst".split("").forEach(function(s){r[s]=s}),Object.keys(Object.assign({},r)).join("")==="abcdefghijklmnopqrst"}catch{return!1}}var Xa=Ka()?Object.assign:function(i,t){for(var e,n=qa(i),r,s=1;s<arguments.length;s++){e=Object(arguments[s]);for(var o in e)Ja.call(e,o)&&(n[o]=e[o]);if(Gr){r=Gr(e);for(var a=0;a<r.length;a++)Ga.call(e,r[a])&&(n[r[a]]=e[r[a]])}}return n};/** @license React v16.14.0
 * react.production.min.js
 *
 * Copyright (c) Facebook, Inc. and its affiliates.
 *
 * This source code is licensed under the MIT license found in the
 * LICENSE file in the root directory of this source tree.
 */var ar=Xa,Ct=typeof Symbol=="function"&&Symbol.for,mi=Ct?Symbol.for("react.element"):60103,Za=Ct?Symbol.for("react.portal"):60106,Qa=Ct?Symbol.for("react.fragment"):60107,tc=Ct?Symbol.for("react.strict_mode"):60108,ec=Ct?Symbol.for("react.profiler"):60114,ic=Ct?Symbol.for("react.provider"):60109,nc=Ct?Symbol.for("react.context"):60110,rc=Ct?Symbol.for("react.forward_ref"):60112,sc=Ct?Symbol.for("react.suspense"):60113,oc=Ct?Symbol.for("react.memo"):60115,ac=Ct?Symbol.for("react.lazy"):60116,qr=typeof Symbol=="function"&&Symbol.iterator;function gi(i){for(var t="https://reactjs.org/docs/error-decoder.html?invariant="+i,e=1;e<arguments.length;e++)t+="&args[]="+encodeURIComponent(arguments[e]);return"Minified React error #"+i+"; visit "+t+" for the full message or use the non-minified dev environment for full errors and additional helpful warnings."}var Ts={isMounted:function(){return!1},enqueueForceUpdate:function(){},enqueueReplaceState:function(){},enqueueSetState:function(){}},Ms={};function Xe(i,t,e){this.props=i,this.context=t,this.refs=Ms,this.updater=e||Ts}Xe.prototype.isReactComponent={};Xe.prototype.setState=function(i,t){if(typeof i!="object"&&typeof i!="function"&&i!=null)throw Error(gi(85));this.updater.enqueueSetState(this,i,t,"setState")};Xe.prototype.forceUpdate=function(i){this.updater.enqueueForceUpdate(this,i,"forceUpdate")};function Cs(){}Cs.prototype=Xe.prototype;function cr(i,t,e){this.props=i,this.context=t,this.refs=Ms,this.updater=e||Ts}var lr=cr.prototype=new Cs;lr.constructor=cr;ar(lr,Xe.prototype);lr.isPureReactComponent=!0;var ur={current:null},Ls=Object.prototype.hasOwnProperty,Es={key:!0,ref:!0,__self:!0,__source:!0};function Ns(i,t,e){var n,r={},s=null,o=null;if(t!=null)for(n in t.ref!==void 0&&(o=t.ref),t.key!==void 0&&(s=""+t.key),t)Ls.call(t,n)&&!Es.hasOwnProperty(n)&&(r[n]=t[n]);var a=arguments.length-2;if(a===1)r.children=e;else if(1<a){for(var c=Array(a),l=0;l<a;l++)c[l]=arguments[l+2];r.children=c}if(i&&i.defaultProps)for(n in a=i.defaultProps,a)r[n]===void 0&&(r[n]=a[n]);return{$$typeof:mi,type:i,key:s,ref:o,props:r,_owner:ur.current}}function cc(i,t){return{$$typeof:mi,type:i.type,key:t,ref:i.ref,props:i.props,_owner:i._owner}}function hr(i){return typeof i=="object"&&i!==null&&i.$$typeof===mi}function lc(i){var t={"=":"=0",":":"=2"};return"$"+(""+i).replace(/[=:]/g,function(e){return t[e]})}var xs=/\/+/g,Ui=[];function Rs(i,t,e,n){if(Ui.length){var r=Ui.pop();return r.result=i,r.keyPrefix=t,r.func=e,r.context=n,r.count=0,r}return{result:i,keyPrefix:t,func:e,context:n,count:0}}function Us(i){i.result=null,i.keyPrefix=null,i.func=null,i.context=null,i.count=0,10>Ui.length&&Ui.push(i)}function Pn(i,t,e,n){var r=typeof i;(r==="undefined"||r==="boolean")&&(i=null);var s=!1;if(i===null)s=!0;else switch(r){case"string":case"number":s=!0;break;case"object":switch(i.$$typeof){case mi:case Za:s=!0}}if(s)return e(n,i,t===""?"."+Fn(i,0):t),1;if(s=0,t=t===""?".":t+":",Array.isArray(i))for(var o=0;o<i.length;o++){r=i[o];var a=t+Fn(r,o);s+=Pn(r,a,e,n)}else if(i===null||typeof i!="object"?a=null:(a=qr&&i[qr]||i["@@iterator"],a=typeof a=="function"?a:null),typeof a=="function")for(i=a.call(i),o=0;!(r=i.next()).done;)r=r.value,a=t+Fn(r,o++),s+=Pn(r,a,e,n);else if(r==="object")throw e=""+i,Error(gi(31,e==="[object Object]"?"object with keys {"+Object.keys(i).join(", ")+"}":e,""));return s}function zn(i,t,e){return i==null?0:Pn(i,"",t,e)}function Fn(i,t){return typeof i=="object"&&i!==null&&i.key!=null?lc(i.key):t.toString(36)}function uc(i,t){i.func.call(i.context,t,i.count++)}function hc(i,t,e){var n=i.result,r=i.keyPrefix;i=i.func.call(i.context,t,i.count++),Array.isArray(i)?$n(i,n,e,function(s){return s}):i!=null&&(hr(i)&&(i=cc(i,r+(!i.key||t&&t.key===i.key?"":(""+i.key).replace(xs,"$&/")+"/")+e)),n.push(i))}function $n(i,t,e,n,r){var s="";e!=null&&(s=(""+e).replace(xs,"$&/")+"/"),t=Rs(t,s,n,r),zn(i,hc,t),Us(t)}var ks={current:null};function re(){var i=ks.current;if(i===null)throw Error(gi(321));return i}var dc={ReactCurrentDispatcher:ks,ReactCurrentBatchConfig:{suspense:null},ReactCurrentOwner:ur,IsSomeRendererActing:{current:!1},assign:ar};P.Children={map:function(i,t,e){if(i==null)return i;var n=[];return $n(i,n,null,t,e),n},forEach:function(i,t,e){if(i==null)return i;t=Rs(null,null,t,e),zn(i,uc,t),Us(t)},count:function(i){return zn(i,function(){return null},null)},toArray:function(i){var t=[];return $n(i,t,null,function(e){return e}),t},only:function(i){if(!hr(i))throw Error(gi(143));return i}};P.Component=Xe;P.Fragment=Qa;P.Profiler=ec;P.PureComponent=cr;P.StrictMode=tc;P.Suspense=sc;P.__SECRET_INTERNALS_DO_NOT_USE_OR_YOU_WILL_BE_FIRED=dc;P.cloneElement=function(i,t,e){if(i==null)throw Error(gi(267,i));var n=ar({},i.props),r=i.key,s=i.ref,o=i._owner;if(t!=null){if(t.ref!==void 0&&(s=t.ref,o=ur.current),t.key!==void 0&&(r=""+t.key),i.type&&i.type.defaultProps)var a=i.type.defaultProps;for(c in t)Ls.call(t,c)&&!Es.hasOwnProperty(c)&&(n[c]=t[c]===void 0&&a!==void 0?a[c]:t[c])}var c=arguments.length-2;if(c===1)n.children=e;else if(1<c){a=Array(c);for(var l=0;l<c;l++)a[l]=arguments[l+2];n.children=a}return{$$typeof:mi,type:i.type,key:r,ref:s,props:n,_owner:o}};P.createContext=function(i,t){return t===void 0&&(t=null),i={$$typeof:nc,_calculateChangedBits:t,_currentValue:i,_currentValue2:i,_threadCount:0,Provider:null,Consumer:null},i.Provider={$$typeof:ic,_context:i},i.Consumer=i};P.createElement=Ns;P.createFactory=function(i){var t=Ns.bind(null,i);return t.type=i,t};P.createRef=function(){return{current:null}};P.forwardRef=function(i){return{$$typeof:rc,render:i}};P.isValidElement=hr;P.lazy=function(i){return{$$typeof:ac,_ctor:i,_status:-1,_result:null}};P.memo=function(i,t){return{$$typeof:oc,type:i,compare:t===void 0?null:t}};P.useCallback=function(i,t){return re().useCallback(i,t)};P.useContext=function(i,t){return re().useContext(i,t)};P.useDebugValue=function(){};P.useEffect=function(i,t){return re().useEffect(i,t)};P.useImperativeHandle=function(i,t,e){return re().useImperativeHandle(i,t,e)};P.useLayoutEffect=function(i,t){return re().useLayoutEffect(i,t)};P.useMemo=function(i,t){return re().useMemo(i,t)};P.useReducer=function(i,t,e){return re().useReducer(i,t,e)};P.useRef=function(i){return re().useRef(i)};P.useState=function(i){return re().useState(i)};P.version="16.14.0";Fs.exports=P;var fc=Fs.exports;const pc=ka(fc);function m(i,t,e,n){function r(s){return s instanceof e?s:new e(function(o){o(s)})}return new(e||(e=Promise))(function(s,o){function a(u){try{l(n.next(u))}catch(d){o(d)}}function c(u){try{l(n.throw(u))}catch(d){o(d)}}function l(u){u.done?s(u.value):r(u.value).then(a,c)}l((n=n.apply(i,t||[])).next())})}function Kr(i){var t=typeof Symbol=="function"&&Symbol.iterator,e=t&&i[t],n=0;if(e)return e.call(i);if(i&&typeof i.length=="number")return{next:function(){return i&&n>=i.length&&(i=void 0),{value:i&&i[n++],done:!i}}};throw new TypeError(t?"Object is not iterable.":"Symbol.iterator is not defined.")}function A(i){return this instanceof A?(this.v=i,this):new A(i)}function Vt(i,t,e){if(!Symbol.asyncIterator)throw new TypeError("Symbol.asyncIterator is not defined.");var n=e.apply(i,t||[]),r,s=[];return r={},a("next"),a("throw"),a("return",o),r[Symbol.asyncIterator]=function(){return this},r;function o(f){return function(y){return Promise.resolve(y).then(f,d)}}function a(f,y){n[f]&&(r[f]=function(G){return new Promise(function(V,F){s.push([f,G,V,F])>1||c(f,G)})},y&&(r[f]=y(r[f])))}function c(f,y){try{l(n[f](y))}catch(G){p(s[0][3],G)}}function l(f){f.value instanceof A?Promise.resolve(f.value.v).then(u,d):p(s[0][2],f)}function u(f){c("next",f)}function d(f){c("throw",f)}function p(f,y){f(y),s.shift(),s.length&&c(s[0][0],s[0][1])}}function Mi(i){var t,e;return t={},n("next"),n("throw",function(r){throw r}),n("return"),t[Symbol.iterator]=function(){return this},t;function n(r,s){t[r]=i[r]?function(o){return(e=!e)?{value:A(i[r](o)),done:!1}:s?s(o):o}:s}}function Fe(i){if(!Symbol.asyncIterator)throw new TypeError("Symbol.asyncIterator is not defined.");var t=i[Symbol.asyncIterator],e;return t?t.call(i):(i=typeof Kr=="function"?Kr(i):i[Symbol.iterator](),e={},n("next"),n("throw"),n("return"),e[Symbol.asyncIterator]=function(){return this},e);function n(s){e[s]=i[s]&&function(o){return new Promise(function(a,c){o=i[s](o),r(a,c,o.done,o.value)})}}function r(s,o,a,c){Promise.resolve(c).then(function(l){s({value:l,done:a})},o)}}const yc=new TextDecoder("utf-8"),jn=i=>yc.decode(i),mc=new TextEncoder,dr=i=>mc.encode(i),[fh,gc]=(()=>{const i=()=>{throw new Error("BigInt is not available in this environment")};function t(){throw i()}return t.asIntN=()=>{throw i()},t.asUintN=()=>{throw i()},typeof BigInt<"u"?[BigInt,!0]:[t,!1]})(),[bi,ph]=(()=>{const i=()=>{throw new Error("BigInt64Array is not available in this environment")};class t{static get BYTES_PER_ELEMENT(){return 8}static of(){throw i()}static from(){throw i()}constructor(){throw i()}}return typeof BigInt64Array<"u"?[BigInt64Array,!0]:[t,!1]})(),[vi,yh]=(()=>{const i=()=>{throw new Error("BigUint64Array is not available in this environment")};class t{static get BYTES_PER_ELEMENT(){return 8}static of(){throw i()}static from(){throw i()}constructor(){throw i()}}return typeof BigUint64Array<"u"?[BigUint64Array,!0]:[t,!1]})(),bc=i=>typeof i=="number",Ps=i=>typeof i=="boolean",K=i=>typeof i=="function",ut=i=>i!=null&&Object(i)===i,he=i=>ut(i)&&K(i.then),_i=i=>ut(i)&&K(i[Symbol.iterator]),Ze=i=>ut(i)&&K(i[Symbol.asyncIterator]),Vn=i=>ut(i)&&ut(i.schema),zs=i=>ut(i)&&"done"in i&&"value"in i,$s=i=>ut(i)&&K(i.stat)&&bc(i.fd),js=i=>ut(i)&&fr(i.body),Bn=i=>"_getDOMStream"in i&&"_getNodeStream"in i,vc=i=>ut(i)&&K(i.abort)&&K(i.getWriter)&&!Bn(i),fr=i=>ut(i)&&K(i.cancel)&&K(i.getReader)&&!Bn(i),_c=i=>ut(i)&&K(i.end)&&K(i.write)&&Ps(i.writable)&&!Bn(i),Vs=i=>ut(i)&&K(i.read)&&K(i.pipe)&&Ps(i.readable)&&!Bn(i),wc=i=>ut(i)&&K(i.clear)&&K(i.bytes)&&K(i.position)&&K(i.setPosition)&&K(i.capacity)&&K(i.getBufferIdentifier)&&K(i.createLong),pr=typeof SharedArrayBuffer<"u"?SharedArrayBuffer:ArrayBuffer;function Sc(i){const t=i[0]?[i[0]]:[];let e,n,r,s;for(let o,a,c=0,l=0,u=i.length;++c<u;){if(o=t[l],a=i[c],!o||!a||o.buffer!==a.buffer||a.byteOffset<o.byteOffset){a&&(t[++l]=a);continue}if({byteOffset:e,byteLength:r}=o,{byteOffset:n,byteLength:s}=a,e+r<n||n+s<e){a&&(t[++l]=a);continue}t[l]=new Uint8Array(o.buffer,e,n-e+s)}return t}function Xr(i,t,e=0,n=t.byteLength){const r=i.byteLength,s=new Uint8Array(i.buffer,i.byteOffset,r),o=new Uint8Array(t.buffer,t.byteOffset,Math.min(n,r));return s.set(o,e),i}function Yt(i,t){const e=Sc(i),n=e.reduce((u,d)=>u+d.byteLength,0);let r,s,o,a=0,c=-1;const l=Math.min(t||Number.POSITIVE_INFINITY,n);for(const u=e.length;++c<u;){if(r=e[c],s=r.subarray(0,Math.min(r.length,l-a)),l<=a+s.length){s.length<r.length?e[c]=r.subarray(s.length):s.length===r.length&&c++,o?Xr(o,s,a):o=s;break}Xr(o||(o=new Uint8Array(l)),s,a),a+=s.length}return[o||new Uint8Array(0),e.slice(c),n-(o?o.byteLength:0)]}function $(i,t){let e=zs(t)?t.value:t;return e instanceof i?i===Uint8Array?new i(e.buffer,e.byteOffset,e.byteLength):e:e?(typeof e=="string"&&(e=dr(e)),e instanceof ArrayBuffer?new i(e):e instanceof pr?new i(e):wc(e)?$(i,e.bytes()):ArrayBuffer.isView(e)?e.byteLength<=0?new i(0):new i(e.buffer,e.byteOffset,e.byteLength/i.BYTES_PER_ELEMENT):i.from(e)):new i(0)}const ei=i=>$(Int32Array,i),C=i=>$(Uint8Array,i),Wn=i=>(i.next(),i);function*Ic(i,t){const e=function*(r){yield r},n=typeof t=="string"||ArrayBuffer.isView(t)||t instanceof ArrayBuffer||t instanceof pr?e(t):_i(t)?t:e(t);return yield*Wn(function*(r){let s=null;do s=r.next(yield $(i,s));while(!s.done)}(n[Symbol.iterator]())),new i}const Bc=i=>Ic(Uint8Array,i);function Ws(i,t){return Vt(this,arguments,function*(){if(he(t))return yield A(yield A(yield*Mi(Fe(Ws(i,yield A(t))))));const n=function(o){return Vt(this,arguments,function*(){yield yield A(yield A(o))})},r=function(o){return Vt(this,arguments,function*(){yield A(yield*Mi(Fe(Wn(function*(a){let c=null;do c=a.next(yield c==null?void 0:c.value);while(!c.done)}(o[Symbol.iterator]())))))})},s=typeof t=="string"||ArrayBuffer.isView(t)||t instanceof ArrayBuffer||t instanceof pr?n(t):_i(t)?r(t):Ze(t)?t:n(t);return yield A(yield*Mi(Fe(Wn(function(o){return Vt(this,arguments,function*(){let a=null;do a=yield A(o.next(yield yield A($(i,a))));while(!a.done)})}(s[Symbol.asyncIterator]()))))),yield A(new i)})}const Oc=i=>Ws(Uint8Array,i);function yr(i,t,e){if(i!==0){e=e.slice(0,t+1);for(let n=-1;++n<=t;)e[n]+=i}return e}function Ac(i,t){let e=0;const n=i.length;if(n!==t.length)return!1;if(n>0)do if(i[e]!==t[e])return!1;while(++e<n);return!0}const It={fromIterable(i){return Oi(Dc(i))},fromAsyncIterable(i){return Oi(Fc(i))},fromDOMStream(i){return Oi(Tc(i))},fromNodeStream(i){return Oi(Cc(i))},toDOMStream(i,t){throw new Error('"toDOMStream" not available in this environment')},toNodeStream(i,t){throw new Error('"toNodeStream" not available in this environment')}},Oi=i=>(i.next(),i);function*Dc(i){let t,e=!1,n=[],r,s,o,a=0;function c(){return s==="peek"?Yt(n,o)[0]:([r,n,a]=Yt(n,o),r)}({cmd:s,size:o}=yield null);const l=Bc(i)[Symbol.iterator]();try{do if({done:t,value:r}=Number.isNaN(o-a)?l.next():l.next(o-a),!t&&r.byteLength>0&&(n.push(r),a+=r.byteLength),t||o<=a)do({cmd:s,size:o}=yield c());while(o<a);while(!t)}catch(u){(e=!0)&&typeof l.throw=="function"&&l.throw(u)}finally{e===!1&&typeof l.return=="function"&&l.return(null)}return null}function Fc(i){return Vt(this,arguments,function*(){let e,n=!1,r=[],s,o,a,c=0;function l(){return o==="peek"?Yt(r,a)[0]:([s,r,c]=Yt(r,a),s)}({cmd:o,size:a}=yield yield A(null));const u=Oc(i)[Symbol.asyncIterator]();try{do if({done:e,value:s}=Number.isNaN(a-c)?yield A(u.next()):yield A(u.next(a-c)),!e&&s.byteLength>0&&(r.push(s),c+=s.byteLength),e||a<=c)do({cmd:o,size:a}=yield yield A(l()));while(a<c);while(!e)}catch(d){(n=!0)&&typeof u.throw=="function"&&(yield A(u.throw(d)))}finally{n===!1&&typeof u.return=="function"&&(yield A(u.return(new Uint8Array(0))))}return yield A(null)})}function Tc(i){return Vt(this,arguments,function*(){let e=!1,n=!1,r=[],s,o,a,c=0;function l(){return o==="peek"?Yt(r,a)[0]:([s,r,c]=Yt(r,a),s)}({cmd:o,size:a}=yield yield A(null));const u=new Mc(i);try{do if({done:e,value:s}=Number.isNaN(a-c)?yield A(u.read()):yield A(u.read(a-c)),!e&&s.byteLength>0&&(r.push(C(s)),c+=s.byteLength),e||a<=c)do({cmd:o,size:a}=yield yield A(l()));while(a<c);while(!e)}catch(d){(n=!0)&&(yield A(u.cancel(d)))}finally{n===!1?yield A(u.cancel()):i.locked&&u.releaseLock()}return yield A(null)})}class Mc{constructor(t){this.source=t,this.reader=null,this.reader=this.source.getReader(),this.reader.closed.catch(()=>{})}get closed(){return this.reader?this.reader.closed.catch(()=>{}):Promise.resolve()}releaseLock(){this.reader&&this.reader.releaseLock(),this.reader=null}cancel(t){return m(this,void 0,void 0,function*(){const{reader:e,source:n}=this;e&&(yield e.cancel(t).catch(()=>{})),n&&n.locked&&this.releaseLock()})}read(t){return m(this,void 0,void 0,function*(){if(t===0)return{done:this.reader==null,value:new Uint8Array(0)};const e=yield this.reader.read();return!e.done&&(e.value=C(e)),e})}}const Tn=(i,t)=>{const e=r=>n([t,r]);let n;return[t,e,new Promise(r=>(n=r)&&i.once(t,e))]};function Cc(i){return Vt(this,arguments,function*(){const e=[];let n="error",r=!1,s=null,o,a,c=0,l=[],u;function d(){return o==="peek"?Yt(l,a)[0]:([u,l,c]=Yt(l,a),u)}if({cmd:o,size:a}=yield yield A(null),i.isTTY)return yield yield A(new Uint8Array(0)),yield A(null);try{e[0]=Tn(i,"end"),e[1]=Tn(i,"error");do{if(e[2]=Tn(i,"readable"),[n,s]=yield A(Promise.race(e.map(f=>f[2]))),n==="error")break;if((r=n==="end")||(Number.isFinite(a-c)?(u=C(i.read(a-c)),u.byteLength<a-c&&(u=C(i.read()))):u=C(i.read()),u.byteLength>0&&(l.push(u),c+=u.byteLength)),r||a<=c)do({cmd:o,size:a}=yield yield A(d()));while(a<c)}while(!r)}finally{yield A(p(e,n==="error"?s:null))}return yield A(null);function p(f,y){return u=l=null,new Promise((G,V)=>{for(const[F,Z]of f)i.off(F,Z);try{const F=i.destroy;F&&F.call(i,y),y=void 0}catch(F){y=F||y}finally{y!=null?V(y):G()}})}})}var mt;(function(i){i[i.V1=0]="V1",i[i.V2=1]="V2",i[i.V3=2]="V3",i[i.V4=3]="V4",i[i.V5=4]="V5"})(mt||(mt={}));var gt;(function(i){i[i.Sparse=0]="Sparse",i[i.Dense=1]="Dense"})(gt||(gt={}));var lt;(function(i){i[i.HALF=0]="HALF",i[i.SINGLE=1]="SINGLE",i[i.DOUBLE=2]="DOUBLE"})(lt||(lt={}));var ne;(function(i){i[i.DAY=0]="DAY",i[i.MILLISECOND=1]="MILLISECOND"})(ne||(ne={}));var L;(function(i){i[i.SECOND=0]="SECOND",i[i.MILLISECOND=1]="MILLISECOND",i[i.MICROSECOND=2]="MICROSECOND",i[i.NANOSECOND=3]="NANOSECOND"})(L||(L={}));var de;(function(i){i[i.YEAR_MONTH=0]="YEAR_MONTH",i[i.DAY_TIME=1]="DAY_TIME",i[i.MONTH_DAY_NANO=2]="MONTH_DAY_NANO"})(de||(de={}));var E;(function(i){i[i.NONE=0]="NONE",i[i.Schema=1]="Schema",i[i.DictionaryBatch=2]="DictionaryBatch",i[i.RecordBatch=3]="RecordBatch",i[i.Tensor=4]="Tensor",i[i.SparseTensor=5]="SparseTensor"})(E||(E={}));var h;(function(i){i[i.NONE=0]="NONE",i[i.Null=1]="Null",i[i.Int=2]="Int",i[i.Float=3]="Float",i[i.Binary=4]="Binary",i[i.Utf8=5]="Utf8",i[i.Bool=6]="Bool",i[i.Decimal=7]="Decimal",i[i.Date=8]="Date",i[i.Time=9]="Time",i[i.Timestamp=10]="Timestamp",i[i.Interval=11]="Interval",i[i.List=12]="List",i[i.Struct=13]="Struct",i[i.Union=14]="Union",i[i.FixedSizeBinary=15]="FixedSizeBinary",i[i.FixedSizeList=16]="FixedSizeList",i[i.Map=17]="Map",i[i.Dictionary=-1]="Dictionary",i[i.Int8=-2]="Int8",i[i.Int16=-3]="Int16",i[i.Int32=-4]="Int32",i[i.Int64=-5]="Int64",i[i.Uint8=-6]="Uint8",i[i.Uint16=-7]="Uint16",i[i.Uint32=-8]="Uint32",i[i.Uint64=-9]="Uint64",i[i.Float16=-10]="Float16",i[i.Float32=-11]="Float32",i[i.Float64=-12]="Float64",i[i.DateDay=-13]="DateDay",i[i.DateMillisecond=-14]="DateMillisecond",i[i.TimestampSecond=-15]="TimestampSecond",i[i.TimestampMillisecond=-16]="TimestampMillisecond",i[i.TimestampMicrosecond=-17]="TimestampMicrosecond",i[i.TimestampNanosecond=-18]="TimestampNanosecond",i[i.TimeSecond=-19]="TimeSecond",i[i.TimeMillisecond=-20]="TimeMillisecond",i[i.TimeMicrosecond=-21]="TimeMicrosecond",i[i.TimeNanosecond=-22]="TimeNanosecond",i[i.DenseUnion=-23]="DenseUnion",i[i.SparseUnion=-24]="SparseUnion",i[i.IntervalDayTime=-25]="IntervalDayTime",i[i.IntervalYearMonth=-26]="IntervalYearMonth"})(h||(h={}));var Kt;(function(i){i[i.OFFSET=0]="OFFSET",i[i.DATA=1]="DATA",i[i.VALIDITY=2]="VALIDITY",i[i.TYPE=3]="TYPE"})(Kt||(Kt={}));const Lc=void 0;function ci(i){if(i===null)return"null";if(i===Lc)return"undefined";switch(typeof i){case"number":return`${i}`;case"bigint":return`${i}`;case"string":return`"${i}"`}return typeof i[Symbol.toPrimitive]=="function"?i[Symbol.toPrimitive]("string"):ArrayBuffer.isView(i)?i instanceof bi||i instanceof vi?`[${[...i].map(t=>ci(t))}]`:`[${i}]`:ArrayBuffer.isView(i)?`[${i}]`:JSON.stringify(i,(t,e)=>typeof e=="bigint"?`${e}`:e)}const Ec=Symbol.for("isArrowBigNum");function Lt(i,...t){return t.length===0?Object.setPrototypeOf($(this.TypedArray,i),this.constructor.prototype):Object.setPrototypeOf(new this.TypedArray(i,...t),this.constructor.prototype)}Lt.prototype[Ec]=!0;Lt.prototype.toJSON=function(){return`"${Te(this)}"`};Lt.prototype.valueOf=function(){return Ys(this)};Lt.prototype.toString=function(){return Te(this)};Lt.prototype[Symbol.toPrimitive]=function(i="default"){switch(i){case"number":return Ys(this);case"string":return Te(this);case"default":return Yn(this)}return Te(this)};function ke(...i){return Lt.apply(this,i)}function Pe(...i){return Lt.apply(this,i)}function li(...i){return Lt.apply(this,i)}Object.setPrototypeOf(ke.prototype,Object.create(Int32Array.prototype));Object.setPrototypeOf(Pe.prototype,Object.create(Uint32Array.prototype));Object.setPrototypeOf(li.prototype,Object.create(Uint32Array.prototype));Object.assign(ke.prototype,Lt.prototype,{constructor:ke,signed:!0,TypedArray:Int32Array,BigIntArray:bi});Object.assign(Pe.prototype,Lt.prototype,{constructor:Pe,signed:!1,TypedArray:Uint32Array,BigIntArray:vi});Object.assign(li.prototype,Lt.prototype,{constructor:li,signed:!0,TypedArray:Uint32Array,BigIntArray:vi});function Ys(i){const{buffer:t,byteOffset:e,length:n,signed:r}=i,s=new vi(t,e,n),o=r&&s[s.length-1]&BigInt(1)<<BigInt(63);let a=BigInt(o?1:0),c=BigInt(0);if(o){for(const l of s)a+=~l*(BigInt(1)<<BigInt(32)*c++);a*=BigInt(-1)}else for(const l of s)a+=l*(BigInt(1)<<BigInt(32)*c++);return a}let Te,Yn;gc?(Yn=i=>i.byteLength===8?new i.BigIntArray(i.buffer,i.byteOffset,1)[0]:Mn(i),Te=i=>i.byteLength===8?`${new i.BigIntArray(i.buffer,i.byteOffset,1)[0]}`:Mn(i)):(Te=Mn,Yn=Te);function Mn(i){let t="";const e=new Uint32Array(2);let n=new Uint16Array(i.buffer,i.byteOffset,i.byteLength/2);const r=new Uint32Array((n=new Uint16Array(n).reverse()).buffer);let s=-1;const o=n.length-1;do{for(e[0]=n[s=0];s<o;)n[s++]=e[1]=e[0]/10,e[0]=(e[0]-e[1]*10<<16)+n[s];n[s]=e[1]=e[0]/10,e[0]=e[0]-e[1]*10,t=`${e[0]}${t}`}while(r[0]||r[1]||r[2]||r[3]);return t??"0"}class mr{static new(t,e){switch(e){case!0:return new ke(t);case!1:return new Pe(t)}switch(t.constructor){case Int8Array:case Int16Array:case Int32Array:case bi:return new ke(t)}return t.byteLength===16?new li(t):new Pe(t)}static signed(t){return new ke(t)}static unsigned(t){return new Pe(t)}static decimal(t){return new li(t)}constructor(t,e){return mr.new(t,e)}}var Hs,Js,Gs,qs,Ks,Xs,Zs,Qs,to,eo,io,no,ro,so,oo,ao,co,lo,uo;class g{static isNull(t){return(t==null?void 0:t.typeId)===h.Null}static isInt(t){return(t==null?void 0:t.typeId)===h.Int}static isFloat(t){return(t==null?void 0:t.typeId)===h.Float}static isBinary(t){return(t==null?void 0:t.typeId)===h.Binary}static isUtf8(t){return(t==null?void 0:t.typeId)===h.Utf8}static isBool(t){return(t==null?void 0:t.typeId)===h.Bool}static isDecimal(t){return(t==null?void 0:t.typeId)===h.Decimal}static isDate(t){return(t==null?void 0:t.typeId)===h.Date}static isTime(t){return(t==null?void 0:t.typeId)===h.Time}static isTimestamp(t){return(t==null?void 0:t.typeId)===h.Timestamp}static isInterval(t){return(t==null?void 0:t.typeId)===h.Interval}static isList(t){return(t==null?void 0:t.typeId)===h.List}static isStruct(t){return(t==null?void 0:t.typeId)===h.Struct}static isUnion(t){return(t==null?void 0:t.typeId)===h.Union}static isFixedSizeBinary(t){return(t==null?void 0:t.typeId)===h.FixedSizeBinary}static isFixedSizeList(t){return(t==null?void 0:t.typeId)===h.FixedSizeList}static isMap(t){return(t==null?void 0:t.typeId)===h.Map}static isDictionary(t){return(t==null?void 0:t.typeId)===h.Dictionary}static isDenseUnion(t){return g.isUnion(t)&&t.mode===gt.Dense}static isSparseUnion(t){return g.isUnion(t)&&t.mode===gt.Sparse}get typeId(){return h.NONE}}Hs=Symbol.toStringTag;g[Hs]=(i=>(i.children=null,i.ArrayType=Array,i[Symbol.toStringTag]="DataType"))(g.prototype);let fe=class extends g{toString(){return"Null"}get typeId(){return h.Null}};Js=Symbol.toStringTag;fe[Js]=(i=>i[Symbol.toStringTag]="Null")(fe.prototype);class pe extends g{constructor(t,e){super(),this.isSigned=t,this.bitWidth=e}get typeId(){return h.Int}get ArrayType(){switch(this.bitWidth){case 8:return this.isSigned?Int8Array:Uint8Array;case 16:return this.isSigned?Int16Array:Uint16Array;case 32:return this.isSigned?Int32Array:Uint32Array;case 64:return this.isSigned?bi:vi}throw new Error(`Unrecognized ${this[Symbol.toStringTag]} type`)}toString(){return`${this.isSigned?"I":"Ui"}nt${this.bitWidth}`}}Gs=Symbol.toStringTag;pe[Gs]=(i=>(i.isSigned=null,i.bitWidth=null,i[Symbol.toStringTag]="Int"))(pe.prototype);class ui extends pe{constructor(){super(!0,32)}get ArrayType(){return Int32Array}}Object.defineProperty(ui.prototype,"ArrayType",{value:Int32Array});class hi extends g{constructor(t){super(),this.precision=t}get typeId(){return h.Float}get ArrayType(){switch(this.precision){case lt.HALF:return Uint16Array;case lt.SINGLE:return Float32Array;case lt.DOUBLE:return Float64Array}throw new Error(`Unrecognized ${this[Symbol.toStringTag]} type`)}toString(){return`Float${this.precision<<5||16}`}}qs=Symbol.toStringTag;hi[qs]=(i=>(i.precision=null,i[Symbol.toStringTag]="Float"))(hi.prototype);let ki=class extends g{constructor(){super()}get typeId(){return h.Binary}toString(){return"Binary"}};Ks=Symbol.toStringTag;ki[Ks]=(i=>(i.ArrayType=Uint8Array,i[Symbol.toStringTag]="Binary"))(ki.prototype);let Pi=class extends g{constructor(){super()}get typeId(){return h.Utf8}toString(){return"Utf8"}};Xs=Symbol.toStringTag;Pi[Xs]=(i=>(i.ArrayType=Uint8Array,i[Symbol.toStringTag]="Utf8"))(Pi.prototype);let zi=class extends g{constructor(){super()}get typeId(){return h.Bool}toString(){return"Bool"}};Zs=Symbol.toStringTag;zi[Zs]=(i=>(i.ArrayType=Uint8Array,i[Symbol.toStringTag]="Bool"))(zi.prototype);let $i=class extends g{constructor(t,e,n=128){super(),this.scale=t,this.precision=e,this.bitWidth=n}get typeId(){return h.Decimal}toString(){return`Decimal[${this.precision}e${this.scale>0?"+":""}${this.scale}]`}};Qs=Symbol.toStringTag;$i[Qs]=(i=>(i.scale=null,i.precision=null,i.ArrayType=Uint32Array,i[Symbol.toStringTag]="Decimal"))($i.prototype);class ji extends g{constructor(t){super(),this.unit=t}get typeId(){return h.Date}toString(){return`Date${(this.unit+1)*32}<${ne[this.unit]}>`}}to=Symbol.toStringTag;ji[to]=(i=>(i.unit=null,i.ArrayType=Int32Array,i[Symbol.toStringTag]="Date"))(ji.prototype);class di extends g{constructor(t,e){super(),this.unit=t,this.bitWidth=e}get typeId(){return h.Time}toString(){return`Time${this.bitWidth}<${L[this.unit]}>`}get ArrayType(){switch(this.bitWidth){case 32:return Int32Array;case 64:return bi}throw new Error(`Unrecognized ${this[Symbol.toStringTag]} type`)}}eo=Symbol.toStringTag;di[eo]=(i=>(i.unit=null,i.bitWidth=null,i[Symbol.toStringTag]="Time"))(di.prototype);class Vi extends g{constructor(t,e){super(),this.unit=t,this.timezone=e}get typeId(){return h.Timestamp}toString(){return`Timestamp<${L[this.unit]}${this.timezone?`, ${this.timezone}`:""}>`}}io=Symbol.toStringTag;Vi[io]=(i=>(i.unit=null,i.timezone=null,i.ArrayType=Int32Array,i[Symbol.toStringTag]="Timestamp"))(Vi.prototype);class Wi extends g{constructor(t){super(),this.unit=t}get typeId(){return h.Interval}toString(){return`Interval<${de[this.unit]}>`}}no=Symbol.toStringTag;Wi[no]=(i=>(i.unit=null,i.ArrayType=Int32Array,i[Symbol.toStringTag]="Interval"))(Wi.prototype);let Yi=class extends g{constructor(t){super(),this.children=[t]}get typeId(){return h.List}toString(){return`List<${this.valueType}>`}get valueType(){return this.children[0].type}get valueField(){return this.children[0]}get ArrayType(){return this.valueType.ArrayType}};ro=Symbol.toStringTag;Yi[ro]=(i=>(i.children=null,i[Symbol.toStringTag]="List"))(Yi.prototype);class nt extends g{constructor(t){super(),this.children=t}get typeId(){return h.Struct}toString(){return`Struct<{${this.children.map(t=>`${t.name}:${t.type}`).join(", ")}}>`}}so=Symbol.toStringTag;nt[so]=(i=>(i.children=null,i[Symbol.toStringTag]="Struct"))(nt.prototype);class Hi extends g{constructor(t,e,n){super(),this.mode=t,this.children=n,this.typeIds=e=Int32Array.from(e),this.typeIdToChildIndex=e.reduce((r,s,o)=>(r[s]=o)&&r||r,Object.create(null))}get typeId(){return h.Union}toString(){return`${this[Symbol.toStringTag]}<${this.children.map(t=>`${t.type}`).join(" | ")}>`}}oo=Symbol.toStringTag;Hi[oo]=(i=>(i.mode=null,i.typeIds=null,i.children=null,i.typeIdToChildIndex=null,i.ArrayType=Int8Array,i[Symbol.toStringTag]="Union"))(Hi.prototype);let Ji=class extends g{constructor(t){super(),this.byteWidth=t}get typeId(){return h.FixedSizeBinary}toString(){return`FixedSizeBinary[${this.byteWidth}]`}};ao=Symbol.toStringTag;Ji[ao]=(i=>(i.byteWidth=null,i.ArrayType=Uint8Array,i[Symbol.toStringTag]="FixedSizeBinary"))(Ji.prototype);let Gi=class extends g{constructor(t,e){super(),this.listSize=t,this.children=[e]}get typeId(){return h.FixedSizeList}get valueType(){return this.children[0].type}get valueField(){return this.children[0]}get ArrayType(){return this.valueType.ArrayType}toString(){return`FixedSizeList[${this.listSize}]<${this.valueType}>`}};co=Symbol.toStringTag;Gi[co]=(i=>(i.children=null,i.listSize=null,i[Symbol.toStringTag]="FixedSizeList"))(Gi.prototype);class qi extends g{constructor(t,e=!1){super(),this.children=[t],this.keysSorted=e}get typeId(){return h.Map}get keyType(){return this.children[0].type.children[0].type}get valueType(){return this.children[0].type.children[1].type}get childType(){return this.children[0].type}toString(){return`Map<{${this.children[0].type.children.map(t=>`${t.name}:${t.type}`).join(", ")}}>`}}lo=Symbol.toStringTag;qi[lo]=(i=>(i.children=null,i.keysSorted=null,i[Symbol.toStringTag]="Map_"))(qi.prototype);const Nc=(i=>()=>++i)(-1);class Ve extends g{constructor(t,e,n,r){super(),this.indices=e,this.dictionary=t,this.isOrdered=r||!1,this.id=n==null?Nc():typeof n=="number"?n:n.low}get typeId(){return h.Dictionary}get children(){return this.dictionary.children}get valueType(){return this.dictionary}get ArrayType(){return this.dictionary.ArrayType}toString(){return`Dictionary<${this.indices}, ${this.dictionary}>`}}uo=Symbol.toStringTag;Ve[uo]=(i=>(i.id=null,i.indices=null,i.isOrdered=null,i.dictionary=null,i[Symbol.toStringTag]="Dictionary"))(Ve.prototype);function Xt(i){const t=i;switch(i.typeId){case h.Decimal:return i.bitWidth/32;case h.Timestamp:return 2;case h.Date:return 1+t.unit;case h.Interval:return 1+t.unit;case h.FixedSizeList:return t.listSize;case h.FixedSizeBinary:return t.byteWidth;default:return 1}}class M{visitMany(t,...e){return t.map((n,r)=>this.visit(n,...e.map(s=>s[r])))}visit(...t){return this.getVisitFn(t[0],!1).apply(this,t)}getVisitFn(t,e=!0){return xc(this,t,e)}getVisitFnByTypeId(t,e=!0){return Ee(this,t,e)}visitNull(t,...e){return null}visitBool(t,...e){return null}visitInt(t,...e){return null}visitFloat(t,...e){return null}visitUtf8(t,...e){return null}visitBinary(t,...e){return null}visitFixedSizeBinary(t,...e){return null}visitDate(t,...e){return null}visitTimestamp(t,...e){return null}visitTime(t,...e){return null}visitDecimal(t,...e){return null}visitList(t,...e){return null}visitStruct(t,...e){return null}visitUnion(t,...e){return null}visitDictionary(t,...e){return null}visitInterval(t,...e){return null}visitFixedSizeList(t,...e){return null}visitMap(t,...e){return null}}function xc(i,t,e=!0){return typeof t=="number"?Ee(i,t,e):typeof t=="string"&&t in h?Ee(i,h[t],e):t&&t instanceof g?Ee(i,Zr(t),e):t!=null&&t.type&&t.type instanceof g?Ee(i,Zr(t.type),e):Ee(i,h.NONE,e)}function Ee(i,t,e=!0){let n=null;switch(t){case h.Null:n=i.visitNull;break;case h.Bool:n=i.visitBool;break;case h.Int:n=i.visitInt;break;case h.Int8:n=i.visitInt8||i.visitInt;break;case h.Int16:n=i.visitInt16||i.visitInt;break;case h.Int32:n=i.visitInt32||i.visitInt;break;case h.Int64:n=i.visitInt64||i.visitInt;break;case h.Uint8:n=i.visitUint8||i.visitInt;break;case h.Uint16:n=i.visitUint16||i.visitInt;break;case h.Uint32:n=i.visitUint32||i.visitInt;break;case h.Uint64:n=i.visitUint64||i.visitInt;break;case h.Float:n=i.visitFloat;break;case h.Float16:n=i.visitFloat16||i.visitFloat;break;case h.Float32:n=i.visitFloat32||i.visitFloat;break;case h.Float64:n=i.visitFloat64||i.visitFloat;break;case h.Utf8:n=i.visitUtf8;break;case h.Binary:n=i.visitBinary;break;case h.FixedSizeBinary:n=i.visitFixedSizeBinary;break;case h.Date:n=i.visitDate;break;case h.DateDay:n=i.visitDateDay||i.visitDate;break;case h.DateMillisecond:n=i.visitDateMillisecond||i.visitDate;break;case h.Timestamp:n=i.visitTimestamp;break;case h.TimestampSecond:n=i.visitTimestampSecond||i.visitTimestamp;break;case h.TimestampMillisecond:n=i.visitTimestampMillisecond||i.visitTimestamp;break;case h.TimestampMicrosecond:n=i.visitTimestampMicrosecond||i.visitTimestamp;break;case h.TimestampNanosecond:n=i.visitTimestampNanosecond||i.visitTimestamp;break;case h.Time:n=i.visitTime;break;case h.TimeSecond:n=i.visitTimeSecond||i.visitTime;break;case h.TimeMillisecond:n=i.visitTimeMillisecond||i.visitTime;break;case h.TimeMicrosecond:n=i.visitTimeMicrosecond||i.visitTime;break;case h.TimeNanosecond:n=i.visitTimeNanosecond||i.visitTime;break;case h.Decimal:n=i.visitDecimal;break;case h.List:n=i.visitList;break;case h.Struct:n=i.visitStruct;break;case h.Union:n=i.visitUnion;break;case h.DenseUnion:n=i.visitDenseUnion||i.visitUnion;break;case h.SparseUnion:n=i.visitSparseUnion||i.visitUnion;break;case h.Dictionary:n=i.visitDictionary;break;case h.Interval:n=i.visitInterval;break;case h.IntervalDayTime:n=i.visitIntervalDayTime||i.visitInterval;break;case h.IntervalYearMonth:n=i.visitIntervalYearMonth||i.visitInterval;break;case h.FixedSizeList:n=i.visitFixedSizeList;break;case h.Map:n=i.visitMap;break}if(typeof n=="function")return n;if(!e)return()=>null;throw new Error(`Unrecognized type '${h[t]}'`)}function Zr(i){switch(i.typeId){case h.Null:return h.Null;case h.Int:{const{bitWidth:t,isSigned:e}=i;switch(t){case 8:return e?h.Int8:h.Uint8;case 16:return e?h.Int16:h.Uint16;case 32:return e?h.Int32:h.Uint32;case 64:return e?h.Int64:h.Uint64}return h.Int}case h.Float:switch(i.precision){case lt.HALF:return h.Float16;case lt.SINGLE:return h.Float32;case lt.DOUBLE:return h.Float64}return h.Float;case h.Binary:return h.Binary;case h.Utf8:return h.Utf8;case h.Bool:return h.Bool;case h.Decimal:return h.Decimal;case h.Time:switch(i.unit){case L.SECOND:return h.TimeSecond;case L.MILLISECOND:return h.TimeMillisecond;case L.MICROSECOND:return h.TimeMicrosecond;case L.NANOSECOND:return h.TimeNanosecond}return h.Time;case h.Timestamp:switch(i.unit){case L.SECOND:return h.TimestampSecond;case L.MILLISECOND:return h.TimestampMillisecond;case L.MICROSECOND:return h.TimestampMicrosecond;case L.NANOSECOND:return h.TimestampNanosecond}return h.Timestamp;case h.Date:switch(i.unit){case ne.DAY:return h.DateDay;case ne.MILLISECOND:return h.DateMillisecond}return h.Date;case h.Interval:switch(i.unit){case de.DAY_TIME:return h.IntervalDayTime;case de.YEAR_MONTH:return h.IntervalYearMonth}return h.Interval;case h.Map:return h.Map;case h.List:return h.List;case h.Struct:return h.Struct;case h.Union:switch(i.mode){case gt.Dense:return h.DenseUnion;case gt.Sparse:return h.SparseUnion}return h.Union;case h.FixedSizeBinary:return h.FixedSizeBinary;case h.FixedSizeList:return h.FixedSizeList;case h.Dictionary:return h.Dictionary}throw new Error(`Unrecognized type '${h[i.typeId]}'`)}M.prototype.visitInt8=null;M.prototype.visitInt16=null;M.prototype.visitInt32=null;M.prototype.visitInt64=null;M.prototype.visitUint8=null;M.prototype.visitUint16=null;M.prototype.visitUint32=null;M.prototype.visitUint64=null;M.prototype.visitFloat16=null;M.prototype.visitFloat32=null;M.prototype.visitFloat64=null;M.prototype.visitDateDay=null;M.prototype.visitDateMillisecond=null;M.prototype.visitTimestampSecond=null;M.prototype.visitTimestampMillisecond=null;M.prototype.visitTimestampMicrosecond=null;M.prototype.visitTimestampNanosecond=null;M.prototype.visitTimeSecond=null;M.prototype.visitTimeMillisecond=null;M.prototype.visitTimeMicrosecond=null;M.prototype.visitTimeNanosecond=null;M.prototype.visitDenseUnion=null;M.prototype.visitSparseUnion=null;M.prototype.visitIntervalDayTime=null;M.prototype.visitIntervalYearMonth=null;const ho=new Float64Array(1),Le=new Uint32Array(ho.buffer);function fo(i){const t=(i&31744)>>10,e=(i&1023)/1024,n=Math.pow(-1,(i&32768)>>15);switch(t){case 31:return n*(e?Number.NaN:1/0);case 0:return n*(e?6103515625e-14*e:0)}return n*Math.pow(2,t-15)*(1+e)}function Rc(i){if(i!==i)return 32256;ho[0]=i;const t=(Le[1]&2147483648)>>16&65535;let e=Le[1]&2146435072,n=0;return e>=1089470464?Le[0]>0?e=31744:(e=(e&2080374784)>>16,n=(Le[1]&1048575)>>10):e<=1056964608?(n=1048576+(Le[1]&1048575),n=1048576+(n<<(e>>20)-998)>>21,e=0):(e=e-1056964608>>10,n=(Le[1]&1048575)+512>>10),t|e|n&65535}class S extends M{}function O(i){return(t,e,n)=>{if(t.setValid(e,n!=null))return i(t,e,n)}}const Uc=(i,t,e)=>{i[t]=Math.trunc(e/864e5)},gr=(i,t,e)=>{i[t]=Math.trunc(e%4294967296),i[t+1]=Math.trunc(e/4294967296)},kc=(i,t,e)=>{i[t]=Math.trunc(e*1e3%4294967296),i[t+1]=Math.trunc(e*1e3/4294967296)},Pc=(i,t,e)=>{i[t]=Math.trunc(e*1e6%4294967296),i[t+1]=Math.trunc(e*1e6/4294967296)},po=(i,t,e,n)=>{if(e+1<t.length){const{[e]:r,[e+1]:s}=t;i.set(n.subarray(0,s-r),r)}},zc=({offset:i,values:t},e,n)=>{const r=i+e;n?t[r>>3]|=1<<r%8:t[r>>3]&=~(1<<r%8)},se=({values:i},t,e)=>{i[t]=e},br=({values:i},t,e)=>{i[t]=e},yo=({values:i},t,e)=>{i[t]=Rc(e)},$c=(i,t,e)=>{switch(i.type.precision){case lt.HALF:return yo(i,t,e);case lt.SINGLE:case lt.DOUBLE:return br(i,t,e)}},mo=({values:i},t,e)=>{Uc(i,t,e.valueOf())},go=({values:i},t,e)=>{gr(i,t*2,e.valueOf())},jc=({stride:i,values:t},e,n)=>{t.set(n.subarray(0,i),i*e)},Vc=({values:i,valueOffsets:t},e,n)=>po(i,t,e,n),Wc=({values:i,valueOffsets:t},e,n)=>{po(i,t,e,dr(n))},Yc=(i,t,e)=>{i.type.unit===ne.DAY?mo(i,t,e):go(i,t,e)},bo=({values:i},t,e)=>gr(i,t*2,e/1e3),vo=({values:i},t,e)=>gr(i,t*2,e),_o=({values:i},t,e)=>kc(i,t*2,e),wo=({values:i},t,e)=>Pc(i,t*2,e),Hc=(i,t,e)=>{switch(i.type.unit){case L.SECOND:return bo(i,t,e);case L.MILLISECOND:return vo(i,t,e);case L.MICROSECOND:return _o(i,t,e);case L.NANOSECOND:return wo(i,t,e)}},So=({values:i},t,e)=>{i[t]=e},Io=({values:i},t,e)=>{i[t]=e},Bo=({values:i},t,e)=>{i[t]=e},Oo=({values:i},t,e)=>{i[t]=e},Jc=(i,t,e)=>{switch(i.type.unit){case L.SECOND:return So(i,t,e);case L.MILLISECOND:return Io(i,t,e);case L.MICROSECOND:return Bo(i,t,e);case L.NANOSECOND:return Oo(i,t,e)}},Gc=({values:i,stride:t},e,n)=>{i.set(n.subarray(0,t),t*e)},qc=(i,t,e)=>{const n=i.children[0],r=i.valueOffsets,s=At.getVisitFn(n);if(Array.isArray(e))for(let o=-1,a=r[t],c=r[t+1];a<c;)s(n,a++,e[++o]);else for(let o=-1,a=r[t],c=r[t+1];a<c;)s(n,a++,e.get(++o))},Kc=(i,t,e)=>{const n=i.children[0],{valueOffsets:r}=i,s=At.getVisitFn(n);let{[t]:o,[t+1]:a}=r;const c=e instanceof Map?e.entries():Object.entries(e);for(const l of c)if(s(n,o,l),++o>=a)break},Xc=(i,t)=>(e,n,r,s)=>n&&e(n,i,t[s]),Zc=(i,t)=>(e,n,r,s)=>n&&e(n,i,t.get(s)),Qc=(i,t)=>(e,n,r,s)=>n&&e(n,i,t.get(r.name)),tl=(i,t)=>(e,n,r,s)=>n&&e(n,i,t[r.name]),el=(i,t,e)=>{const n=i.type.children.map(s=>At.getVisitFn(s.type)),r=e instanceof Map?Qc(t,e):e instanceof N?Zc(t,e):Array.isArray(e)?Xc(t,e):tl(t,e);i.type.children.forEach((s,o)=>r(n[o],i.children[o],s,o))},il=(i,t,e)=>{i.type.mode===gt.Dense?Ao(i,t,e):Do(i,t,e)},Ao=(i,t,e)=>{const n=i.type.typeIdToChildIndex[i.typeIds[t]],r=i.children[n];At.visit(r,i.valueOffsets[t],e)},Do=(i,t,e)=>{const n=i.type.typeIdToChildIndex[i.typeIds[t]],r=i.children[n];At.visit(r,t,e)},nl=(i,t,e)=>{var n;(n=i.dictionary)===null||n===void 0||n.set(i.values[t],e)},rl=(i,t,e)=>{i.type.unit===de.DAY_TIME?Fo(i,t,e):To(i,t,e)},Fo=({values:i},t,e)=>{i.set(e.subarray(0,2),2*t)},To=({values:i},t,e)=>{i[t]=e[0]*12+e[1]%12},sl=(i,t,e)=>{const{stride:n}=i,r=i.children[0],s=At.getVisitFn(r);if(Array.isArray(e))for(let o=-1,a=t*n;++o<n;)s(r,a+o,e[o]);else for(let o=-1,a=t*n;++o<n;)s(r,a+o,e.get(o))};S.prototype.visitBool=O(zc);S.prototype.visitInt=O(se);S.prototype.visitInt8=O(se);S.prototype.visitInt16=O(se);S.prototype.visitInt32=O(se);S.prototype.visitInt64=O(se);S.prototype.visitUint8=O(se);S.prototype.visitUint16=O(se);S.prototype.visitUint32=O(se);S.prototype.visitUint64=O(se);S.prototype.visitFloat=O($c);S.prototype.visitFloat16=O(yo);S.prototype.visitFloat32=O(br);S.prototype.visitFloat64=O(br);S.prototype.visitUtf8=O(Wc);S.prototype.visitBinary=O(Vc);S.prototype.visitFixedSizeBinary=O(jc);S.prototype.visitDate=O(Yc);S.prototype.visitDateDay=O(mo);S.prototype.visitDateMillisecond=O(go);S.prototype.visitTimestamp=O(Hc);S.prototype.visitTimestampSecond=O(bo);S.prototype.visitTimestampMillisecond=O(vo);S.prototype.visitTimestampMicrosecond=O(_o);S.prototype.visitTimestampNanosecond=O(wo);S.prototype.visitTime=O(Jc);S.prototype.visitTimeSecond=O(So);S.prototype.visitTimeMillisecond=O(Io);S.prototype.visitTimeMicrosecond=O(Bo);S.prototype.visitTimeNanosecond=O(Oo);S.prototype.visitDecimal=O(Gc);S.prototype.visitList=O(qc);S.prototype.visitStruct=O(el);S.prototype.visitUnion=O(il);S.prototype.visitDenseUnion=O(Ao);S.prototype.visitSparseUnion=O(Do);S.prototype.visitDictionary=O(nl);S.prototype.visitInterval=O(rl);S.prototype.visitIntervalDayTime=O(Fo);S.prototype.visitIntervalYearMonth=O(To);S.prototype.visitFixedSizeList=O(sl);S.prototype.visitMap=O(Kc);const At=new S,Ft=Symbol.for("parent"),ze=Symbol.for("rowIndex");class vr{constructor(t,e){return this[Ft]=t,this[ze]=e,new Proxy(this,new al)}toArray(){return Object.values(this.toJSON())}toJSON(){const t=this[ze],e=this[Ft],n=e.type.children,r={};for(let s=-1,o=n.length;++s<o;)r[n[s].name]=ht.visit(e.children[s],t);return r}toString(){return`{${[...this].map(([t,e])=>`${ci(t)}: ${ci(e)}`).join(", ")}}`}[Symbol.for("nodejs.util.inspect.custom")](){return this.toString()}[Symbol.iterator](){return new ol(this[Ft],this[ze])}}class ol{constructor(t,e){this.childIndex=0,this.children=t.children,this.rowIndex=e,this.childFields=t.type.children,this.numChildren=this.childFields.length}[Symbol.iterator](){return this}next(){const t=this.childIndex;return t<this.numChildren?(this.childIndex=t+1,{done:!1,value:[this.childFields[t].name,ht.visit(this.children[t],this.rowIndex)]}):{done:!0,value:null}}}Object.defineProperties(vr.prototype,{[Symbol.toStringTag]:{enumerable:!1,configurable:!1,value:"Row"},[Ft]:{writable:!0,enumerable:!1,configurable:!1,value:null},[ze]:{writable:!0,enumerable:!1,configurable:!1,value:-1}});class al{isExtensible(){return!1}deleteProperty(){return!1}preventExtensions(){return!0}ownKeys(t){return t[Ft].type.children.map(e=>e.name)}has(t,e){return t[Ft].type.children.findIndex(n=>n.name===e)!==-1}getOwnPropertyDescriptor(t,e){if(t[Ft].type.children.findIndex(n=>n.name===e)!==-1)return{writable:!0,enumerable:!0,configurable:!0}}get(t,e){if(Reflect.has(t,e))return t[e];const n=t[Ft].type.children.findIndex(r=>r.name===e);if(n!==-1){const r=ht.visit(t[Ft].children[n],t[ze]);return Reflect.set(t,e,r),r}}set(t,e,n){const r=t[Ft].type.children.findIndex(s=>s.name===e);return r!==-1?(At.visit(t[Ft].children[r],t[ze],n),Reflect.set(t,e,n)):Reflect.has(t,e)||typeof e=="symbol"?Reflect.set(t,e,n):!1}}class b extends M{}function I(i){return(t,e)=>t.getValid(e)?i(t,e):null}const cl=(i,t)=>864e5*i[t],_r=(i,t)=>4294967296*i[t+1]+(i[t]>>>0),ll=(i,t)=>4294967296*(i[t+1]/1e3)+(i[t]>>>0)/1e3,ul=(i,t)=>4294967296*(i[t+1]/1e6)+(i[t]>>>0)/1e6,Mo=i=>new Date(i),hl=(i,t)=>Mo(cl(i,t)),dl=(i,t)=>Mo(_r(i,t)),fl=(i,t)=>null,Co=(i,t,e)=>{if(e+1>=t.length)return null;const n=t[e],r=t[e+1];return i.subarray(n,r)},pl=({offset:i,values:t},e)=>{const n=i+e;return(t[n>>3]&1<<n%8)!==0},Lo=({values:i},t)=>hl(i,t),Eo=({values:i},t)=>dl(i,t*2),be=({stride:i,values:t},e)=>t[i*e],yl=({stride:i,values:t},e)=>fo(t[i*e]),No=({values:i},t)=>i[t],ml=({stride:i,values:t},e)=>t.subarray(i*e,i*(e+1)),gl=({values:i,valueOffsets:t},e)=>Co(i,t,e),bl=({values:i,valueOffsets:t},e)=>{const n=Co(i,t,e);return n!==null?jn(n):null},vl=({values:i},t)=>i[t],_l=({type:i,values:t},e)=>i.precision!==lt.HALF?t[e]:fo(t[e]),wl=(i,t)=>i.type.unit===ne.DAY?Lo(i,t):Eo(i,t),xo=({values:i},t)=>1e3*_r(i,t*2),Ro=({values:i},t)=>_r(i,t*2),Uo=({values:i},t)=>ll(i,t*2),ko=({values:i},t)=>ul(i,t*2),Sl=(i,t)=>{switch(i.type.unit){case L.SECOND:return xo(i,t);case L.MILLISECOND:return Ro(i,t);case L.MICROSECOND:return Uo(i,t);case L.NANOSECOND:return ko(i,t)}},Po=({values:i},t)=>i[t],zo=({values:i},t)=>i[t],$o=({values:i},t)=>i[t],jo=({values:i},t)=>i[t],Il=(i,t)=>{switch(i.type.unit){case L.SECOND:return Po(i,t);case L.MILLISECOND:return zo(i,t);case L.MICROSECOND:return $o(i,t);case L.NANOSECOND:return jo(i,t)}},Bl=({values:i,stride:t},e)=>mr.decimal(i.subarray(t*e,t*(e+1))),Ol=(i,t)=>{const{valueOffsets:e,stride:n,children:r}=i,{[t*n]:s,[t*n+1]:o}=e,c=r[0].slice(s,o-s);return new N([c])},Al=(i,t)=>{const{valueOffsets:e,children:n}=i,{[t]:r,[t+1]:s}=e,o=n[0];return new wr(o.slice(r,s-r))},Dl=(i,t)=>new vr(i,t),Fl=(i,t)=>i.type.mode===gt.Dense?Vo(i,t):Wo(i,t),Vo=(i,t)=>{const e=i.type.typeIdToChildIndex[i.typeIds[t]],n=i.children[e];return ht.visit(n,i.valueOffsets[t])},Wo=(i,t)=>{const e=i.type.typeIdToChildIndex[i.typeIds[t]],n=i.children[e];return ht.visit(n,t)},Tl=(i,t)=>{var e;return(e=i.dictionary)===null||e===void 0?void 0:e.get(i.values[t])},Ml=(i,t)=>i.type.unit===de.DAY_TIME?Yo(i,t):Ho(i,t),Yo=({values:i},t)=>i.subarray(2*t,2*(t+1)),Ho=({values:i},t)=>{const e=i[t],n=new Int32Array(2);return n[0]=Math.trunc(e/12),n[1]=Math.trunc(e%12),n},Cl=(i,t)=>{const{stride:e,children:n}=i,s=n[0].slice(t*e,e);return new N([s])};b.prototype.visitNull=I(fl);b.prototype.visitBool=I(pl);b.prototype.visitInt=I(vl);b.prototype.visitInt8=I(be);b.prototype.visitInt16=I(be);b.prototype.visitInt32=I(be);b.prototype.visitInt64=I(No);b.prototype.visitUint8=I(be);b.prototype.visitUint16=I(be);b.prototype.visitUint32=I(be);b.prototype.visitUint64=I(No);b.prototype.visitFloat=I(_l);b.prototype.visitFloat16=I(yl);b.prototype.visitFloat32=I(be);b.prototype.visitFloat64=I(be);b.prototype.visitUtf8=I(bl);b.prototype.visitBinary=I(gl);b.prototype.visitFixedSizeBinary=I(ml);b.prototype.visitDate=I(wl);b.prototype.visitDateDay=I(Lo);b.prototype.visitDateMillisecond=I(Eo);b.prototype.visitTimestamp=I(Sl);b.prototype.visitTimestampSecond=I(xo);b.prototype.visitTimestampMillisecond=I(Ro);b.prototype.visitTimestampMicrosecond=I(Uo);b.prototype.visitTimestampNanosecond=I(ko);b.prototype.visitTime=I(Il);b.prototype.visitTimeSecond=I(Po);b.prototype.visitTimeMillisecond=I(zo);b.prototype.visitTimeMicrosecond=I($o);b.prototype.visitTimeNanosecond=I(jo);b.prototype.visitDecimal=I(Bl);b.prototype.visitList=I(Ol);b.prototype.visitStruct=I(Dl);b.prototype.visitUnion=I(Fl);b.prototype.visitDenseUnion=I(Vo);b.prototype.visitSparseUnion=I(Wo);b.prototype.visitDictionary=I(Tl);b.prototype.visitInterval=I(Ml);b.prototype.visitIntervalDayTime=I(Yo);b.prototype.visitIntervalYearMonth=I(Ho);b.prototype.visitFixedSizeList=I(Cl);b.prototype.visitMap=I(Al);const ht=new b,Ut=Symbol.for("keys"),$e=Symbol.for("vals");class wr{constructor(t){return this[Ut]=new N([t.children[0]]).memoize(),this[$e]=t.children[1],new Proxy(this,new El)}[Symbol.iterator](){return new Ll(this[Ut],this[$e])}get size(){return this[Ut].length}toArray(){return Object.values(this.toJSON())}toJSON(){const t=this[Ut],e=this[$e],n={};for(let r=-1,s=t.length;++r<s;)n[t.get(r)]=ht.visit(e,r);return n}toString(){return`{${[...this].map(([t,e])=>`${ci(t)}: ${ci(e)}`).join(", ")}}`}[Symbol.for("nodejs.util.inspect.custom")](){return this.toString()}}class Ll{constructor(t,e){this.keys=t,this.vals=e,this.keyIndex=0,this.numKeys=t.length}[Symbol.iterator](){return this}next(){const t=this.keyIndex;return t===this.numKeys?{done:!0,value:null}:(this.keyIndex++,{done:!1,value:[this.keys.get(t),ht.visit(this.vals,t)]})}}class El{isExtensible(){return!1}deleteProperty(){return!1}preventExtensions(){return!0}ownKeys(t){return t[Ut].toArray().map(String)}has(t,e){return t[Ut].includes(e)}getOwnPropertyDescriptor(t,e){if(t[Ut].indexOf(e)!==-1)return{writable:!0,enumerable:!0,configurable:!0}}get(t,e){if(Reflect.has(t,e))return t[e];const n=t[Ut].indexOf(e);if(n!==-1){const r=ht.visit(Reflect.get(t,$e),n);return Reflect.set(t,e,r),r}}set(t,e,n){const r=t[Ut].indexOf(e);return r!==-1?(At.visit(Reflect.get(t,$e),r,n),Reflect.set(t,e,n)):Reflect.has(t,e)?Reflect.set(t,e,n):!1}}Object.defineProperties(wr.prototype,{[Symbol.toStringTag]:{enumerable:!1,configurable:!1,value:"Row"},[Ut]:{writable:!0,enumerable:!1,configurable:!1,value:null},[$e]:{writable:!0,enumerable:!1,configurable:!1,value:null}});let Qr;function Jo(i,t,e,n){const{length:r=0}=i;let s=typeof t!="number"?0:t,o=typeof e!="number"?r:e;return s<0&&(s=(s%r+r)%r),o<0&&(o=(o%r+r)%r),o<s&&(Qr=s,s=o,o=Qr),o>r&&(o=r),n?n(i,s,o):[s,o]}const ts=i=>i!==i;function Qe(i){if(typeof i!=="object"||i===null)return ts(i)?ts:e=>e===i;if(i instanceof Date){const e=i.valueOf();return n=>n instanceof Date?n.valueOf()===e:!1}return ArrayBuffer.isView(i)?e=>e?Ac(i,e):!1:i instanceof Map?xl(i):Array.isArray(i)?Nl(i):i instanceof N?Rl(i):Ul(i,!0)}function Nl(i){const t=[];for(let e=-1,n=i.length;++e<n;)t[e]=Qe(i[e]);return On(t)}function xl(i){let t=-1;const e=[];for(const n of i.values())e[++t]=Qe(n);return On(e)}function Rl(i){const t=[];for(let e=-1,n=i.length;++e<n;)t[e]=Qe(i.get(e));return On(t)}function Ul(i,t=!1){const e=Object.keys(i);if(!t&&e.length===0)return()=>!1;const n=[];for(let r=-1,s=e.length;++r<s;)n[r]=Qe(i[e[r]]);return On(n,e)}function On(i,t){return e=>{if(!e||typeof e!="object")return!1;switch(e.constructor){case Array:return kl(i,e);case Map:return es(i,e,e.keys());case wr:case vr:case Object:case void 0:return es(i,e,t||Object.keys(e))}return e instanceof N?Pl(i,e):!1}}function kl(i,t){const e=i.length;if(t.length!==e)return!1;for(let n=-1;++n<e;)if(!i[n](t[n]))return!1;return!0}function Pl(i,t){const e=i.length;if(t.length!==e)return!1;for(let n=-1;++n<e;)if(!i[n](t.get(n)))return!1;return!0}function es(i,t,e){const n=e[Symbol.iterator](),r=t instanceof Map?t.keys():Object.keys(t)[Symbol.iterator](),s=t instanceof Map?t.values():Object.values(t)[Symbol.iterator]();let o=0;const a=i.length;let c=s.next(),l=n.next(),u=r.next();for(;o<a&&!l.done&&!u.done&&!c.done&&!(l.value!==u.value||!i[o](c.value));++o,l=n.next(),u=r.next(),c=s.next());return o===a&&l.done&&u.done&&c.done?!0:(n.return&&n.return(),r.return&&r.return(),s.return&&s.return(),!1)}function Go(i,t,e,n){return(e&1<<n)!==0}function zl(i,t,e,n){return(e&1<<n)>>n}function Sr(i,t,e){const n=e.byteLength+7&-8;if(i>0||e.byteLength<n){const r=new Uint8Array(n);return r.set(i%8===0?e.subarray(i>>3):Ki(new Ir(e,i,t,null,Go)).subarray(0,n)),r}return e}function Ki(i){const t=[];let e=0,n=0,r=0;for(const o of i)o&&(r|=1<<n),++n===8&&(t[e++]=r,r=n=0);(e===0||n>0)&&(t[e++]=r);const s=new Uint8Array(t.length+7&-8);return s.set(t),s}class Ir{constructor(t,e,n,r,s){this.bytes=t,this.length=n,this.context=r,this.get=s,this.bit=e%8,this.byteIndex=e>>3,this.byte=t[this.byteIndex++],this.index=0}next(){return this.index<this.length?(this.bit===8&&(this.bit=0,this.byte=this.bytes[this.byteIndex++]),{value:this.get(this.context,this.index++,this.byte,this.bit++)}):{done:!0,value:null}}[Symbol.iterator](){return this}}function Hn(i,t,e){if(e-t<=0)return 0;if(e-t<8){let s=0;for(const o of new Ir(i,t,e-t,i,zl))s+=o;return s}const n=e>>3<<3,r=t+(t%8===0?0:8-t%8);return Hn(i,t,r)+Hn(i,n,e)+$l(i,r>>3,n-r>>3)}function $l(i,t,e){let n=0,r=Math.trunc(t);const s=new DataView(i.buffer,i.byteOffset,i.byteLength),o=e===void 0?i.byteLength:r+e;for(;o-r>=4;)n+=Cn(s.getUint32(r)),r+=4;for(;o-r>=2;)n+=Cn(s.getUint16(r)),r+=2;for(;o-r>=1;)n+=Cn(s.getUint8(r)),r+=1;return n}function Cn(i){let t=Math.trunc(i);return t=t-(t>>>1&1431655765),t=(t&858993459)+(t>>>2&858993459),(t+(t>>>4)&252645135)*16843009>>>24}const jl=-1;class W{constructor(t,e,n,r,s,o=[],a){this.type=t,this.children=o,this.dictionary=a,this.offset=Math.floor(Math.max(e||0,0)),this.length=Math.floor(Math.max(n||0,0)),this._nullCount=Math.floor(Math.max(r||0,-1));let c;s instanceof W?(this.stride=s.stride,this.values=s.values,this.typeIds=s.typeIds,this.nullBitmap=s.nullBitmap,this.valueOffsets=s.valueOffsets):(this.stride=Xt(t),s&&((c=s[0])&&(this.valueOffsets=c),(c=s[1])&&(this.values=c),(c=s[2])&&(this.nullBitmap=c),(c=s[3])&&(this.typeIds=c))),this.nullable=this._nullCount!==0&&this.nullBitmap&&this.nullBitmap.byteLength>0}get typeId(){return this.type.typeId}get ArrayType(){return this.type.ArrayType}get buffers(){return[this.valueOffsets,this.values,this.nullBitmap,this.typeIds]}get byteLength(){let t=0;const{valueOffsets:e,values:n,nullBitmap:r,typeIds:s}=this;return e&&(t+=e.byteLength),n&&(t+=n.byteLength),r&&(t+=r.byteLength),s&&(t+=s.byteLength),this.children.reduce((o,a)=>o+a.byteLength,t)}get nullCount(){let t=this._nullCount,e;return t<=jl&&(e=this.nullBitmap)&&(this._nullCount=t=this.length-Hn(e,this.offset,this.offset+this.length)),t}getValid(t){if(this.nullable&&this.nullCount>0){const e=this.offset+t;return(this.nullBitmap[e>>3]&1<<e%8)!==0}return!0}setValid(t,e){if(!this.nullable)return e;if(!this.nullBitmap||this.nullBitmap.byteLength<=t>>3){const{nullBitmap:c}=this._changeLengthAndBackfillNullBitmap(this.length);Object.assign(this,{nullBitmap:c,_nullCount:0})}const{nullBitmap:n,offset:r}=this,s=r+t>>3,o=(r+t)%8,a=n[s]>>o&1;return e?a===0&&(n[s]|=1<<o,this._nullCount=this.nullCount+1):a===1&&(n[s]&=~(1<<o),this._nullCount=this.nullCount-1),e}clone(t=this.type,e=this.offset,n=this.length,r=this._nullCount,s=this,o=this.children){return new W(t,e,n,r,s,o,this.dictionary)}slice(t,e){const{stride:n,typeId:r,children:s}=this,o=+(this._nullCount===0)-1,a=r===16?n:1,c=this._sliceBuffers(t,e,n,r);return this.clone(this.type,this.offset+t,e,o,c,s.length===0||this.valueOffsets?s:this._sliceChildren(s,a*t,a*e))}_changeLengthAndBackfillNullBitmap(t){if(this.typeId===h.Null)return this.clone(this.type,0,t,0);const{length:e,nullCount:n}=this,r=new Uint8Array((t+63&-64)>>3).fill(255,0,e>>3);r[e>>3]=(1<<e-(e&-8))-1,n>0&&r.set(Sr(this.offset,e,this.nullBitmap),0);const s=this.buffers;return s[Kt.VALIDITY]=r,this.clone(this.type,0,t,n+(t-e),s)}_sliceBuffers(t,e,n,r){let s;const{buffers:o}=this;return(s=o[Kt.TYPE])&&(o[Kt.TYPE]=s.subarray(t,t+e)),(s=o[Kt.OFFSET])&&(o[Kt.OFFSET]=s.subarray(t,t+e+1))||(s=o[Kt.DATA])&&(o[Kt.DATA]=r===6?s:s.subarray(n*t,n*(t+e))),o}_sliceChildren(t,e,n){return t.map(r=>r.slice(e,n))}}W.prototype.children=Object.freeze([]);class si extends M{visit(t){return this.getVisitFn(t.type).call(this,t)}visitNull(t){const{["type"]:e,["offset"]:n=0,["length"]:r=0}=t;return new W(e,n,r,0)}visitBool(t){const{["type"]:e,["offset"]:n=0}=t,r=C(t.nullBitmap),s=$(e.ArrayType,t.data),{["length"]:o=s.length>>3,["nullCount"]:a=t.nullBitmap?-1:0}=t;return new W(e,n,o,a,[void 0,s,r])}visitInt(t){const{["type"]:e,["offset"]:n=0}=t,r=C(t.nullBitmap),s=$(e.ArrayType,t.data),{["length"]:o=s.length,["nullCount"]:a=t.nullBitmap?-1:0}=t;return new W(e,n,o,a,[void 0,s,r])}visitFloat(t){const{["type"]:e,["offset"]:n=0}=t,r=C(t.nullBitmap),s=$(e.ArrayType,t.data),{["length"]:o=s.length,["nullCount"]:a=t.nullBitmap?-1:0}=t;return new W(e,n,o,a,[void 0,s,r])}visitUtf8(t){const{["type"]:e,["offset"]:n=0}=t,r=C(t.data),s=C(t.nullBitmap),o=ei(t.valueOffsets),{["length"]:a=o.length-1,["nullCount"]:c=t.nullBitmap?-1:0}=t;return new W(e,n,a,c,[o,r,s])}visitBinary(t){const{["type"]:e,["offset"]:n=0}=t,r=C(t.data),s=C(t.nullBitmap),o=ei(t.valueOffsets),{["length"]:a=o.length-1,["nullCount"]:c=t.nullBitmap?-1:0}=t;return new W(e,n,a,c,[o,r,s])}visitFixedSizeBinary(t){const{["type"]:e,["offset"]:n=0}=t,r=C(t.nullBitmap),s=$(e.ArrayType,t.data),{["length"]:o=s.length/Xt(e),["nullCount"]:a=t.nullBitmap?-1:0}=t;return new W(e,n,o,a,[void 0,s,r])}visitDate(t){const{["type"]:e,["offset"]:n=0}=t,r=C(t.nullBitmap),s=$(e.ArrayType,t.data),{["length"]:o=s.length/Xt(e),["nullCount"]:a=t.nullBitmap?-1:0}=t;return new W(e,n,o,a,[void 0,s,r])}visitTimestamp(t){const{["type"]:e,["offset"]:n=0}=t,r=C(t.nullBitmap),s=$(e.ArrayType,t.data),{["length"]:o=s.length/Xt(e),["nullCount"]:a=t.nullBitmap?-1:0}=t;return new W(e,n,o,a,[void 0,s,r])}visitTime(t){const{["type"]:e,["offset"]:n=0}=t,r=C(t.nullBitmap),s=$(e.ArrayType,t.data),{["length"]:o=s.length/Xt(e),["nullCount"]:a=t.nullBitmap?-1:0}=t;return new W(e,n,o,a,[void 0,s,r])}visitDecimal(t){const{["type"]:e,["offset"]:n=0}=t,r=C(t.nullBitmap),s=$(e.ArrayType,t.data),{["length"]:o=s.length/Xt(e),["nullCount"]:a=t.nullBitmap?-1:0}=t;return new W(e,n,o,a,[void 0,s,r])}visitList(t){const{["type"]:e,["offset"]:n=0,["child"]:r}=t,s=C(t.nullBitmap),o=ei(t.valueOffsets),{["length"]:a=o.length-1,["nullCount"]:c=t.nullBitmap?-1:0}=t;return new W(e,n,a,c,[o,void 0,s],[r])}visitStruct(t){const{["type"]:e,["offset"]:n=0,["children"]:r=[]}=t,s=C(t.nullBitmap),{length:o=r.reduce((c,{length:l})=>Math.max(c,l),0),nullCount:a=t.nullBitmap?-1:0}=t;return new W(e,n,o,a,[void 0,void 0,s],r)}visitUnion(t){const{["type"]:e,["offset"]:n=0,["children"]:r=[]}=t,s=C(t.nullBitmap),o=$(e.ArrayType,t.typeIds),{["length"]:a=o.length,["nullCount"]:c=t.nullBitmap?-1:0}=t;if(g.isSparseUnion(e))return new W(e,n,a,c,[void 0,void 0,s,o],r);const l=ei(t.valueOffsets);return new W(e,n,a,c,[l,void 0,s,o],r)}visitDictionary(t){const{["type"]:e,["offset"]:n=0}=t,r=C(t.nullBitmap),s=$(e.indices.ArrayType,t.data),{["dictionary"]:o=new N([new si().visit({type:e.dictionary})])}=t,{["length"]:a=s.length,["nullCount"]:c=t.nullBitmap?-1:0}=t;return new W(e,n,a,c,[void 0,s,r],[],o)}visitInterval(t){const{["type"]:e,["offset"]:n=0}=t,r=C(t.nullBitmap),s=$(e.ArrayType,t.data),{["length"]:o=s.length/Xt(e),["nullCount"]:a=t.nullBitmap?-1:0}=t;return new W(e,n,o,a,[void 0,s,r])}visitFixedSizeList(t){const{["type"]:e,["offset"]:n=0,["child"]:r=new si().visit({type:e.valueType})}=t,s=C(t.nullBitmap),{["length"]:o=r.length/Xt(e),["nullCount"]:a=t.nullBitmap?-1:0}=t;return new W(e,n,o,a,[void 0,void 0,s],[r])}visitMap(t){const{["type"]:e,["offset"]:n=0,["child"]:r=new si().visit({type:e.childType})}=t,s=C(t.nullBitmap),o=ei(t.valueOffsets),{["length"]:a=o.length-1,["nullCount"]:c=t.nullBitmap?-1:0}=t;return new W(e,n,a,c,[o,void 0,s],[r])}}function T(i){return new si().visit(i)}class is{constructor(t=0,e){this.numChunks=t,this.getChunkIterator=e,this.chunkIndex=0,this.chunkIterator=this.getChunkIterator(0)}next(){for(;this.chunkIndex<this.numChunks;){const t=this.chunkIterator.next();if(!t.done)return t;++this.chunkIndex<this.numChunks&&(this.chunkIterator=this.getChunkIterator(this.chunkIndex))}return{done:!0,value:null}}[Symbol.iterator](){return this}}function qo(i){return i.reduce((t,e)=>t+e.nullCount,0)}function Ko(i){return i.reduce((t,e,n)=>(t[n+1]=t[n]+e.length,t),new Uint32Array(i.length+1))}function Xo(i,t,e,n){const r=[];for(let s=-1,o=i.length;++s<o;){const a=i[s],c=t[s],{length:l}=a;if(c>=n)break;if(e>=c+l)continue;if(c>=e&&c+l<=n){r.push(a);continue}const u=Math.max(0,e-c),d=Math.min(n-c,l);r.push(a.slice(u,d-u))}return r.length===0&&r.push(i[0].slice(0,0)),r}function Br(i,t,e,n){let r=0,s=0,o=t.length-1;do{if(r>=o-1)return e<t[o]?n(i,r,e-t[r]):null;s=r+Math.trunc((o-r)*.5),e<t[s]?o=s:r=s}while(r<o)}function Or(i,t){return i.getValid(t)}function je(i){function t(e,n,r){return i(e[n],r)}return function(e){const n=this.data;return Br(n,this._offsets,e,t)}}function Zo(i){let t;function e(n,r,s){return i(n[r],s,t)}return function(n,r){const s=this.data;t=r;const o=Br(s,this._offsets,n,e);return t=void 0,o}}function Qo(i){let t;function e(n,r,s){let o=s,a=0,c=0;for(let l=r-1,u=n.length;++l<u;){const d=n[l];if(~(a=i(d,t,o)))return c+a;o=0,c+=d.length}return-1}return function(n,r){t=n;const s=this.data,o=typeof r!="number"?e(s,0,0):Br(s,this._offsets,r,e);return t=void 0,o}}class v extends M{}function Vl(i,t){return t===null&&i.length>0?0:-1}function Wl(i,t){const{nullBitmap:e}=i;if(!e||i.nullCount<=0)return-1;let n=0;for(const r of new Ir(e,i.offset+(t||0),i.length,e,Go)){if(!r)return n;++n}return-1}function D(i,t,e){if(t===void 0)return-1;if(t===null)return Wl(i,e);const n=ht.getVisitFn(i),r=Qe(t);for(let s=(e||0)-1,o=i.length;++s<o;)if(r(n(i,s)))return s;return-1}function ta(i,t,e){const n=ht.getVisitFn(i),r=Qe(t);for(let s=(e||0)-1,o=i.length;++s<o;)if(r(n(i,s)))return s;return-1}v.prototype.visitNull=Vl;v.prototype.visitBool=D;v.prototype.visitInt=D;v.prototype.visitInt8=D;v.prototype.visitInt16=D;v.prototype.visitInt32=D;v.prototype.visitInt64=D;v.prototype.visitUint8=D;v.prototype.visitUint16=D;v.prototype.visitUint32=D;v.prototype.visitUint64=D;v.prototype.visitFloat=D;v.prototype.visitFloat16=D;v.prototype.visitFloat32=D;v.prototype.visitFloat64=D;v.prototype.visitUtf8=D;v.prototype.visitBinary=D;v.prototype.visitFixedSizeBinary=D;v.prototype.visitDate=D;v.prototype.visitDateDay=D;v.prototype.visitDateMillisecond=D;v.prototype.visitTimestamp=D;v.prototype.visitTimestampSecond=D;v.prototype.visitTimestampMillisecond=D;v.prototype.visitTimestampMicrosecond=D;v.prototype.visitTimestampNanosecond=D;v.prototype.visitTime=D;v.prototype.visitTimeSecond=D;v.prototype.visitTimeMillisecond=D;v.prototype.visitTimeMicrosecond=D;v.prototype.visitTimeNanosecond=D;v.prototype.visitDecimal=D;v.prototype.visitList=D;v.prototype.visitStruct=D;v.prototype.visitUnion=D;v.prototype.visitDenseUnion=ta;v.prototype.visitSparseUnion=ta;v.prototype.visitDictionary=D;v.prototype.visitInterval=D;v.prototype.visitIntervalDayTime=D;v.prototype.visitIntervalYearMonth=D;v.prototype.visitFixedSizeList=D;v.prototype.visitMap=D;const Xi=new v;class _ extends M{}function B(i){const{type:t}=i;if(i.nullCount===0&&i.stride===1&&(t.typeId===h.Timestamp||t instanceof pe&&t.bitWidth!==64||t instanceof di&&t.bitWidth!==64||t instanceof hi&&t.precision!==lt.HALF))return new is(i.data.length,n=>{const r=i.data[n];return r.values.subarray(0,r.length)[Symbol.iterator]()});let e=0;return new is(i.data.length,n=>{const s=i.data[n].length,o=i.slice(e,e+s);return e+=s,new Yl(o)})}class Yl{constructor(t){this.vector=t,this.index=0}next(){return this.index<this.vector.length?{value:this.vector.get(this.index++)}:{done:!0,value:null}}[Symbol.iterator](){return this}}_.prototype.visitNull=B;_.prototype.visitBool=B;_.prototype.visitInt=B;_.prototype.visitInt8=B;_.prototype.visitInt16=B;_.prototype.visitInt32=B;_.prototype.visitInt64=B;_.prototype.visitUint8=B;_.prototype.visitUint16=B;_.prototype.visitUint32=B;_.prototype.visitUint64=B;_.prototype.visitFloat=B;_.prototype.visitFloat16=B;_.prototype.visitFloat32=B;_.prototype.visitFloat64=B;_.prototype.visitUtf8=B;_.prototype.visitBinary=B;_.prototype.visitFixedSizeBinary=B;_.prototype.visitDate=B;_.prototype.visitDateDay=B;_.prototype.visitDateMillisecond=B;_.prototype.visitTimestamp=B;_.prototype.visitTimestampSecond=B;_.prototype.visitTimestampMillisecond=B;_.prototype.visitTimestampMicrosecond=B;_.prototype.visitTimestampNanosecond=B;_.prototype.visitTime=B;_.prototype.visitTimeSecond=B;_.prototype.visitTimeMillisecond=B;_.prototype.visitTimeMicrosecond=B;_.prototype.visitTimeNanosecond=B;_.prototype.visitDecimal=B;_.prototype.visitList=B;_.prototype.visitStruct=B;_.prototype.visitUnion=B;_.prototype.visitDenseUnion=B;_.prototype.visitSparseUnion=B;_.prototype.visitDictionary=B;_.prototype.visitInterval=B;_.prototype.visitIntervalDayTime=B;_.prototype.visitIntervalYearMonth=B;_.prototype.visitFixedSizeList=B;_.prototype.visitMap=B;const Ar=new _,Hl=(i,t)=>i+t;class ve extends M{visitNull(t,e){return 0}visitInt(t,e){return t.type.bitWidth/8}visitFloat(t,e){return t.type.ArrayType.BYTES_PER_ELEMENT}visitBool(t,e){return 1/8}visitDecimal(t,e){return t.type.bitWidth/8}visitDate(t,e){return(t.type.unit+1)*4}visitTime(t,e){return t.type.bitWidth/8}visitTimestamp(t,e){return t.type.unit===L.SECOND?4:8}visitInterval(t,e){return(t.type.unit+1)*4}visitStruct(t,e){return t.children.reduce((n,r)=>n+Ht.visit(r,e),0)}visitFixedSizeBinary(t,e){return t.type.byteWidth}visitMap(t,e){return 8+t.children.reduce((n,r)=>n+Ht.visit(r,e),0)}visitDictionary(t,e){var n;return t.type.indices.bitWidth/8+(((n=t.dictionary)===null||n===void 0?void 0:n.getByteLength(t.values[e]))||0)}}const Jl=({valueOffsets:i},t)=>8+(i[t+1]-i[t]),Gl=({valueOffsets:i},t)=>8+(i[t+1]-i[t]),ql=({valueOffsets:i,stride:t,children:e},n)=>{const r=e[0],{[n*t]:s}=i,{[n*t+1]:o}=i,a=Ht.getVisitFn(r.type),c=r.slice(s,o-s);let l=8;for(let u=-1,d=o-s;++u<d;)l+=a(c,u);return l},Kl=({stride:i,children:t},e)=>{const n=t[0],r=n.slice(e*i,i),s=Ht.getVisitFn(n.type);let o=0;for(let a=-1,c=r.length;++a<c;)o+=s(r,a);return o},Xl=(i,t)=>i.type.mode===gt.Dense?ea(i,t):ia(i,t),ea=({type:i,children:t,typeIds:e,valueOffsets:n},r)=>{const s=i.typeIdToChildIndex[e[r]];return 8+Ht.visit(t[s],n[r])},ia=({children:i},t)=>4+Ht.visitMany(i,i.map(()=>t)).reduce(Hl,0);ve.prototype.visitUtf8=Jl;ve.prototype.visitBinary=Gl;ve.prototype.visitList=ql;ve.prototype.visitFixedSizeList=Kl;ve.prototype.visitUnion=Xl;ve.prototype.visitDenseUnion=ea;ve.prototype.visitSparseUnion=ia;const Ht=new ve;var na;const ra={},sa={};class N{constructor(t){var e,n,r;const s=t[0]instanceof N?t.flatMap(a=>a.data):t;if(s.length===0||s.some(a=>!(a instanceof W)))throw new TypeError("Vector constructor expects an Array of Data instances.");const o=(e=s[0])===null||e===void 0?void 0:e.type;switch(s.length){case 0:this._offsets=[0];break;case 1:{const{get:a,set:c,indexOf:l,byteLength:u}=ra[o.typeId],d=s[0];this.isValid=p=>Or(d,p),this.get=p=>a(d,p),this.set=(p,f)=>c(d,p,f),this.indexOf=p=>l(d,p),this.getByteLength=p=>u(d,p),this._offsets=[0,d.length];break}default:Object.setPrototypeOf(this,sa[o.typeId]),this._offsets=Ko(s);break}this.data=s,this.type=o,this.stride=Xt(o),this.numChildren=(r=(n=o.children)===null||n===void 0?void 0:n.length)!==null&&r!==void 0?r:0,this.length=this._offsets[this._offsets.length-1]}get byteLength(){return this._byteLength===-1&&(this._byteLength=this.data.reduce((t,e)=>t+e.byteLength,0)),this._byteLength}get nullCount(){return this._nullCount===-1&&(this._nullCount=qo(this.data)),this._nullCount}get ArrayType(){return this.type.ArrayType}get[Symbol.toStringTag](){return`${this.VectorName}<${this.type[Symbol.toStringTag]}>`}get VectorName(){return`${h[this.type.typeId]}Vector`}isValid(t){return!1}get(t){return null}set(t,e){}indexOf(t,e){return-1}includes(t,e){return this.indexOf(t,e)>0}getByteLength(t){return 0}[Symbol.iterator](){return Ar.visit(this)}concat(...t){return new N(this.data.concat(t.flatMap(e=>e.data).flat(Number.POSITIVE_INFINITY)))}slice(t,e){return new N(Jo(this,t,e,({data:n,_offsets:r},s,o)=>Xo(n,r,s,o)))}toJSON(){return[...this]}toArray(){const{type:t,data:e,length:n,stride:r,ArrayType:s}=this;switch(t.typeId){case h.Int:case h.Float:case h.Decimal:case h.Time:case h.Timestamp:switch(e.length){case 0:return new s;case 1:return e[0].values.subarray(0,n*r);default:return e.reduce((o,{values:a,length:c})=>(o.array.set(a.subarray(0,c*r),o.offset),o.offset+=c*r,o),{array:new s(n*r),offset:0}).array}}return[...this]}toString(){return`[${[...this].join(",")}]`}getChild(t){var e;return this.getChildAt((e=this.type.children)===null||e===void 0?void 0:e.findIndex(n=>n.name===t))}getChildAt(t){return t>-1&&t<this.numChildren?new N(this.data.map(({children:e})=>e[t])):null}get isMemoized(){return g.isDictionary(this.type)?this.data[0].dictionary.isMemoized:!1}memoize(){if(g.isDictionary(this.type)){const t=new Zi(this.data[0].dictionary),e=this.data.map(n=>{const r=n.clone();return r.dictionary=t,r});return new N(e)}return new Zi(this)}unmemoize(){if(g.isDictionary(this.type)&&this.isMemoized){const t=this.data[0].dictionary.unmemoize(),e=this.data.map(n=>{const r=n.clone();return r.dictionary=t,r});return new N(e)}return this}}na=Symbol.toStringTag;N[na]=(i=>{i.type=g.prototype,i.data=[],i.length=0,i.stride=1,i.numChildren=0,i._nullCount=-1,i._byteLength=-1,i._offsets=new Uint32Array([0]),i[Symbol.isConcatSpreadable]=!0;const t=Object.keys(h).map(e=>h[e]).filter(e=>typeof e=="number"&&e!==h.NONE);for(const e of t){const n=ht.getVisitFnByTypeId(e),r=At.getVisitFnByTypeId(e),s=Xi.getVisitFnByTypeId(e),o=Ht.getVisitFnByTypeId(e);ra[e]={get:n,set:r,indexOf:s,byteLength:o},sa[e]=Object.create(i,{isValid:{value:je(Or)},get:{value:je(ht.getVisitFnByTypeId(e))},set:{value:Zo(At.getVisitFnByTypeId(e))},indexOf:{value:Qo(Xi.getVisitFnByTypeId(e))},getByteLength:{value:je(Ht.getVisitFnByTypeId(e))}})}return"Vector"})(N.prototype);class Zi extends N{constructor(t){super(t.data);const e=this.get,n=this.set,r=this.slice,s=new Array(this.length);Object.defineProperty(this,"get",{value(o){const a=s[o];if(a!==void 0)return a;const c=e.call(this,o);return s[o]=c,c}}),Object.defineProperty(this,"set",{value(o,a){n.call(this,o,a),s[o]=a}}),Object.defineProperty(this,"slice",{value:(o,a)=>new Zi(r.call(this,o,a))}),Object.defineProperty(this,"isMemoized",{value:!0}),Object.defineProperty(this,"unmemoize",{value:()=>new N(this.data)}),Object.defineProperty(this,"memoize",{value:()=>this})}}class Jn{constructor(){this.bb=null,this.bb_pos=0}__init(t,e){return this.bb_pos=t,this.bb=e,this}offset(){return this.bb.readInt64(this.bb_pos)}metaDataLength(){return this.bb.readInt32(this.bb_pos+8)}bodyLength(){return this.bb.readInt64(this.bb_pos+16)}static sizeOf(){return 24}static createBlock(t,e,n,r){return t.prep(8,24),t.writeInt64(r),t.pad(4),t.writeInt32(n),t.writeInt64(e),t.offset()}}const Ln=2,kt=4,Qt=4,j=4,ce=new Int32Array(2),ns=new Float32Array(ce.buffer),rs=new Float64Array(ce.buffer),Ai=new Uint16Array(new Uint8Array([1,0]).buffer)[0]===1;let ee=class Gn{constructor(t,e){this.low=t|0,this.high=e|0}static create(t,e){return t==0&&e==0?Gn.ZERO:new Gn(t,e)}toFloat64(){return(this.low>>>0)+this.high*4294967296}equals(t){return this.low==t.low&&this.high==t.high}};ee.ZERO=new ee(0,0);var qn;(function(i){i[i.UTF8_BYTES=1]="UTF8_BYTES",i[i.UTF16_STRING=2]="UTF16_STRING"})(qn||(qn={}));let We=class oa{constructor(t){this.bytes_=t,this.position_=0}static allocate(t){return new oa(new Uint8Array(t))}clear(){this.position_=0}bytes(){return this.bytes_}position(){return this.position_}setPosition(t){this.position_=t}capacity(){return this.bytes_.length}readInt8(t){return this.readUint8(t)<<24>>24}readUint8(t){return this.bytes_[t]}readInt16(t){return this.readUint16(t)<<16>>16}readUint16(t){return this.bytes_[t]|this.bytes_[t+1]<<8}readInt32(t){return this.bytes_[t]|this.bytes_[t+1]<<8|this.bytes_[t+2]<<16|this.bytes_[t+3]<<24}readUint32(t){return this.readInt32(t)>>>0}readInt64(t){return new ee(this.readInt32(t),this.readInt32(t+4))}readUint64(t){return new ee(this.readUint32(t),this.readUint32(t+4))}readFloat32(t){return ce[0]=this.readInt32(t),ns[0]}readFloat64(t){return ce[Ai?0:1]=this.readInt32(t),ce[Ai?1:0]=this.readInt32(t+4),rs[0]}writeInt8(t,e){this.bytes_[t]=e}writeUint8(t,e){this.bytes_[t]=e}writeInt16(t,e){this.bytes_[t]=e,this.bytes_[t+1]=e>>8}writeUint16(t,e){this.bytes_[t]=e,this.bytes_[t+1]=e>>8}writeInt32(t,e){this.bytes_[t]=e,this.bytes_[t+1]=e>>8,this.bytes_[t+2]=e>>16,this.bytes_[t+3]=e>>24}writeUint32(t,e){this.bytes_[t]=e,this.bytes_[t+1]=e>>8,this.bytes_[t+2]=e>>16,this.bytes_[t+3]=e>>24}writeInt64(t,e){this.writeInt32(t,e.low),this.writeInt32(t+4,e.high)}writeUint64(t,e){this.writeUint32(t,e.low),this.writeUint32(t+4,e.high)}writeFloat32(t,e){ns[0]=e,this.writeInt32(t,ce[0])}writeFloat64(t,e){rs[0]=e,this.writeInt32(t,ce[Ai?0:1]),this.writeInt32(t+4,ce[Ai?1:0])}getBufferIdentifier(){if(this.bytes_.length<this.position_+kt+Qt)throw new Error("FlatBuffers: ByteBuffer is too short to contain an identifier.");let t="";for(let e=0;e<Qt;e++)t+=String.fromCharCode(this.readInt8(this.position_+kt+e));return t}__offset(t,e){const n=t-this.readInt32(t);return e<this.readInt16(n)?this.readInt16(n+e):0}__union(t,e){return t.bb_pos=e+this.readInt32(e),t.bb=this,t}__string(t,e){t+=this.readInt32(t);const n=this.readInt32(t);let r="",s=0;if(t+=kt,e===qn.UTF8_BYTES)return this.bytes_.subarray(t,t+n);for(;s<n;){let o;const a=this.readUint8(t+s++);if(a<192)o=a;else{const c=this.readUint8(t+s++);if(a<224)o=(a&31)<<6|c&63;else{const l=this.readUint8(t+s++);if(a<240)o=(a&15)<<12|(c&63)<<6|l&63;else{const u=this.readUint8(t+s++);o=(a&7)<<18|(c&63)<<12|(l&63)<<6|u&63}}}o<65536?r+=String.fromCharCode(o):(o-=65536,r+=String.fromCharCode((o>>10)+55296,(o&1023)+56320))}return r}__union_with_string(t,e){return typeof t=="string"?this.__string(e):this.__union(t,e)}__indirect(t){return t+this.readInt32(t)}__vector(t){return t+this.readInt32(t)+kt}__vector_len(t){return this.readInt32(t+this.readInt32(t))}__has_identifier(t){if(t.length!=Qt)throw new Error("FlatBuffers: file identifier must be length "+Qt);for(let e=0;e<Qt;e++)if(t.charCodeAt(e)!=this.readInt8(this.position()+kt+e))return!1;return!0}createLong(t,e){return ee.create(t,e)}createScalarList(t,e){const n=[];for(let r=0;r<e;++r)t(r)!==null&&n.push(t(r));return n}createObjList(t,e){const n=[];for(let r=0;r<e;++r){const s=t(r);s!==null&&n.push(s.unpack())}return n}},aa=class ca{constructor(t){this.minalign=1,this.vtable=null,this.vtable_in_use=0,this.isNested=!1,this.object_start=0,this.vtables=[],this.vector_num_elems=0,this.force_defaults=!1,this.string_maps=null;let e;t?e=t:e=1024,this.bb=We.allocate(e),this.space=e}clear(){this.bb.clear(),this.space=this.bb.capacity(),this.minalign=1,this.vtable=null,this.vtable_in_use=0,this.isNested=!1,this.object_start=0,this.vtables=[],this.vector_num_elems=0,this.force_defaults=!1,this.string_maps=null}forceDefaults(t){this.force_defaults=t}dataBuffer(){return this.bb}asUint8Array(){return this.bb.bytes().subarray(this.bb.position(),this.bb.position()+this.offset())}prep(t,e){t>this.minalign&&(this.minalign=t);const n=~(this.bb.capacity()-this.space+e)+1&t-1;for(;this.space<n+t+e;){const r=this.bb.capacity();this.bb=ca.growByteBuffer(this.bb),this.space+=this.bb.capacity()-r}this.pad(n)}pad(t){for(let e=0;e<t;e++)this.bb.writeInt8(--this.space,0)}writeInt8(t){this.bb.writeInt8(this.space-=1,t)}writeInt16(t){this.bb.writeInt16(this.space-=2,t)}writeInt32(t){this.bb.writeInt32(this.space-=4,t)}writeInt64(t){this.bb.writeInt64(this.space-=8,t)}writeFloat32(t){this.bb.writeFloat32(this.space-=4,t)}writeFloat64(t){this.bb.writeFloat64(this.space-=8,t)}addInt8(t){this.prep(1,0),this.writeInt8(t)}addInt16(t){this.prep(2,0),this.writeInt16(t)}addInt32(t){this.prep(4,0),this.writeInt32(t)}addInt64(t){this.prep(8,0),this.writeInt64(t)}addFloat32(t){this.prep(4,0),this.writeFloat32(t)}addFloat64(t){this.prep(8,0),this.writeFloat64(t)}addFieldInt8(t,e,n){(this.force_defaults||e!=n)&&(this.addInt8(e),this.slot(t))}addFieldInt16(t,e,n){(this.force_defaults||e!=n)&&(this.addInt16(e),this.slot(t))}addFieldInt32(t,e,n){(this.force_defaults||e!=n)&&(this.addInt32(e),this.slot(t))}addFieldInt64(t,e,n){(this.force_defaults||!e.equals(n))&&(this.addInt64(e),this.slot(t))}addFieldFloat32(t,e,n){(this.force_defaults||e!=n)&&(this.addFloat32(e),this.slot(t))}addFieldFloat64(t,e,n){(this.force_defaults||e!=n)&&(this.addFloat64(e),this.slot(t))}addFieldOffset(t,e,n){(this.force_defaults||e!=n)&&(this.addOffset(e),this.slot(t))}addFieldStruct(t,e,n){e!=n&&(this.nested(e),this.slot(t))}nested(t){if(t!=this.offset())throw new Error("FlatBuffers: struct must be serialized inline.")}notNested(){if(this.isNested)throw new Error("FlatBuffers: object serialization must not be nested.")}slot(t){this.vtable!==null&&(this.vtable[t]=this.offset())}offset(){return this.bb.capacity()-this.space}static growByteBuffer(t){const e=t.capacity();if(e&3221225472)throw new Error("FlatBuffers: cannot grow buffer beyond 2 gigabytes.");const n=e<<1,r=We.allocate(n);return r.setPosition(n-e),r.bytes().set(t.bytes(),n-e),r}addOffset(t){this.prep(kt,0),this.writeInt32(this.offset()-t+kt)}startObject(t){this.notNested(),this.vtable==null&&(this.vtable=[]),this.vtable_in_use=t;for(let e=0;e<t;e++)this.vtable[e]=0;this.isNested=!0,this.object_start=this.offset()}endObject(){if(this.vtable==null||!this.isNested)throw new Error("FlatBuffers: endObject called without startObject");this.addInt32(0);const t=this.offset();let e=this.vtable_in_use-1;for(;e>=0&&this.vtable[e]==0;e--);const n=e+1;for(;e>=0;e--)this.addInt16(this.vtable[e]!=0?t-this.vtable[e]:0);const r=2;this.addInt16(t-this.object_start);const s=(n+r)*Ln;this.addInt16(s);let o=0;const a=this.space;t:for(e=0;e<this.vtables.length;e++){const c=this.bb.capacity()-this.vtables[e];if(s==this.bb.readInt16(c)){for(let l=Ln;l<s;l+=Ln)if(this.bb.readInt16(a+l)!=this.bb.readInt16(c+l))continue t;o=this.vtables[e];break}}return o?(this.space=this.bb.capacity()-t,this.bb.writeInt32(this.space,o-t)):(this.vtables.push(this.offset()),this.bb.writeInt32(this.bb.capacity()-t,this.offset()-t)),this.isNested=!1,t}finish(t,e,n){const r=n?j:0;if(e){const s=e;if(this.prep(this.minalign,kt+Qt+r),s.length!=Qt)throw new Error("FlatBuffers: file identifier must be length "+Qt);for(let o=Qt-1;o>=0;o--)this.writeInt8(s.charCodeAt(o))}this.prep(this.minalign,kt+r),this.addOffset(t),r&&this.addInt32(this.bb.capacity()-this.space),this.bb.setPosition(this.space)}finishSizePrefixed(t,e){this.finish(t,e,!0)}requiredField(t,e){const n=this.bb.capacity()-t,r=n-this.bb.readInt32(n);if(!(this.bb.readInt16(r+e)!=0))throw new Error("FlatBuffers: field "+e+" must be set")}startVector(t,e,n){this.notNested(),this.vector_num_elems=e,this.prep(kt,t*e),this.prep(n,t*e)}endVector(){return this.writeInt32(this.vector_num_elems),this.offset()}createSharedString(t){if(!t)return 0;if(this.string_maps||(this.string_maps=new Map),this.string_maps.has(t))return this.string_maps.get(t);const e=this.createString(t);return this.string_maps.set(t,e),e}createString(t){if(!t)return 0;let e;if(t instanceof Uint8Array)e=t;else{e=[];let n=0;for(;n<t.length;){let r;const s=t.charCodeAt(n++);if(s<55296||s>=56320)r=s;else{const o=t.charCodeAt(n++);r=(s<<10)+o+-56613888}r<128?e.push(r):(r<2048?e.push(r>>6&31|192):(r<65536?e.push(r>>12&15|224):e.push(r>>18&7|240,r>>12&63|128),e.push(r>>6&63|128)),e.push(r&63|128))}}this.addInt8(0),this.startVector(1,e.length,1),this.bb.setPosition(this.space-=e.length);for(let n=0,r=this.space,s=this.bb.bytes();n<e.length;n++)s[r++]=e[n];return this.endVector()}createLong(t,e){return ee.create(t,e)}createObjectOffset(t){return t===null?0:typeof t=="string"?this.createString(t):t.pack(this)}createObjectOffsetList(t){const e=[];for(let n=0;n<t.length;++n){const r=t[n];if(r!==null)e.push(this.createObjectOffset(r));else throw new Error("FlatBuffers: Argument for createObjectOffsetList cannot contain null.")}return e}createStructOffsetList(t,e){return e(this,t.length),this.createObjectOffsetList(t),this.endVector()}};class X{constructor(){this.bb=null,this.bb_pos=0}__init(t,e){return this.bb_pos=t,this.bb=e,this}static getRootAsKeyValue(t,e){return(e||new X).__init(t.readInt32(t.position())+t.position(),t)}static getSizePrefixedRootAsKeyValue(t,e){return t.setPosition(t.position()+j),(e||new X).__init(t.readInt32(t.position())+t.position(),t)}key(t){const e=this.bb.__offset(this.bb_pos,4);return e?this.bb.__string(this.bb_pos+e,t):null}value(t){const e=this.bb.__offset(this.bb_pos,6);return e?this.bb.__string(this.bb_pos+e,t):null}static startKeyValue(t){t.startObject(2)}static addKey(t,e){t.addFieldOffset(0,e,0)}static addValue(t,e){t.addFieldOffset(1,e,0)}static endKeyValue(t){return t.endObject()}static createKeyValue(t,e,n){return X.startKeyValue(t),X.addKey(t,e),X.addValue(t,n),X.endKeyValue(t)}}var Ye;(function(i){i[i.V1=0]="V1",i[i.V2=1]="V2",i[i.V3=2]="V3",i[i.V4=3]="V4",i[i.V5=4]="V5"})(Ye||(Ye={}));var He;(function(i){i[i.Little=0]="Little",i[i.Big=1]="Big"})(He||(He={}));var Qi;(function(i){i[i.DenseArray=0]="DenseArray"})(Qi||(Qi={}));class yt{constructor(){this.bb=null,this.bb_pos=0}__init(t,e){return this.bb_pos=t,this.bb=e,this}static getRootAsInt(t,e){return(e||new yt).__init(t.readInt32(t.position())+t.position(),t)}static getSizePrefixedRootAsInt(t,e){return t.setPosition(t.position()+j),(e||new yt).__init(t.readInt32(t.position())+t.position(),t)}bitWidth(){const t=this.bb.__offset(this.bb_pos,4);return t?this.bb.readInt32(this.bb_pos+t):0}isSigned(){const t=this.bb.__offset(this.bb_pos,6);return t?!!this.bb.readInt8(this.bb_pos+t):!1}static startInt(t){t.startObject(2)}static addBitWidth(t,e){t.addFieldInt32(0,e,0)}static addIsSigned(t,e){t.addFieldInt8(1,+e,0)}static endInt(t){return t.endObject()}static createInt(t,e,n){return yt.startInt(t),yt.addBitWidth(t,e),yt.addIsSigned(t,n),yt.endInt(t)}}class te{constructor(){this.bb=null,this.bb_pos=0}__init(t,e){return this.bb_pos=t,this.bb=e,this}static getRootAsDictionaryEncoding(t,e){return(e||new te).__init(t.readInt32(t.position())+t.position(),t)}static getSizePrefixedRootAsDictionaryEncoding(t,e){return t.setPosition(t.position()+j),(e||new te).__init(t.readInt32(t.position())+t.position(),t)}id(){const t=this.bb.__offset(this.bb_pos,4);return t?this.bb.readInt64(this.bb_pos+t):this.bb.createLong(0,0)}indexType(t){const e=this.bb.__offset(this.bb_pos,6);return e?(t||new yt).__init(this.bb.__indirect(this.bb_pos+e),this.bb):null}isOrdered(){const t=this.bb.__offset(this.bb_pos,8);return t?!!this.bb.readInt8(this.bb_pos+t):!1}dictionaryKind(){const t=this.bb.__offset(this.bb_pos,10);return t?this.bb.readInt16(this.bb_pos+t):Qi.DenseArray}static startDictionaryEncoding(t){t.startObject(4)}static addId(t,e){t.addFieldInt64(0,e,t.createLong(0,0))}static addIndexType(t,e){t.addFieldOffset(1,e,0)}static addIsOrdered(t,e){t.addFieldInt8(2,+e,0)}static addDictionaryKind(t,e){t.addFieldInt16(3,e,Qi.DenseArray)}static endDictionaryEncoding(t){return t.endObject()}}class Se{constructor(){this.bb=null,this.bb_pos=0}__init(t,e){return this.bb_pos=t,this.bb=e,this}static getRootAsBinary(t,e){return(e||new Se).__init(t.readInt32(t.position())+t.position(),t)}static getSizePrefixedRootAsBinary(t,e){return t.setPosition(t.position()+j),(e||new Se).__init(t.readInt32(t.position())+t.position(),t)}static startBinary(t){t.startObject(0)}static endBinary(t){return t.endObject()}static createBinary(t){return Se.startBinary(t),Se.endBinary(t)}}class Ie{constructor(){this.bb=null,this.bb_pos=0}__init(t,e){return this.bb_pos=t,this.bb=e,this}static getRootAsBool(t,e){return(e||new Ie).__init(t.readInt32(t.position())+t.position(),t)}static getSizePrefixedRootAsBool(t,e){return t.setPosition(t.position()+j),(e||new Ie).__init(t.readInt32(t.position())+t.position(),t)}static startBool(t){t.startObject(0)}static endBool(t){return t.endObject()}static createBool(t){return Ie.startBool(t),Ie.endBool(t)}}var tn;(function(i){i[i.DAY=0]="DAY",i[i.MILLISECOND=1]="MILLISECOND"})(tn||(tn={}));let Ci=class Ne{constructor(){this.bb=null,this.bb_pos=0}__init(t,e){return this.bb_pos=t,this.bb=e,this}static getRootAsDate(t,e){return(e||new Ne).__init(t.readInt32(t.position())+t.position(),t)}static getSizePrefixedRootAsDate(t,e){return t.setPosition(t.position()+j),(e||new Ne).__init(t.readInt32(t.position())+t.position(),t)}unit(){const t=this.bb.__offset(this.bb_pos,4);return t?this.bb.readInt16(this.bb_pos+t):tn.MILLISECOND}static startDate(t){t.startObject(1)}static addUnit(t,e){t.addFieldInt16(0,e,tn.MILLISECOND)}static endDate(t){return t.endObject()}static createDate(t,e){return Ne.startDate(t),Ne.addUnit(t,e),Ne.endDate(t)}};class ot{constructor(){this.bb=null,this.bb_pos=0}__init(t,e){return this.bb_pos=t,this.bb=e,this}static getRootAsDecimal(t,e){return(e||new ot).__init(t.readInt32(t.position())+t.position(),t)}static getSizePrefixedRootAsDecimal(t,e){return t.setPosition(t.position()+j),(e||new ot).__init(t.readInt32(t.position())+t.position(),t)}precision(){const t=this.bb.__offset(this.bb_pos,4);return t?this.bb.readInt32(this.bb_pos+t):0}scale(){const t=this.bb.__offset(this.bb_pos,6);return t?this.bb.readInt32(this.bb_pos+t):0}bitWidth(){const t=this.bb.__offset(this.bb_pos,8);return t?this.bb.readInt32(this.bb_pos+t):128}static startDecimal(t){t.startObject(3)}static addPrecision(t,e){t.addFieldInt32(0,e,0)}static addScale(t,e){t.addFieldInt32(1,e,0)}static addBitWidth(t,e){t.addFieldInt32(2,e,128)}static endDecimal(t){return t.endObject()}static createDecimal(t,e,n,r){return ot.startDecimal(t),ot.addPrecision(t,e),ot.addScale(t,n),ot.addBitWidth(t,r),ot.endDecimal(t)}}var Je;(function(i){i[i.SECOND=0]="SECOND",i[i.MILLISECOND=1]="MILLISECOND",i[i.MICROSECOND=2]="MICROSECOND",i[i.NANOSECOND=3]="NANOSECOND"})(Je||(Je={}));class Pt{constructor(){this.bb=null,this.bb_pos=0}__init(t,e){return this.bb_pos=t,this.bb=e,this}static getRootAsFixedSizeBinary(t,e){return(e||new Pt).__init(t.readInt32(t.position())+t.position(),t)}static getSizePrefixedRootAsFixedSizeBinary(t,e){return t.setPosition(t.position()+j),(e||new Pt).__init(t.readInt32(t.position())+t.position(),t)}byteWidth(){const t=this.bb.__offset(this.bb_pos,4);return t?this.bb.readInt32(this.bb_pos+t):0}static startFixedSizeBinary(t){t.startObject(1)}static addByteWidth(t,e){t.addFieldInt32(0,e,0)}static endFixedSizeBinary(t){return t.endObject()}static createFixedSizeBinary(t,e){return Pt.startFixedSizeBinary(t),Pt.addByteWidth(t,e),Pt.endFixedSizeBinary(t)}}class zt{constructor(){this.bb=null,this.bb_pos=0}__init(t,e){return this.bb_pos=t,this.bb=e,this}static getRootAsFixedSizeList(t,e){return(e||new zt).__init(t.readInt32(t.position())+t.position(),t)}static getSizePrefixedRootAsFixedSizeList(t,e){return t.setPosition(t.position()+j),(e||new zt).__init(t.readInt32(t.position())+t.position(),t)}listSize(){const t=this.bb.__offset(this.bb_pos,4);return t?this.bb.readInt32(this.bb_pos+t):0}static startFixedSizeList(t){t.startObject(1)}static addListSize(t,e){t.addFieldInt32(0,e,0)}static endFixedSizeList(t){return t.endObject()}static createFixedSizeList(t,e){return zt.startFixedSizeList(t),zt.addListSize(t,e),zt.endFixedSizeList(t)}}var en;(function(i){i[i.HALF=0]="HALF",i[i.SINGLE=1]="SINGLE",i[i.DOUBLE=2]="DOUBLE"})(en||(en={}));class $t{constructor(){this.bb=null,this.bb_pos=0}__init(t,e){return this.bb_pos=t,this.bb=e,this}static getRootAsFloatingPoint(t,e){return(e||new $t).__init(t.readInt32(t.position())+t.position(),t)}static getSizePrefixedRootAsFloatingPoint(t,e){return t.setPosition(t.position()+j),(e||new $t).__init(t.readInt32(t.position())+t.position(),t)}precision(){const t=this.bb.__offset(this.bb_pos,4);return t?this.bb.readInt16(this.bb_pos+t):en.HALF}static startFloatingPoint(t){t.startObject(1)}static addPrecision(t,e){t.addFieldInt16(0,e,en.HALF)}static endFloatingPoint(t){return t.endObject()}static createFloatingPoint(t,e){return $t.startFloatingPoint(t),$t.addPrecision(t,e),$t.endFloatingPoint(t)}}var nn;(function(i){i[i.YEAR_MONTH=0]="YEAR_MONTH",i[i.DAY_TIME=1]="DAY_TIME",i[i.MONTH_DAY_NANO=2]="MONTH_DAY_NANO"})(nn||(nn={}));class jt{constructor(){this.bb=null,this.bb_pos=0}__init(t,e){return this.bb_pos=t,this.bb=e,this}static getRootAsInterval(t,e){return(e||new jt).__init(t.readInt32(t.position())+t.position(),t)}static getSizePrefixedRootAsInterval(t,e){return t.setPosition(t.position()+j),(e||new jt).__init(t.readInt32(t.position())+t.position(),t)}unit(){const t=this.bb.__offset(this.bb_pos,4);return t?this.bb.readInt16(this.bb_pos+t):nn.YEAR_MONTH}static startInterval(t){t.startObject(1)}static addUnit(t,e){t.addFieldInt16(0,e,nn.YEAR_MONTH)}static endInterval(t){return t.endObject()}static createInterval(t,e){return jt.startInterval(t),jt.addUnit(t,e),jt.endInterval(t)}}class Be{constructor(){this.bb=null,this.bb_pos=0}__init(t,e){return this.bb_pos=t,this.bb=e,this}static getRootAsList(t,e){return(e||new Be).__init(t.readInt32(t.position())+t.position(),t)}static getSizePrefixedRootAsList(t,e){return t.setPosition(t.position()+j),(e||new Be).__init(t.readInt32(t.position())+t.position(),t)}static startList(t){t.startObject(0)}static endList(t){return t.endObject()}static createList(t){return Be.startList(t),Be.endList(t)}}let Li=class xe{constructor(){this.bb=null,this.bb_pos=0}__init(t,e){return this.bb_pos=t,this.bb=e,this}static getRootAsMap(t,e){return(e||new xe).__init(t.readInt32(t.position())+t.position(),t)}static getSizePrefixedRootAsMap(t,e){return t.setPosition(t.position()+j),(e||new xe).__init(t.readInt32(t.position())+t.position(),t)}keysSorted(){const t=this.bb.__offset(this.bb_pos,4);return t?!!this.bb.readInt8(this.bb_pos+t):!1}static startMap(t){t.startObject(1)}static addKeysSorted(t,e){t.addFieldInt8(0,+e,0)}static endMap(t){return t.endObject()}static createMap(t,e){return xe.startMap(t),xe.addKeysSorted(t,e),xe.endMap(t)}};class Oe{constructor(){this.bb=null,this.bb_pos=0}__init(t,e){return this.bb_pos=t,this.bb=e,this}static getRootAsNull(t,e){return(e||new Oe).__init(t.readInt32(t.position())+t.position(),t)}static getSizePrefixedRootAsNull(t,e){return t.setPosition(t.position()+j),(e||new Oe).__init(t.readInt32(t.position())+t.position(),t)}static startNull(t){t.startObject(0)}static endNull(t){return t.endObject()}static createNull(t){return Oe.startNull(t),Oe.endNull(t)}}class Ae{constructor(){this.bb=null,this.bb_pos=0}__init(t,e){return this.bb_pos=t,this.bb=e,this}static getRootAsStruct_(t,e){return(e||new Ae).__init(t.readInt32(t.position())+t.position(),t)}static getSizePrefixedRootAsStruct_(t,e){return t.setPosition(t.position()+j),(e||new Ae).__init(t.readInt32(t.position())+t.position(),t)}static startStruct_(t){t.startObject(0)}static endStruct_(t){return t.endObject()}static createStruct_(t){return Ae.startStruct_(t),Ae.endStruct_(t)}}class Bt{constructor(){this.bb=null,this.bb_pos=0}__init(t,e){return this.bb_pos=t,this.bb=e,this}static getRootAsTime(t,e){return(e||new Bt).__init(t.readInt32(t.position())+t.position(),t)}static getSizePrefixedRootAsTime(t,e){return t.setPosition(t.position()+j),(e||new Bt).__init(t.readInt32(t.position())+t.position(),t)}unit(){const t=this.bb.__offset(this.bb_pos,4);return t?this.bb.readInt16(this.bb_pos+t):Je.MILLISECOND}bitWidth(){const t=this.bb.__offset(this.bb_pos,6);return t?this.bb.readInt32(this.bb_pos+t):32}static startTime(t){t.startObject(2)}static addUnit(t,e){t.addFieldInt16(0,e,Je.MILLISECOND)}static addBitWidth(t,e){t.addFieldInt32(1,e,32)}static endTime(t){return t.endObject()}static createTime(t,e,n){return Bt.startTime(t),Bt.addUnit(t,e),Bt.addBitWidth(t,n),Bt.endTime(t)}}class Ot{constructor(){this.bb=null,this.bb_pos=0}__init(t,e){return this.bb_pos=t,this.bb=e,this}static getRootAsTimestamp(t,e){return(e||new Ot).__init(t.readInt32(t.position())+t.position(),t)}static getSizePrefixedRootAsTimestamp(t,e){return t.setPosition(t.position()+j),(e||new Ot).__init(t.readInt32(t.position())+t.position(),t)}unit(){const t=this.bb.__offset(this.bb_pos,4);return t?this.bb.readInt16(this.bb_pos+t):Je.SECOND}timezone(t){const e=this.bb.__offset(this.bb_pos,6);return e?this.bb.__string(this.bb_pos+e,t):null}static startTimestamp(t){t.startObject(2)}static addUnit(t,e){t.addFieldInt16(0,e,Je.SECOND)}static addTimezone(t,e){t.addFieldOffset(1,e,0)}static endTimestamp(t){return t.endObject()}static createTimestamp(t,e,n){return Ot.startTimestamp(t),Ot.addUnit(t,e),Ot.addTimezone(t,n),Ot.endTimestamp(t)}}var rn;(function(i){i[i.Sparse=0]="Sparse",i[i.Dense=1]="Dense"})(rn||(rn={}));class at{constructor(){this.bb=null,this.bb_pos=0}__init(t,e){return this.bb_pos=t,this.bb=e,this}static getRootAsUnion(t,e){return(e||new at).__init(t.readInt32(t.position())+t.position(),t)}static getSizePrefixedRootAsUnion(t,e){return t.setPosition(t.position()+j),(e||new at).__init(t.readInt32(t.position())+t.position(),t)}mode(){const t=this.bb.__offset(this.bb_pos,4);return t?this.bb.readInt16(this.bb_pos+t):rn.Sparse}typeIds(t){const e=this.bb.__offset(this.bb_pos,6);return e?this.bb.readInt32(this.bb.__vector(this.bb_pos+e)+t*4):0}typeIdsLength(){const t=this.bb.__offset(this.bb_pos,6);return t?this.bb.__vector_len(this.bb_pos+t):0}typeIdsArray(){const t=this.bb.__offset(this.bb_pos,6);return t?new Int32Array(this.bb.bytes().buffer,this.bb.bytes().byteOffset+this.bb.__vector(this.bb_pos+t),this.bb.__vector_len(this.bb_pos+t)):null}static startUnion(t){t.startObject(2)}static addMode(t,e){t.addFieldInt16(0,e,rn.Sparse)}static addTypeIds(t,e){t.addFieldOffset(1,e,0)}static createTypeIdsVector(t,e){t.startVector(4,e.length,4);for(let n=e.length-1;n>=0;n--)t.addInt32(e[n]);return t.endVector()}static startTypeIdsVector(t,e){t.startVector(4,e,4)}static endUnion(t){return t.endObject()}static createUnion(t,e,n){return at.startUnion(t),at.addMode(t,e),at.addTypeIds(t,n),at.endUnion(t)}}class De{constructor(){this.bb=null,this.bb_pos=0}__init(t,e){return this.bb_pos=t,this.bb=e,this}static getRootAsUtf8(t,e){return(e||new De).__init(t.readInt32(t.position())+t.position(),t)}static getSizePrefixedRootAsUtf8(t,e){return t.setPosition(t.position()+j),(e||new De).__init(t.readInt32(t.position())+t.position(),t)}static startUtf8(t){t.startObject(0)}static endUtf8(t){return t.endObject()}static createUtf8(t){return De.startUtf8(t),De.endUtf8(t)}}var H;(function(i){i[i.NONE=0]="NONE",i[i.Null=1]="Null",i[i.Int=2]="Int",i[i.FloatingPoint=3]="FloatingPoint",i[i.Binary=4]="Binary",i[i.Utf8=5]="Utf8",i[i.Bool=6]="Bool",i[i.Decimal=7]="Decimal",i[i.Date=8]="Date",i[i.Time=9]="Time",i[i.Timestamp=10]="Timestamp",i[i.Interval=11]="Interval",i[i.List=12]="List",i[i.Struct_=13]="Struct_",i[i.Union=14]="Union",i[i.FixedSizeBinary=15]="FixedSizeBinary",i[i.FixedSizeList=16]="FixedSizeList",i[i.Map=17]="Map",i[i.Duration=18]="Duration",i[i.LargeBinary=19]="LargeBinary",i[i.LargeUtf8=20]="LargeUtf8",i[i.LargeList=21]="LargeList"})(H||(H={}));let St=class Ei{constructor(){this.bb=null,this.bb_pos=0}__init(t,e){return this.bb_pos=t,this.bb=e,this}static getRootAsField(t,e){return(e||new Ei).__init(t.readInt32(t.position())+t.position(),t)}static getSizePrefixedRootAsField(t,e){return t.setPosition(t.position()+j),(e||new Ei).__init(t.readInt32(t.position())+t.position(),t)}name(t){const e=this.bb.__offset(this.bb_pos,4);return e?this.bb.__string(this.bb_pos+e,t):null}nullable(){const t=this.bb.__offset(this.bb_pos,6);return t?!!this.bb.readInt8(this.bb_pos+t):!1}typeType(){const t=this.bb.__offset(this.bb_pos,8);return t?this.bb.readUint8(this.bb_pos+t):H.NONE}type(t){const e=this.bb.__offset(this.bb_pos,10);return e?this.bb.__union(t,this.bb_pos+e):null}dictionary(t){const e=this.bb.__offset(this.bb_pos,12);return e?(t||new te).__init(this.bb.__indirect(this.bb_pos+e),this.bb):null}children(t,e){const n=this.bb.__offset(this.bb_pos,14);return n?(e||new Ei).__init(this.bb.__indirect(this.bb.__vector(this.bb_pos+n)+t*4),this.bb):null}childrenLength(){const t=this.bb.__offset(this.bb_pos,14);return t?this.bb.__vector_len(this.bb_pos+t):0}customMetadata(t,e){const n=this.bb.__offset(this.bb_pos,16);return n?(e||new X).__init(this.bb.__indirect(this.bb.__vector(this.bb_pos+n)+t*4),this.bb):null}customMetadataLength(){const t=this.bb.__offset(this.bb_pos,16);return t?this.bb.__vector_len(this.bb_pos+t):0}static startField(t){t.startObject(7)}static addName(t,e){t.addFieldOffset(0,e,0)}static addNullable(t,e){t.addFieldInt8(1,+e,0)}static addTypeType(t,e){t.addFieldInt8(2,e,H.NONE)}static addType(t,e){t.addFieldOffset(3,e,0)}static addDictionary(t,e){t.addFieldOffset(4,e,0)}static addChildren(t,e){t.addFieldOffset(5,e,0)}static createChildrenVector(t,e){t.startVector(4,e.length,4);for(let n=e.length-1;n>=0;n--)t.addOffset(e[n]);return t.endVector()}static startChildrenVector(t,e){t.startVector(4,e,4)}static addCustomMetadata(t,e){t.addFieldOffset(6,e,0)}static createCustomMetadataVector(t,e){t.startVector(4,e.length,4);for(let n=e.length-1;n>=0;n--)t.addOffset(e[n]);return t.endVector()}static startCustomMetadataVector(t,e){t.startVector(4,e,4)}static endField(t){return t.endObject()}},xt=class qt{constructor(){this.bb=null,this.bb_pos=0}__init(t,e){return this.bb_pos=t,this.bb=e,this}static getRootAsSchema(t,e){return(e||new qt).__init(t.readInt32(t.position())+t.position(),t)}static getSizePrefixedRootAsSchema(t,e){return t.setPosition(t.position()+j),(e||new qt).__init(t.readInt32(t.position())+t.position(),t)}endianness(){const t=this.bb.__offset(this.bb_pos,4);return t?this.bb.readInt16(this.bb_pos+t):He.Little}fields(t,e){const n=this.bb.__offset(this.bb_pos,6);return n?(e||new St).__init(this.bb.__indirect(this.bb.__vector(this.bb_pos+n)+t*4),this.bb):null}fieldsLength(){const t=this.bb.__offset(this.bb_pos,6);return t?this.bb.__vector_len(this.bb_pos+t):0}customMetadata(t,e){const n=this.bb.__offset(this.bb_pos,8);return n?(e||new X).__init(this.bb.__indirect(this.bb.__vector(this.bb_pos+n)+t*4),this.bb):null}customMetadataLength(){const t=this.bb.__offset(this.bb_pos,8);return t?this.bb.__vector_len(this.bb_pos+t):0}features(t){const e=this.bb.__offset(this.bb_pos,10);return e?this.bb.readInt64(this.bb.__vector(this.bb_pos+e)+t*8):this.bb.createLong(0,0)}featuresLength(){const t=this.bb.__offset(this.bb_pos,10);return t?this.bb.__vector_len(this.bb_pos+t):0}static startSchema(t){t.startObject(4)}static addEndianness(t,e){t.addFieldInt16(0,e,He.Little)}static addFields(t,e){t.addFieldOffset(1,e,0)}static createFieldsVector(t,e){t.startVector(4,e.length,4);for(let n=e.length-1;n>=0;n--)t.addOffset(e[n]);return t.endVector()}static startFieldsVector(t,e){t.startVector(4,e,4)}static addCustomMetadata(t,e){t.addFieldOffset(2,e,0)}static createCustomMetadataVector(t,e){t.startVector(4,e.length,4);for(let n=e.length-1;n>=0;n--)t.addOffset(e[n]);return t.endVector()}static startCustomMetadataVector(t,e){t.startVector(4,e,4)}static addFeatures(t,e){t.addFieldOffset(3,e,0)}static createFeaturesVector(t,e){t.startVector(8,e.length,8);for(let n=e.length-1;n>=0;n--)t.addInt64(e[n]);return t.endVector()}static startFeaturesVector(t,e){t.startVector(8,e,8)}static endSchema(t){return t.endObject()}static finishSchemaBuffer(t,e){t.finish(e)}static finishSizePrefixedSchemaBuffer(t,e){t.finish(e,void 0,!0)}static createSchema(t,e,n,r,s){return qt.startSchema(t),qt.addEndianness(t,e),qt.addFields(t,n),qt.addCustomMetadata(t,r),qt.addFeatures(t,s),qt.endSchema(t)}};class pt{constructor(){this.bb=null,this.bb_pos=0}__init(t,e){return this.bb_pos=t,this.bb=e,this}static getRootAsFooter(t,e){return(e||new pt).__init(t.readInt32(t.position())+t.position(),t)}static getSizePrefixedRootAsFooter(t,e){return t.setPosition(t.position()+j),(e||new pt).__init(t.readInt32(t.position())+t.position(),t)}version(){const t=this.bb.__offset(this.bb_pos,4);return t?this.bb.readInt16(this.bb_pos+t):Ye.V1}schema(t){const e=this.bb.__offset(this.bb_pos,6);return e?(t||new xt).__init(this.bb.__indirect(this.bb_pos+e),this.bb):null}dictionaries(t,e){const n=this.bb.__offset(this.bb_pos,8);return n?(e||new Jn).__init(this.bb.__vector(this.bb_pos+n)+t*24,this.bb):null}dictionariesLength(){const t=this.bb.__offset(this.bb_pos,8);return t?this.bb.__vector_len(this.bb_pos+t):0}recordBatches(t,e){const n=this.bb.__offset(this.bb_pos,10);return n?(e||new Jn).__init(this.bb.__vector(this.bb_pos+n)+t*24,this.bb):null}recordBatchesLength(){const t=this.bb.__offset(this.bb_pos,10);return t?this.bb.__vector_len(this.bb_pos+t):0}customMetadata(t,e){const n=this.bb.__offset(this.bb_pos,12);return n?(e||new X).__init(this.bb.__indirect(this.bb.__vector(this.bb_pos+n)+t*4),this.bb):null}customMetadataLength(){const t=this.bb.__offset(this.bb_pos,12);return t?this.bb.__vector_len(this.bb_pos+t):0}static startFooter(t){t.startObject(5)}static addVersion(t,e){t.addFieldInt16(0,e,Ye.V1)}static addSchema(t,e){t.addFieldOffset(1,e,0)}static addDictionaries(t,e){t.addFieldOffset(2,e,0)}static startDictionariesVector(t,e){t.startVector(24,e,8)}static addRecordBatches(t,e){t.addFieldOffset(3,e,0)}static startRecordBatchesVector(t,e){t.startVector(24,e,8)}static addCustomMetadata(t,e){t.addFieldOffset(4,e,0)}static createCustomMetadataVector(t,e){t.startVector(4,e.length,4);for(let n=e.length-1;n>=0;n--)t.addOffset(e[n]);return t.endVector()}static startCustomMetadataVector(t,e){t.startVector(4,e,4)}static endFooter(t){return t.endObject()}static finishFooterBuffer(t,e){t.finish(e)}static finishSizePrefixedFooterBuffer(t,e){t.finish(e,void 0,!0)}}class x{constructor(t=[],e,n){this.fields=t||[],this.metadata=e||new Map,n||(n=Kn(t)),this.dictionaries=n}get[Symbol.toStringTag](){return"Schema"}get names(){return this.fields.map(t=>t.name)}toString(){return`Schema<{ ${this.fields.map((t,e)=>`${e}: ${t}`).join(", ")} }>`}select(t){const e=new Set(t),n=this.fields.filter(r=>e.has(r.name));return new x(n,this.metadata)}selectAt(t){const e=t.map(n=>this.fields[n]).filter(Boolean);return new x(e,this.metadata)}assign(...t){const e=t[0]instanceof x?t[0]:Array.isArray(t[0])?new x(t[0]):new x(t),n=[...this.fields],r=Di(Di(new Map,this.metadata),e.metadata),s=e.fields.filter(a=>{const c=n.findIndex(l=>l.name===a.name);return~c?(n[c]=a.clone({metadata:Di(Di(new Map,n[c].metadata),a.metadata)}))&&!1:!0}),o=Kn(s,new Map);return new x([...n,...s],r,new Map([...this.dictionaries,...o]))}}x.prototype.fields=null;x.prototype.metadata=null;x.prototype.dictionaries=null;class Y{constructor(t,e,n=!1,r){this.name=t,this.type=e,this.nullable=n,this.metadata=r||new Map}static new(...t){let[e,n,r,s]=t;return t[0]&&typeof t[0]=="object"&&({name:e}=t[0],n===void 0&&(n=t[0].type),r===void 0&&(r=t[0].nullable),s===void 0&&(s=t[0].metadata)),new Y(`${e}`,n,r,s)}get typeId(){return this.type.typeId}get[Symbol.toStringTag](){return"Field"}toString(){return`${this.name}: ${this.type}`}clone(...t){let[e,n,r,s]=t;return!t[0]||typeof t[0]!="object"?[e=this.name,n=this.type,r=this.nullable,s=this.metadata]=t:{name:e=this.name,type:n=this.type,nullable:r=this.nullable,metadata:s=this.metadata}=t[0],Y.new(e,n,r,s)}}Y.prototype.type=null;Y.prototype.name=null;Y.prototype.nullable=null;Y.prototype.metadata=null;function Di(i,t){return new Map([...i||new Map,...t||new Map])}function Kn(i,t=new Map){for(let e=-1,n=i.length;++e<n;){const s=i[e].type;if(g.isDictionary(s)){if(!t.has(s.id))t.set(s.id,s.dictionary);else if(t.get(s.id)!==s.dictionary)throw new Error("Cannot create Schema containing two different dictionaries with the same Id")}s.children&&s.children.length>0&&Kn(s.children,t)}return t}var ss=ee,Zl=aa,Ql=We;class fi{constructor(t,e=mt.V4,n,r){this.schema=t,this.version=e,n&&(this._recordBatches=n),r&&(this._dictionaryBatches=r)}static decode(t){t=new Ql(C(t));const e=pt.getRootAsFooter(t),n=x.decode(e.schema());return new tu(n,e)}static encode(t){const e=new Zl,n=x.encode(e,t.schema);pt.startRecordBatchesVector(e,t.numRecordBatches);for(const o of[...t.recordBatches()].slice().reverse())ye.encode(e,o);const r=e.endVector();pt.startDictionariesVector(e,t.numDictionaries);for(const o of[...t.dictionaryBatches()].slice().reverse())ye.encode(e,o);const s=e.endVector();return pt.startFooter(e),pt.addSchema(e,n),pt.addVersion(e,mt.V4),pt.addRecordBatches(e,r),pt.addDictionaries(e,s),pt.finishFooterBuffer(e,pt.endFooter(e)),e.asUint8Array()}get numRecordBatches(){return this._recordBatches.length}get numDictionaries(){return this._dictionaryBatches.length}*recordBatches(){for(let t,e=-1,n=this.numRecordBatches;++e<n;)(t=this.getRecordBatch(e))&&(yield t)}*dictionaryBatches(){for(let t,e=-1,n=this.numDictionaries;++e<n;)(t=this.getDictionaryBatch(e))&&(yield t)}getRecordBatch(t){return t>=0&&t<this.numRecordBatches&&this._recordBatches[t]||null}getDictionaryBatch(t){return t>=0&&t<this.numDictionaries&&this._dictionaryBatches[t]||null}}class tu extends fi{constructor(t,e){super(t,e.version()),this._footer=e}get numRecordBatches(){return this._footer.recordBatchesLength()}get numDictionaries(){return this._footer.dictionariesLength()}getRecordBatch(t){if(t>=0&&t<this.numRecordBatches){const e=this._footer.recordBatches(t);if(e)return ye.decode(e)}return null}getDictionaryBatch(t){if(t>=0&&t<this.numDictionaries){const e=this._footer.dictionaries(t);if(e)return ye.decode(e)}return null}}class ye{constructor(t,e,n){this.metaDataLength=t,this.offset=typeof n=="number"?n:n.low,this.bodyLength=typeof e=="number"?e:e.low}static decode(t){return new ye(t.metaDataLength(),t.bodyLength(),t.offset())}static encode(t,e){const{metaDataLength:n}=e,r=new ss(e.offset,0),s=new ss(e.bodyLength,0);return Jn.createBlock(t,r,n,s)}}const J=Object.freeze({done:!0,value:void 0});class os{constructor(t){this._json=t}get schema(){return this._json.schema}get batches(){return this._json.batches||[]}get dictionaries(){return this._json.dictionaries||[]}}class Dr{tee(){return this._getDOMStream().tee()}pipe(t,e){return this._getNodeStream().pipe(t,e)}pipeTo(t,e){return this._getDOMStream().pipeTo(t,e)}pipeThrough(t,e){return this._getDOMStream().pipeThrough(t,e)}_getDOMStream(){return this._DOMStream||(this._DOMStream=this.toDOMStream())}_getNodeStream(){return this._nodeStream||(this._nodeStream=this.toNodeStream())}}class eu extends Dr{constructor(){super(),this._values=[],this.resolvers=[],this._closedPromise=new Promise(t=>this._closedPromiseResolve=t)}get closed(){return this._closedPromise}cancel(t){return m(this,void 0,void 0,function*(){yield this.return(t)})}write(t){this._ensureOpen()&&(this.resolvers.length<=0?this._values.push(t):this.resolvers.shift().resolve({done:!1,value:t}))}abort(t){this._closedPromiseResolve&&(this.resolvers.length<=0?this._error={error:t}:this.resolvers.shift().reject({done:!0,value:t}))}close(){if(this._closedPromiseResolve){const{resolvers:t}=this;for(;t.length>0;)t.shift().resolve(J);this._closedPromiseResolve(),this._closedPromiseResolve=void 0}}[Symbol.asyncIterator](){return this}toDOMStream(t){return It.toDOMStream(this._closedPromiseResolve||this._error?this:this._values,t)}toNodeStream(t){return It.toNodeStream(this._closedPromiseResolve||this._error?this:this._values,t)}throw(t){return m(this,void 0,void 0,function*(){return yield this.abort(t),J})}return(t){return m(this,void 0,void 0,function*(){return yield this.close(),J})}read(t){return m(this,void 0,void 0,function*(){return(yield this.next(t,"read")).value})}peek(t){return m(this,void 0,void 0,function*(){return(yield this.next(t,"peek")).value})}next(...t){return this._values.length>0?Promise.resolve({done:!1,value:this._values.shift()}):this._error?Promise.reject({done:!0,value:this._error.error}):this._closedPromiseResolve?new Promise((e,n)=>{this.resolvers.push({resolve:e,reject:n})}):Promise.resolve(J)}_ensureOpen(){if(this._closedPromiseResolve)return!0;throw new Error("AsyncQueue is closed")}}class Ni extends eu{write(t){if((t=C(t)).byteLength>0)return super.write(t)}toString(t=!1){return t?jn(this.toUint8Array(!0)):this.toUint8Array(!1).then(jn)}toUint8Array(t=!1){return t?Yt(this._values)[0]:m(this,void 0,void 0,function*(){var e,n;const r=[];let s=0;try{for(var o=Fe(this),a;a=yield o.next(),!a.done;){const c=a.value;r.push(c),s+=c.byteLength}}catch(c){e={error:c}}finally{try{a&&!a.done&&(n=o.return)&&(yield n.call(o))}finally{if(e)throw e.error}}return Yt(r,s)[0]})}}class sn{constructor(t){t&&(this.source=new iu(It.fromIterable(t)))}[Symbol.iterator](){return this}next(t){return this.source.next(t)}throw(t){return this.source.throw(t)}return(t){return this.source.return(t)}peek(t){return this.source.peek(t)}read(t){return this.source.read(t)}}class Ge{constructor(t){t instanceof Ge?this.source=t.source:t instanceof Ni?this.source=new we(It.fromAsyncIterable(t)):Vs(t)?this.source=new we(It.fromNodeStream(t)):fr(t)?this.source=new we(It.fromDOMStream(t)):js(t)?this.source=new we(It.fromDOMStream(t.body)):_i(t)?this.source=new we(It.fromIterable(t)):he(t)?this.source=new we(It.fromAsyncIterable(t)):Ze(t)&&(this.source=new we(It.fromAsyncIterable(t)))}[Symbol.asyncIterator](){return this}next(t){return this.source.next(t)}throw(t){return this.source.throw(t)}return(t){return this.source.return(t)}get closed(){return this.source.closed}cancel(t){return this.source.cancel(t)}peek(t){return this.source.peek(t)}read(t){return this.source.read(t)}}class iu{constructor(t){this.source=t}cancel(t){this.return(t)}peek(t){return this.next(t,"peek").value}read(t){return this.next(t,"read").value}next(t,e="read"){return this.source.next({cmd:e,size:t})}throw(t){return Object.create(this.source.throw&&this.source.throw(t)||J)}return(t){return Object.create(this.source.return&&this.source.return(t)||J)}}class we{constructor(t){this.source=t,this._closedPromise=new Promise(e=>this._closedPromiseResolve=e)}cancel(t){return m(this,void 0,void 0,function*(){yield this.return(t)})}get closed(){return this._closedPromise}read(t){return m(this,void 0,void 0,function*(){return(yield this.next(t,"read")).value})}peek(t){return m(this,void 0,void 0,function*(){return(yield this.next(t,"peek")).value})}next(t,e="read"){return m(this,void 0,void 0,function*(){return yield this.source.next({cmd:e,size:t})})}throw(t){return m(this,void 0,void 0,function*(){const e=this.source.throw&&(yield this.source.throw(t))||J;return this._closedPromiseResolve&&this._closedPromiseResolve(),this._closedPromiseResolve=void 0,Object.create(e)})}return(t){return m(this,void 0,void 0,function*(){const e=this.source.return&&(yield this.source.return(t))||J;return this._closedPromiseResolve&&this._closedPromiseResolve(),this._closedPromiseResolve=void 0,Object.create(e)})}}class as extends sn{constructor(t,e){super(),this.position=0,this.buffer=C(t),this.size=typeof e>"u"?this.buffer.byteLength:e}readInt32(t){const{buffer:e,byteOffset:n}=this.readAt(t,4);return new DataView(e,n).getInt32(0,!0)}seek(t){return this.position=Math.min(t,this.size),t<this.size}read(t){const{buffer:e,size:n,position:r}=this;return e&&r<n?(typeof t!="number"&&(t=Number.POSITIVE_INFINITY),this.position=Math.min(n,r+Math.min(n-r,t)),e.subarray(r,this.position)):null}readAt(t,e){const n=this.buffer,r=Math.min(this.size,t+e);return n?n.subarray(t,r):new Uint8Array(e)}close(){this.buffer&&(this.buffer=null)}throw(t){return this.close(),{done:!0,value:t}}return(t){return this.close(),{done:!0,value:t}}}class on extends Ge{constructor(t,e){super(),this.position=0,this._handle=t,typeof e=="number"?this.size=e:this._pending=m(this,void 0,void 0,function*(){this.size=(yield t.stat()).size,delete this._pending})}readInt32(t){return m(this,void 0,void 0,function*(){const{buffer:e,byteOffset:n}=yield this.readAt(t,4);return new DataView(e,n).getInt32(0,!0)})}seek(t){return m(this,void 0,void 0,function*(){return this._pending&&(yield this._pending),this.position=Math.min(t,this.size),t<this.size})}read(t){return m(this,void 0,void 0,function*(){this._pending&&(yield this._pending);const{_handle:e,size:n,position:r}=this;if(e&&r<n){typeof t!="number"&&(t=Number.POSITIVE_INFINITY);let s=r,o=0,a=0;const c=Math.min(n,s+Math.min(n-s,t)),l=new Uint8Array(Math.max(0,(this.position=c)-s));for(;(s+=a)<c&&(o+=a)<l.byteLength;)({bytesRead:a}=yield e.read(l,o,l.byteLength-o,s));return l}return null})}readAt(t,e){return m(this,void 0,void 0,function*(){this._pending&&(yield this._pending);const{_handle:n,size:r}=this;if(n&&t+e<r){const s=Math.min(r,t+e),o=new Uint8Array(s-t);return(yield n.read(o,0,e,t)).buffer}return new Uint8Array(e)})}close(){return m(this,void 0,void 0,function*(){const t=this._handle;this._handle=null,t&&(yield t.close())})}throw(t){return m(this,void 0,void 0,function*(){return yield this.close(),{done:!0,value:t}})}return(t){return m(this,void 0,void 0,function*(){return yield this.close(),{done:!0,value:t}})}}const nu=65536;function Ue(i){return i<0&&(i=4294967295+i+1),`0x${i.toString(16)}`}const qe=8,Fr=[1,10,100,1e3,1e4,1e5,1e6,1e7,1e8];class la{constructor(t){this.buffer=t}high(){return this.buffer[1]}low(){return this.buffer[0]}_times(t){const e=new Uint32Array([this.buffer[1]>>>16,this.buffer[1]&65535,this.buffer[0]>>>16,this.buffer[0]&65535]),n=new Uint32Array([t.buffer[1]>>>16,t.buffer[1]&65535,t.buffer[0]>>>16,t.buffer[0]&65535]);let r=e[3]*n[3];this.buffer[0]=r&65535;let s=r>>>16;return r=e[2]*n[3],s+=r,r=e[3]*n[2]>>>0,s+=r,this.buffer[0]+=s<<16,this.buffer[1]=s>>>0<r?nu:0,this.buffer[1]+=s>>>16,this.buffer[1]+=e[1]*n[3]+e[2]*n[2]+e[3]*n[1],this.buffer[1]+=e[0]*n[3]+e[1]*n[2]+e[2]*n[1]+e[3]*n[0]<<16,this}_plus(t){const e=this.buffer[0]+t.buffer[0]>>>0;this.buffer[1]+=t.buffer[1],e<this.buffer[0]>>>0&&++this.buffer[1],this.buffer[0]=e}lessThan(t){return this.buffer[1]<t.buffer[1]||this.buffer[1]===t.buffer[1]&&this.buffer[0]<t.buffer[0]}equals(t){return this.buffer[1]===t.buffer[1]&&this.buffer[0]==t.buffer[0]}greaterThan(t){return t.lessThan(this)}hex(){return`${Ue(this.buffer[1])} ${Ue(this.buffer[0])}`}}class U extends la{times(t){return this._times(t),this}plus(t){return this._plus(t),this}static from(t,e=new Uint32Array(2)){return U.fromString(typeof t=="string"?t:t.toString(),e)}static fromNumber(t,e=new Uint32Array(2)){return U.fromString(t.toString(),e)}static fromString(t,e=new Uint32Array(2)){const n=t.length,r=new U(e);for(let s=0;s<n;){const o=qe<n-s?qe:n-s,a=new U(new Uint32Array([Number.parseInt(t.slice(s,s+o),10),0])),c=new U(new Uint32Array([Fr[o],0]));r.times(c),r.plus(a),s+=o}return r}static convertArray(t){const e=new Uint32Array(t.length*2);for(let n=-1,r=t.length;++n<r;)U.from(t[n],new Uint32Array(e.buffer,e.byteOffset+2*n*4,2));return e}static multiply(t,e){return new U(new Uint32Array(t.buffer)).times(e)}static add(t,e){return new U(new Uint32Array(t.buffer)).plus(e)}}class st extends la{negate(){return this.buffer[0]=~this.buffer[0]+1,this.buffer[1]=~this.buffer[1],this.buffer[0]==0&&++this.buffer[1],this}times(t){return this._times(t),this}plus(t){return this._plus(t),this}lessThan(t){const e=this.buffer[1]<<0,n=t.buffer[1]<<0;return e<n||e===n&&this.buffer[0]<t.buffer[0]}static from(t,e=new Uint32Array(2)){return st.fromString(typeof t=="string"?t:t.toString(),e)}static fromNumber(t,e=new Uint32Array(2)){return st.fromString(t.toString(),e)}static fromString(t,e=new Uint32Array(2)){const n=t.startsWith("-"),r=t.length,s=new st(e);for(let o=n?1:0;o<r;){const a=qe<r-o?qe:r-o,c=new st(new Uint32Array([Number.parseInt(t.slice(o,o+a),10),0])),l=new st(new Uint32Array([Fr[a],0]));s.times(l),s.plus(c),o+=a}return n?s.negate():s}static convertArray(t){const e=new Uint32Array(t.length*2);for(let n=-1,r=t.length;++n<r;)st.from(t[n],new Uint32Array(e.buffer,e.byteOffset+2*n*4,2));return e}static multiply(t,e){return new st(new Uint32Array(t.buffer)).times(e)}static add(t,e){return new st(new Uint32Array(t.buffer)).plus(e)}}class Rt{constructor(t){this.buffer=t}high(){return new st(new Uint32Array(this.buffer.buffer,this.buffer.byteOffset+8,2))}low(){return new st(new Uint32Array(this.buffer.buffer,this.buffer.byteOffset,2))}negate(){return this.buffer[0]=~this.buffer[0]+1,this.buffer[1]=~this.buffer[1],this.buffer[2]=~this.buffer[2],this.buffer[3]=~this.buffer[3],this.buffer[0]==0&&++this.buffer[1],this.buffer[1]==0&&++this.buffer[2],this.buffer[2]==0&&++this.buffer[3],this}times(t){const e=new U(new Uint32Array([this.buffer[3],0])),n=new U(new Uint32Array([this.buffer[2],0])),r=new U(new Uint32Array([this.buffer[1],0])),s=new U(new Uint32Array([this.buffer[0],0])),o=new U(new Uint32Array([t.buffer[3],0])),a=new U(new Uint32Array([t.buffer[2],0])),c=new U(new Uint32Array([t.buffer[1],0])),l=new U(new Uint32Array([t.buffer[0],0]));let u=U.multiply(s,l);this.buffer[0]=u.low();const d=new U(new Uint32Array([u.high(),0]));return u=U.multiply(r,l),d.plus(u),u=U.multiply(s,c),d.plus(u),this.buffer[1]=d.low(),this.buffer[3]=d.lessThan(u)?1:0,this.buffer[2]=d.high(),new U(new Uint32Array(this.buffer.buffer,this.buffer.byteOffset+8,2)).plus(U.multiply(n,l)).plus(U.multiply(r,c)).plus(U.multiply(s,a)),this.buffer[3]+=U.multiply(e,l).plus(U.multiply(n,c)).plus(U.multiply(r,a)).plus(U.multiply(s,o)).low(),this}plus(t){const e=new Uint32Array(4);return e[3]=this.buffer[3]+t.buffer[3]>>>0,e[2]=this.buffer[2]+t.buffer[2]>>>0,e[1]=this.buffer[1]+t.buffer[1]>>>0,e[0]=this.buffer[0]+t.buffer[0]>>>0,e[0]<this.buffer[0]>>>0&&++e[1],e[1]<this.buffer[1]>>>0&&++e[2],e[2]<this.buffer[2]>>>0&&++e[3],this.buffer[3]=e[3],this.buffer[2]=e[2],this.buffer[1]=e[1],this.buffer[0]=e[0],this}hex(){return`${Ue(this.buffer[3])} ${Ue(this.buffer[2])} ${Ue(this.buffer[1])} ${Ue(this.buffer[0])}`}static multiply(t,e){return new Rt(new Uint32Array(t.buffer)).times(e)}static add(t,e){return new Rt(new Uint32Array(t.buffer)).plus(e)}static from(t,e=new Uint32Array(4)){return Rt.fromString(typeof t=="string"?t:t.toString(),e)}static fromNumber(t,e=new Uint32Array(4)){return Rt.fromString(t.toString(),e)}static fromString(t,e=new Uint32Array(4)){const n=t.startsWith("-"),r=t.length,s=new Rt(e);for(let o=n?1:0;o<r;){const a=qe<r-o?qe:r-o,c=new Rt(new Uint32Array([Number.parseInt(t.slice(o,o+a),10),0,0,0])),l=new Rt(new Uint32Array([Fr[a],0,0,0]));s.times(l),s.plus(c),o+=a}return n?s.negate():s}static convertArray(t){const e=new Uint32Array(t.length*4);for(let n=-1,r=t.length;++n<r;)Rt.from(t[n],new Uint32Array(e.buffer,e.byteOffset+4*4*n,4));return e}}class ua extends M{constructor(t,e,n,r){super(),this.nodesIndex=-1,this.buffersIndex=-1,this.bytes=t,this.nodes=e,this.buffers=n,this.dictionaries=r}visit(t){return super.visit(t instanceof Y?t.type:t)}visitNull(t,{length:e}=this.nextFieldNode()){return T({type:t,length:e})}visitBool(t,{length:e,nullCount:n}=this.nextFieldNode()){return T({type:t,length:e,nullCount:n,nullBitmap:this.readNullBitmap(t,n),data:this.readData(t)})}visitInt(t,{length:e,nullCount:n}=this.nextFieldNode()){return T({type:t,length:e,nullCount:n,nullBitmap:this.readNullBitmap(t,n),data:this.readData(t)})}visitFloat(t,{length:e,nullCount:n}=this.nextFieldNode()){return T({type:t,length:e,nullCount:n,nullBitmap:this.readNullBitmap(t,n),data:this.readData(t)})}visitUtf8(t,{length:e,nullCount:n}=this.nextFieldNode()){return T({type:t,length:e,nullCount:n,nullBitmap:this.readNullBitmap(t,n),valueOffsets:this.readOffsets(t),data:this.readData(t)})}visitBinary(t,{length:e,nullCount:n}=this.nextFieldNode()){return T({type:t,length:e,nullCount:n,nullBitmap:this.readNullBitmap(t,n),valueOffsets:this.readOffsets(t),data:this.readData(t)})}visitFixedSizeBinary(t,{length:e,nullCount:n}=this.nextFieldNode()){return T({type:t,length:e,nullCount:n,nullBitmap:this.readNullBitmap(t,n),data:this.readData(t)})}visitDate(t,{length:e,nullCount:n}=this.nextFieldNode()){return T({type:t,length:e,nullCount:n,nullBitmap:this.readNullBitmap(t,n),data:this.readData(t)})}visitTimestamp(t,{length:e,nullCount:n}=this.nextFieldNode()){return T({type:t,length:e,nullCount:n,nullBitmap:this.readNullBitmap(t,n),data:this.readData(t)})}visitTime(t,{length:e,nullCount:n}=this.nextFieldNode()){return T({type:t,length:e,nullCount:n,nullBitmap:this.readNullBitmap(t,n),data:this.readData(t)})}visitDecimal(t,{length:e,nullCount:n}=this.nextFieldNode()){return T({type:t,length:e,nullCount:n,nullBitmap:this.readNullBitmap(t,n),data:this.readData(t)})}visitList(t,{length:e,nullCount:n}=this.nextFieldNode()){return T({type:t,length:e,nullCount:n,nullBitmap:this.readNullBitmap(t,n),valueOffsets:this.readOffsets(t),child:this.visit(t.children[0])})}visitStruct(t,{length:e,nullCount:n}=this.nextFieldNode()){return T({type:t,length:e,nullCount:n,nullBitmap:this.readNullBitmap(t,n),children:this.visitMany(t.children)})}visitUnion(t){return t.mode===gt.Sparse?this.visitSparseUnion(t):this.visitDenseUnion(t)}visitDenseUnion(t,{length:e,nullCount:n}=this.nextFieldNode()){return T({type:t,length:e,nullCount:n,nullBitmap:this.readNullBitmap(t,n),typeIds:this.readTypeIds(t),valueOffsets:this.readOffsets(t),children:this.visitMany(t.children)})}visitSparseUnion(t,{length:e,nullCount:n}=this.nextFieldNode()){return T({type:t,length:e,nullCount:n,nullBitmap:this.readNullBitmap(t,n),typeIds:this.readTypeIds(t),children:this.visitMany(t.children)})}visitDictionary(t,{length:e,nullCount:n}=this.nextFieldNode()){return T({type:t,length:e,nullCount:n,nullBitmap:this.readNullBitmap(t,n),data:this.readData(t.indices),dictionary:this.readDictionary(t)})}visitInterval(t,{length:e,nullCount:n}=this.nextFieldNode()){return T({type:t,length:e,nullCount:n,nullBitmap:this.readNullBitmap(t,n),data:this.readData(t)})}visitFixedSizeList(t,{length:e,nullCount:n}=this.nextFieldNode()){return T({type:t,length:e,nullCount:n,nullBitmap:this.readNullBitmap(t,n),child:this.visit(t.children[0])})}visitMap(t,{length:e,nullCount:n}=this.nextFieldNode()){return T({type:t,length:e,nullCount:n,nullBitmap:this.readNullBitmap(t,n),valueOffsets:this.readOffsets(t),child:this.visit(t.children[0])})}nextFieldNode(){return this.nodes[++this.nodesIndex]}nextBufferRange(){return this.buffers[++this.buffersIndex]}readNullBitmap(t,e,n=this.nextBufferRange()){return e>0&&this.readData(t,n)||new Uint8Array(0)}readOffsets(t,e){return this.readData(t,e)}readTypeIds(t,e){return this.readData(t,e)}readData(t,{length:e,offset:n}=this.nextBufferRange()){return this.bytes.subarray(n,n+e)}readDictionary(t){return this.dictionaries.get(t.id)}}class ru extends ua{constructor(t,e,n,r){super(new Uint8Array(0),e,n,r),this.sources=t}readNullBitmap(t,e,{offset:n}=this.nextBufferRange()){return e<=0?new Uint8Array(0):Ki(this.sources[n])}readOffsets(t,{offset:e}=this.nextBufferRange()){return $(Uint8Array,$(Int32Array,this.sources[e]))}readTypeIds(t,{offset:e}=this.nextBufferRange()){return $(Uint8Array,$(t.ArrayType,this.sources[e]))}readData(t,{offset:e}=this.nextBufferRange()){const{sources:n}=this;return g.isTimestamp(t)||(g.isInt(t)||g.isTime(t))&&t.bitWidth===64||g.isDate(t)&&t.unit===ne.MILLISECOND?$(Uint8Array,st.convertArray(n[e])):g.isDecimal(t)?$(Uint8Array,Rt.convertArray(n[e])):g.isBinary(t)||g.isFixedSizeBinary(t)?su(n[e]):g.isBool(t)?Ki(n[e]):g.isUtf8(t)?dr(n[e].join("")):$(Uint8Array,$(t.ArrayType,n[e].map(r=>+r)))}}function su(i){const t=i.join(""),e=new Uint8Array(t.length/2);for(let n=0;n<t.length;n+=2)e[n>>1]=Number.parseInt(t.slice(n,n+2),16);return e}class w extends M{compareSchemas(t,e){return t===e||e instanceof t.constructor&&this.compareManyFields(t.fields,e.fields)}compareManyFields(t,e){return t===e||Array.isArray(t)&&Array.isArray(e)&&t.length===e.length&&t.every((n,r)=>this.compareFields(n,e[r]))}compareFields(t,e){return t===e||e instanceof t.constructor&&t.name===e.name&&t.nullable===e.nullable&&this.visit(t.type,e.type)}}function dt(i,t){return t instanceof i.constructor}function wi(i,t){return i===t||dt(i,t)}function oe(i,t){return i===t||dt(i,t)&&i.bitWidth===t.bitWidth&&i.isSigned===t.isSigned}function An(i,t){return i===t||dt(i,t)&&i.precision===t.precision}function ou(i,t){return i===t||dt(i,t)&&i.byteWidth===t.byteWidth}function Tr(i,t){return i===t||dt(i,t)&&i.unit===t.unit}function Si(i,t){return i===t||dt(i,t)&&i.unit===t.unit&&i.timezone===t.timezone}function Ii(i,t){return i===t||dt(i,t)&&i.unit===t.unit&&i.bitWidth===t.bitWidth}function au(i,t){return i===t||dt(i,t)&&i.children.length===t.children.length&&me.compareManyFields(i.children,t.children)}function cu(i,t){return i===t||dt(i,t)&&i.children.length===t.children.length&&me.compareManyFields(i.children,t.children)}function Mr(i,t){return i===t||dt(i,t)&&i.mode===t.mode&&i.typeIds.every((e,n)=>e===t.typeIds[n])&&me.compareManyFields(i.children,t.children)}function lu(i,t){return i===t||dt(i,t)&&i.id===t.id&&i.isOrdered===t.isOrdered&&me.visit(i.indices,t.indices)&&me.visit(i.dictionary,t.dictionary)}function Cr(i,t){return i===t||dt(i,t)&&i.unit===t.unit}function uu(i,t){return i===t||dt(i,t)&&i.listSize===t.listSize&&i.children.length===t.children.length&&me.compareManyFields(i.children,t.children)}function hu(i,t){return i===t||dt(i,t)&&i.keysSorted===t.keysSorted&&i.children.length===t.children.length&&me.compareManyFields(i.children,t.children)}w.prototype.visitNull=wi;w.prototype.visitBool=wi;w.prototype.visitInt=oe;w.prototype.visitInt8=oe;w.prototype.visitInt16=oe;w.prototype.visitInt32=oe;w.prototype.visitInt64=oe;w.prototype.visitUint8=oe;w.prototype.visitUint16=oe;w.prototype.visitUint32=oe;w.prototype.visitUint64=oe;w.prototype.visitFloat=An;w.prototype.visitFloat16=An;w.prototype.visitFloat32=An;w.prototype.visitFloat64=An;w.prototype.visitUtf8=wi;w.prototype.visitBinary=wi;w.prototype.visitFixedSizeBinary=ou;w.prototype.visitDate=Tr;w.prototype.visitDateDay=Tr;w.prototype.visitDateMillisecond=Tr;w.prototype.visitTimestamp=Si;w.prototype.visitTimestampSecond=Si;w.prototype.visitTimestampMillisecond=Si;w.prototype.visitTimestampMicrosecond=Si;w.prototype.visitTimestampNanosecond=Si;w.prototype.visitTime=Ii;w.prototype.visitTimeSecond=Ii;w.prototype.visitTimeMillisecond=Ii;w.prototype.visitTimeMicrosecond=Ii;w.prototype.visitTimeNanosecond=Ii;w.prototype.visitDecimal=wi;w.prototype.visitList=au;w.prototype.visitStruct=cu;w.prototype.visitUnion=Mr;w.prototype.visitDenseUnion=Mr;w.prototype.visitSparseUnion=Mr;w.prototype.visitDictionary=lu;w.prototype.visitInterval=Cr;w.prototype.visitIntervalDayTime=Cr;w.prototype.visitIntervalYearMonth=Cr;w.prototype.visitFixedSizeList=uu;w.prototype.visitMap=hu;const me=new w;function Xn(i,t){return me.compareSchemas(i,t)}function En(i,t){return du(i,t.map(e=>e.data.concat()))}function du(i,t){const e=[...i.fields],n=[],r={numBatches:t.reduce((d,p)=>Math.max(d,p.length),0)};let s=0,o=0,a=-1;const c=t.length;let l,u=[];for(;r.numBatches-- >0;){for(o=Number.POSITIVE_INFINITY,a=-1;++a<c;)u[a]=l=t[a].shift(),o=Math.min(o,l?l.length:o);Number.isFinite(o)&&(u=fu(e,o,u,t,r),o>0&&(n[s++]=T({type:new nt(e),length:o,nullCount:0,children:u.slice()})))}return[i=i.assign(e),n.map(d=>new ct(i,d))]}function fu(i,t,e,n,r){var s;const o=(t+63&-64)>>3;for(let a=-1,c=n.length;++a<c;){const l=e[a],u=l==null?void 0:l.length;if(u>=t)u===t?e[a]=l:(e[a]=l.slice(0,t),r.numBatches=Math.max(r.numBatches,n[a].unshift(l.slice(t,u-t))));else{const d=i[a];i[a]=d.clone({nullable:!0}),e[a]=(s=l==null?void 0:l._changeLengthAndBackfillNullBitmap(t))!==null&&s!==void 0?s:T({type:d.type,length:t,nullCount:t,nullBitmap:new Uint8Array(o)})}}return e}var ha;class it{constructor(...t){var e,n;if(t.length===0)return this.batches=[],this.schema=new x([]),this._offsets=[0],this;let r,s;t[0]instanceof x&&(r=t.shift()),t[t.length-1]instanceof Uint32Array&&(s=t.pop());const o=c=>{if(c){if(c instanceof ct)return[c];if(c instanceof it)return c.batches;if(c instanceof W){if(c.type instanceof nt)return[new ct(new x(c.type.children),c)]}else{if(Array.isArray(c))return c.flatMap(l=>o(l));if(typeof c[Symbol.iterator]=="function")return[...c].flatMap(l=>o(l));if(typeof c=="object"){const l=Object.keys(c),u=l.map(f=>new N([c[f]])),d=new x(l.map((f,y)=>new Y(String(f),u[y].type))),[,p]=En(d,u);return p.length===0?[new ct(c)]:p}}}return[]},a=t.flatMap(c=>o(c));if(r=(n=r??((e=a[0])===null||e===void 0?void 0:e.schema))!==null&&n!==void 0?n:new x([]),!(r instanceof x))throw new TypeError("Table constructor expects a [Schema, RecordBatch[]] pair.");for(const c of a){if(!(c instanceof ct))throw new TypeError("Table constructor expects a [Schema, RecordBatch[]] pair.");if(!Xn(r,c.schema))throw new TypeError("Table and inner RecordBatch schemas must be equivalent.")}this.schema=r,this.batches=a,this._offsets=s??Ko(this.data)}get data(){return this.batches.map(({data:t})=>t)}get numCols(){return this.schema.fields.length}get numRows(){return this.data.reduce((t,e)=>t+e.length,0)}get nullCount(){return this._nullCount===-1&&(this._nullCount=qo(this.data)),this._nullCount}isValid(t){return!1}get(t){return null}set(t,e){}indexOf(t,e){return-1}getByteLength(t){return 0}[Symbol.iterator](){return this.batches.length>0?Ar.visit(new N(this.data)):new Array(0)[Symbol.iterator]()}toArray(){return[...this]}toString(){return`[
  ${this.toArray().join(`,
  `)}
]`}concat(...t){const e=this.schema,n=this.data.concat(t.flatMap(({data:r})=>r));return new it(e,n.map(r=>new ct(e,r)))}slice(t,e){const n=this.schema;[t,e]=Jo({length:this.numRows},t,e);const r=Xo(this.data,this._offsets,t,e);return new it(n,r.map(s=>new ct(n,s)))}getChild(t){return this.getChildAt(this.schema.fields.findIndex(e=>e.name===t))}getChildAt(t){if(t>-1&&t<this.schema.fields.length){const e=this.data.map(n=>n.children[t]);if(e.length===0){const{type:n}=this.schema.fields[t],r=T({type:n,length:0,nullCount:0});e.push(r._changeLengthAndBackfillNullBitmap(this.numRows))}return new N(e)}return null}setChild(t,e){var n;return this.setChildAt((n=this.schema.fields)===null||n===void 0?void 0:n.findIndex(r=>r.name===t),e)}setChildAt(t,e){let n=this.schema,r=[...this.batches];if(t>-1&&t<this.numCols){e||(e=new N([T({type:new fe,length:this.numRows})]));const s=n.fields.slice(),o=s[t].clone({type:e.type}),a=this.schema.fields.map((c,l)=>this.getChildAt(l));[s[t],a[t]]=[o,e],[n,r]=En(n,a)}return new it(n,r)}select(t){const e=this.schema.fields.reduce((n,r,s)=>n.set(r.name,s),new Map);return this.selectAt(t.map(n=>e.get(n)).filter(n=>n>-1))}selectAt(t){const e=this.schema.selectAt(t),n=this.batches.map(r=>r.selectAt(t));return new it(e,n)}assign(t){const e=this.schema.fields,[n,r]=t.schema.fields.reduce((a,c,l)=>{const[u,d]=a,p=e.findIndex(f=>f.name===c.name);return~p?d[p]=l:u.push(l),a},[[],[]]),s=this.schema.assign(t.schema),o=[...e.map((a,c)=>[c,r[c]]).map(([a,c])=>c===void 0?this.getChildAt(a):t.getChildAt(c)),...n.map(a=>t.getChildAt(a))].filter(Boolean);return new it(...En(s,o))}}ha=Symbol.toStringTag;it[ha]=(i=>(i.schema=null,i.batches=[],i._offsets=new Uint32Array([0]),i._nullCount=-1,i[Symbol.isConcatSpreadable]=!0,i.isValid=je(Or),i.get=je(ht.getVisitFn(h.Struct)),i.set=Zo(At.getVisitFn(h.Struct)),i.indexOf=Qo(Xi.getVisitFn(h.Struct)),i.getByteLength=je(Ht.getVisitFn(h.Struct)),"Table"))(it.prototype);var da;let ct=class ni{constructor(...t){switch(t.length){case 2:{if([this.schema]=t,!(this.schema instanceof x))throw new TypeError("RecordBatch constructor expects a [Schema, Data] pair.");if([,this.data=T({nullCount:0,type:new nt(this.schema.fields),children:this.schema.fields.map(e=>T({type:e.type,nullCount:0}))})]=t,!(this.data instanceof W))throw new TypeError("RecordBatch constructor expects a [Schema, Data] pair.");[this.schema,this.data]=cs(this.schema,this.data.children);break}case 1:{const[e]=t,{fields:n,children:r,length:s}=Object.keys(e).reduce((c,l,u)=>(c.children[u]=e[l],c.length=Math.max(c.length,e[l].length),c.fields[u]=Y.new({name:l,type:e[l].type,nullable:!0}),c),{length:0,fields:new Array,children:new Array}),o=new x(n),a=T({type:new nt(n),length:s,children:r,nullCount:0});[this.schema,this.data]=cs(o,a.children,s);break}default:throw new TypeError("RecordBatch constructor expects an Object mapping names to child Data, or a [Schema, Data] pair.")}}get dictionaries(){return this._dictionaries||(this._dictionaries=fa(this.schema.fields,this.data.children))}get numCols(){return this.schema.fields.length}get numRows(){return this.data.length}get nullCount(){return this.data.nullCount}isValid(t){return this.data.getValid(t)}get(t){return ht.visit(this.data,t)}set(t,e){return At.visit(this.data,t,e)}indexOf(t,e){return Xi.visit(this.data,t,e)}getByteLength(t){return Ht.visit(this.data,t)}[Symbol.iterator](){return Ar.visit(new N([this.data]))}toArray(){return[...this]}concat(...t){return new it(this.schema,[this,...t])}slice(t,e){const[n]=new N([this.data]).slice(t,e).data;return new ni(this.schema,n)}getChild(t){var e;return this.getChildAt((e=this.schema.fields)===null||e===void 0?void 0:e.findIndex(n=>n.name===t))}getChildAt(t){return t>-1&&t<this.schema.fields.length?new N([this.data.children[t]]):null}setChild(t,e){var n;return this.setChildAt((n=this.schema.fields)===null||n===void 0?void 0:n.findIndex(r=>r.name===t),e)}setChildAt(t,e){let n=this.schema,r=this.data;if(t>-1&&t<this.numCols){e||(e=new N([T({type:new fe,length:this.numRows})]));const s=n.fields.slice(),o=r.children.slice(),a=s[t].clone({type:e.type});[s[t],o[t]]=[a,e.data[0]],n=new x(s,new Map(this.schema.metadata)),r=T({type:new nt(s),children:o})}return new ni(n,r)}select(t){const e=this.schema.select(t),n=new nt(e.fields),r=[];for(const s of t){const o=this.schema.fields.findIndex(a=>a.name===s);~o&&(r[o]=this.data.children[o])}return new ni(e,T({type:n,length:this.numRows,children:r}))}selectAt(t){const e=this.schema.selectAt(t),n=t.map(s=>this.data.children[s]).filter(Boolean),r=T({type:new nt(e.fields),length:this.numRows,children:n});return new ni(e,r)}};da=Symbol.toStringTag;ct[da]=(i=>(i._nullCount=-1,i[Symbol.isConcatSpreadable]=!0,"RecordBatch"))(ct.prototype);function cs(i,t,e=t.reduce((n,r)=>Math.max(n,r.length),0)){var n;const r=[...i.fields],s=[...t],o=(e+63&-64)>>3;for(const[a,c]of i.fields.entries()){const l=t[a];(!l||l.length!==e)&&(r[a]=c.clone({nullable:!0}),s[a]=(n=l==null?void 0:l._changeLengthAndBackfillNullBitmap(e))!==null&&n!==void 0?n:T({type:c.type,length:e,nullCount:e,nullBitmap:new Uint8Array(o)}))}return[i.assign(r),T({type:new nt(r),length:e,children:s})]}function fa(i,t,e=new Map){for(let n=-1,r=i.length;++n<r;){const o=i[n].type,a=t[n];if(g.isDictionary(o)){if(!e.has(o.id))a.dictionary&&e.set(o.id,a.dictionary);else if(e.get(o.id)!==a.dictionary)throw new Error("Cannot create Schema containing two different dictionaries with the same Id")}o.children&&o.children.length>0&&fa(o.children,a.children,e)}return e}class Lr extends ct{constructor(t){const e=t.fields.map(r=>T({type:r.type})),n=T({type:new nt(t.fields),nullCount:0,children:e});super(t,n)}}var an;(function(i){i[i.BUFFER=0]="BUFFER"})(an||(an={}));var cn;(function(i){i[i.LZ4_FRAME=0]="LZ4_FRAME",i[i.ZSTD=1]="ZSTD"})(cn||(cn={}));class le{constructor(){this.bb=null,this.bb_pos=0}__init(t,e){return this.bb_pos=t,this.bb=e,this}static getRootAsBodyCompression(t,e){return(e||new le).__init(t.readInt32(t.position())+t.position(),t)}static getSizePrefixedRootAsBodyCompression(t,e){return t.setPosition(t.position()+j),(e||new le).__init(t.readInt32(t.position())+t.position(),t)}codec(){const t=this.bb.__offset(this.bb_pos,4);return t?this.bb.readInt8(this.bb_pos+t):cn.LZ4_FRAME}method(){const t=this.bb.__offset(this.bb_pos,6);return t?this.bb.readInt8(this.bb_pos+t):an.BUFFER}static startBodyCompression(t){t.startObject(2)}static addCodec(t,e){t.addFieldInt8(0,e,cn.LZ4_FRAME)}static addMethod(t,e){t.addFieldInt8(1,e,an.BUFFER)}static endBodyCompression(t){return t.endObject()}static createBodyCompression(t,e,n){return le.startBodyCompression(t),le.addCodec(t,e),le.addMethod(t,n),le.endBodyCompression(t)}}class pa{constructor(){this.bb=null,this.bb_pos=0}__init(t,e){return this.bb_pos=t,this.bb=e,this}offset(){return this.bb.readInt64(this.bb_pos)}length(){return this.bb.readInt64(this.bb_pos+8)}static sizeOf(){return 16}static createBuffer(t,e,n){return t.prep(8,16),t.writeInt64(n),t.writeInt64(e),t.offset()}}let ya=class{constructor(){this.bb=null,this.bb_pos=0}__init(t,e){return this.bb_pos=t,this.bb=e,this}length(){return this.bb.readInt64(this.bb_pos)}nullCount(){return this.bb.readInt64(this.bb_pos+8)}static sizeOf(){return 16}static createFieldNode(t,e,n){return t.prep(8,16),t.writeInt64(n),t.writeInt64(e),t.offset()}},Zt=class Zn{constructor(){this.bb=null,this.bb_pos=0}__init(t,e){return this.bb_pos=t,this.bb=e,this}static getRootAsRecordBatch(t,e){return(e||new Zn).__init(t.readInt32(t.position())+t.position(),t)}static getSizePrefixedRootAsRecordBatch(t,e){return t.setPosition(t.position()+j),(e||new Zn).__init(t.readInt32(t.position())+t.position(),t)}length(){const t=this.bb.__offset(this.bb_pos,4);return t?this.bb.readInt64(this.bb_pos+t):this.bb.createLong(0,0)}nodes(t,e){const n=this.bb.__offset(this.bb_pos,6);return n?(e||new ya).__init(this.bb.__vector(this.bb_pos+n)+t*16,this.bb):null}nodesLength(){const t=this.bb.__offset(this.bb_pos,6);return t?this.bb.__vector_len(this.bb_pos+t):0}buffers(t,e){const n=this.bb.__offset(this.bb_pos,8);return n?(e||new pa).__init(this.bb.__vector(this.bb_pos+n)+t*16,this.bb):null}buffersLength(){const t=this.bb.__offset(this.bb_pos,8);return t?this.bb.__vector_len(this.bb_pos+t):0}compression(t){const e=this.bb.__offset(this.bb_pos,10);return e?(t||new le).__init(this.bb.__indirect(this.bb_pos+e),this.bb):null}static startRecordBatch(t){t.startObject(4)}static addLength(t,e){t.addFieldInt64(0,e,t.createLong(0,0))}static addNodes(t,e){t.addFieldOffset(1,e,0)}static startNodesVector(t,e){t.startVector(16,e,8)}static addBuffers(t,e){t.addFieldOffset(2,e,0)}static startBuffersVector(t,e){t.startVector(16,e,8)}static addCompression(t,e){t.addFieldOffset(3,e,0)}static endRecordBatch(t){return t.endObject()}},Re=class Qn{constructor(){this.bb=null,this.bb_pos=0}__init(t,e){return this.bb_pos=t,this.bb=e,this}static getRootAsDictionaryBatch(t,e){return(e||new Qn).__init(t.readInt32(t.position())+t.position(),t)}static getSizePrefixedRootAsDictionaryBatch(t,e){return t.setPosition(t.position()+j),(e||new Qn).__init(t.readInt32(t.position())+t.position(),t)}id(){const t=this.bb.__offset(this.bb_pos,4);return t?this.bb.readInt64(this.bb_pos+t):this.bb.createLong(0,0)}data(t){const e=this.bb.__offset(this.bb_pos,6);return e?(t||new Zt).__init(this.bb.__indirect(this.bb_pos+e),this.bb):null}isDelta(){const t=this.bb.__offset(this.bb_pos,8);return t?!!this.bb.readInt8(this.bb_pos+t):!1}static startDictionaryBatch(t){t.startObject(3)}static addId(t,e){t.addFieldInt64(0,e,t.createLong(0,0))}static addData(t,e){t.addFieldOffset(1,e,0)}static addIsDelta(t,e){t.addFieldInt8(2,+e,0)}static endDictionaryBatch(t){return t.endObject()}};var ln;(function(i){i[i.NONE=0]="NONE",i[i.Schema=1]="Schema",i[i.DictionaryBatch=2]="DictionaryBatch",i[i.RecordBatch=3]="RecordBatch",i[i.Tensor=4]="Tensor",i[i.SparseTensor=5]="SparseTensor"})(ln||(ln={}));let ae=class Nt{constructor(){this.bb=null,this.bb_pos=0}__init(t,e){return this.bb_pos=t,this.bb=e,this}static getRootAsMessage(t,e){return(e||new Nt).__init(t.readInt32(t.position())+t.position(),t)}static getSizePrefixedRootAsMessage(t,e){return t.setPosition(t.position()+j),(e||new Nt).__init(t.readInt32(t.position())+t.position(),t)}version(){const t=this.bb.__offset(this.bb_pos,4);return t?this.bb.readInt16(this.bb_pos+t):Ye.V1}headerType(){const t=this.bb.__offset(this.bb_pos,6);return t?this.bb.readUint8(this.bb_pos+t):ln.NONE}header(t){const e=this.bb.__offset(this.bb_pos,8);return e?this.bb.__union(t,this.bb_pos+e):null}bodyLength(){const t=this.bb.__offset(this.bb_pos,10);return t?this.bb.readInt64(this.bb_pos+t):this.bb.createLong(0,0)}customMetadata(t,e){const n=this.bb.__offset(this.bb_pos,12);return n?(e||new X).__init(this.bb.__indirect(this.bb.__vector(this.bb_pos+n)+t*4),this.bb):null}customMetadataLength(){const t=this.bb.__offset(this.bb_pos,12);return t?this.bb.__vector_len(this.bb_pos+t):0}static startMessage(t){t.startObject(5)}static addVersion(t,e){t.addFieldInt16(0,e,Ye.V1)}static addHeaderType(t,e){t.addFieldInt8(1,e,ln.NONE)}static addHeader(t,e){t.addFieldOffset(2,e,0)}static addBodyLength(t,e){t.addFieldInt64(3,e,t.createLong(0,0))}static addCustomMetadata(t,e){t.addFieldOffset(4,e,0)}static createCustomMetadataVector(t,e){t.startVector(4,e.length,4);for(let n=e.length-1;n>=0;n--)t.addOffset(e[n]);return t.endVector()}static startCustomMetadataVector(t,e){t.startVector(4,e,4)}static endMessage(t){return t.endObject()}static finishMessageBuffer(t,e){t.finish(e)}static finishSizePrefixedMessageBuffer(t,e){t.finish(e,void 0,!0)}static createMessage(t,e,n,r,s,o){return Nt.startMessage(t),Nt.addVersion(t,e),Nt.addHeaderType(t,n),Nt.addHeader(t,r),Nt.addBodyLength(t,s),Nt.addCustomMetadata(t,o),Nt.endMessage(t)}};var pu=ee;class yu extends M{visit(t,e){return t==null||e==null?void 0:super.visit(t,e)}visitNull(t,e){return Oe.startNull(e),Oe.endNull(e)}visitInt(t,e){return yt.startInt(e),yt.addBitWidth(e,t.bitWidth),yt.addIsSigned(e,t.isSigned),yt.endInt(e)}visitFloat(t,e){return $t.startFloatingPoint(e),$t.addPrecision(e,t.precision),$t.endFloatingPoint(e)}visitBinary(t,e){return Se.startBinary(e),Se.endBinary(e)}visitBool(t,e){return Ie.startBool(e),Ie.endBool(e)}visitUtf8(t,e){return De.startUtf8(e),De.endUtf8(e)}visitDecimal(t,e){return ot.startDecimal(e),ot.addScale(e,t.scale),ot.addPrecision(e,t.precision),ot.addBitWidth(e,t.bitWidth),ot.endDecimal(e)}visitDate(t,e){return Ci.startDate(e),Ci.addUnit(e,t.unit),Ci.endDate(e)}visitTime(t,e){return Bt.startTime(e),Bt.addUnit(e,t.unit),Bt.addBitWidth(e,t.bitWidth),Bt.endTime(e)}visitTimestamp(t,e){const n=t.timezone&&e.createString(t.timezone)||void 0;return Ot.startTimestamp(e),Ot.addUnit(e,t.unit),n!==void 0&&Ot.addTimezone(e,n),Ot.endTimestamp(e)}visitInterval(t,e){return jt.startInterval(e),jt.addUnit(e,t.unit),jt.endInterval(e)}visitList(t,e){return Be.startList(e),Be.endList(e)}visitStruct(t,e){return Ae.startStruct_(e),Ae.endStruct_(e)}visitUnion(t,e){at.startTypeIdsVector(e,t.typeIds.length);const n=at.createTypeIdsVector(e,t.typeIds);return at.startUnion(e),at.addMode(e,t.mode),at.addTypeIds(e,n),at.endUnion(e)}visitDictionary(t,e){const n=this.visit(t.indices,e);return te.startDictionaryEncoding(e),te.addId(e,new pu(t.id,0)),te.addIsOrdered(e,t.isOrdered),n!==void 0&&te.addIndexType(e,n),te.endDictionaryEncoding(e)}visitFixedSizeBinary(t,e){return Pt.startFixedSizeBinary(e),Pt.addByteWidth(e,t.byteWidth),Pt.endFixedSizeBinary(e)}visitFixedSizeList(t,e){return zt.startFixedSizeList(e),zt.addListSize(e,t.listSize),zt.endFixedSizeList(e)}visitMap(t,e){return Li.startMap(e),Li.addKeysSorted(e,t.keysSorted),Li.endMap(e)}}const Nn=new yu;function mu(i,t=new Map){return new x(bu(i,t),xi(i.customMetadata),t)}function ma(i){return new bt(i.count,ga(i.columns),ba(i.columns))}function gu(i){return new Jt(ma(i.data),i.id,i.isDelta)}function bu(i,t){return(i.fields||[]).filter(Boolean).map(e=>Y.fromJSON(e,t))}function ls(i,t){return(i.children||[]).filter(Boolean).map(e=>Y.fromJSON(e,t))}function ga(i){return(i||[]).reduce((t,e)=>[...t,new Ce(e.count,vu(e.VALIDITY)),...ga(e.children)],[])}function ba(i,t=[]){for(let e=-1,n=(i||[]).length;++e<n;){const r=i[e];r.VALIDITY&&t.push(new Wt(t.length,r.VALIDITY.length)),r.TYPE&&t.push(new Wt(t.length,r.TYPE.length)),r.OFFSET&&t.push(new Wt(t.length,r.OFFSET.length)),r.DATA&&t.push(new Wt(t.length,r.DATA.length)),t=ba(r.children,t)}return t}function vu(i){return(i||[]).reduce((t,e)=>t+ +(e===0),0)}function _u(i,t){let e,n,r,s,o,a;return!t||!(s=i.dictionary)?(o=hs(i,ls(i,t)),r=new Y(i.name,o,i.nullable,xi(i.customMetadata))):t.has(e=s.id)?(n=(n=s.indexType)?us(n):new ui,a=new Ve(t.get(e),n,e,s.isOrdered),r=new Y(i.name,a,i.nullable,xi(i.customMetadata))):(n=(n=s.indexType)?us(n):new ui,t.set(e,o=hs(i,ls(i,t))),a=new Ve(o,n,e,s.isOrdered),r=new Y(i.name,a,i.nullable,xi(i.customMetadata))),r||null}function xi(i){return new Map(Object.entries(i||{}))}function us(i){return new pe(i.isSigned,i.bitWidth)}function hs(i,t){const e=i.type.name;switch(e){case"NONE":return new fe;case"null":return new fe;case"binary":return new ki;case"utf8":return new Pi;case"bool":return new zi;case"list":return new Yi((t||[])[0]);case"struct":return new nt(t||[]);case"struct_":return new nt(t||[])}switch(e){case"int":{const n=i.type;return new pe(n.isSigned,n.bitWidth)}case"floatingpoint":{const n=i.type;return new hi(lt[n.precision])}case"decimal":{const n=i.type;return new $i(n.scale,n.precision,n.bitWidth)}case"date":{const n=i.type;return new ji(ne[n.unit])}case"time":{const n=i.type;return new di(L[n.unit],n.bitWidth)}case"timestamp":{const n=i.type;return new Vi(L[n.unit],n.timezone)}case"interval":{const n=i.type;return new Wi(de[n.unit])}case"union":{const n=i.type;return new Hi(gt[n.mode],n.typeIds||[],t||[])}case"fixedsizebinary":{const n=i.type;return new Ji(n.byteWidth)}case"fixedsizelist":{const n=i.type;return new Gi(n.listSize,(t||[])[0])}case"map":{const n=i.type;return new qi((t||[])[0],n.keysSorted)}}throw new Error(`Unrecognized type: "${e}"`)}var Me=ee,wu=aa,Su=We;class rt{constructor(t,e,n,r){this._version=e,this._headerType=n,this.body=new Uint8Array(0),r&&(this._createHeader=()=>r),this._bodyLength=typeof t=="number"?t:t.low}static fromJSON(t,e){const n=new rt(0,mt.V4,e);return n._createHeader=Iu(t,e),n}static decode(t){t=new Su(C(t));const e=ae.getRootAsMessage(t),n=e.bodyLength(),r=e.version(),s=e.headerType(),o=new rt(n,r,s);return o._createHeader=Bu(e,s),o}static encode(t){const e=new wu;let n=-1;return t.isSchema()?n=x.encode(e,t.header()):t.isRecordBatch()?n=bt.encode(e,t.header()):t.isDictionaryBatch()&&(n=Jt.encode(e,t.header())),ae.startMessage(e),ae.addVersion(e,mt.V4),ae.addHeader(e,n),ae.addHeaderType(e,t.headerType),ae.addBodyLength(e,new Me(t.bodyLength,0)),ae.finishMessageBuffer(e,ae.endMessage(e)),e.asUint8Array()}static from(t,e=0){if(t instanceof x)return new rt(0,mt.V4,E.Schema,t);if(t instanceof bt)return new rt(e,mt.V4,E.RecordBatch,t);if(t instanceof Jt)return new rt(e,mt.V4,E.DictionaryBatch,t);throw new Error(`Unrecognized Message header: ${t}`)}get type(){return this.headerType}get version(){return this._version}get headerType(){return this._headerType}get bodyLength(){return this._bodyLength}header(){return this._createHeader()}isSchema(){return this.headerType===E.Schema}isRecordBatch(){return this.headerType===E.RecordBatch}isDictionaryBatch(){return this.headerType===E.DictionaryBatch}}class bt{constructor(t,e,n){this._nodes=e,this._buffers=n,this._length=typeof t=="number"?t:t.low}get nodes(){return this._nodes}get length(){return this._length}get buffers(){return this._buffers}}class Jt{constructor(t,e,n=!1){this._data=t,this._isDelta=n,this._id=typeof e=="number"?e:e.low}get id(){return this._id}get data(){return this._data}get isDelta(){return this._isDelta}get length(){return this.data.length}get nodes(){return this.data.nodes}get buffers(){return this.data.buffers}}class Wt{constructor(t,e){this.offset=typeof t=="number"?t:t.low,this.length=typeof e=="number"?e:e.low}}class Ce{constructor(t,e){this.length=typeof t=="number"?t:t.low,this.nullCount=typeof e=="number"?e:e.low}}function Iu(i,t){return()=>{switch(t){case E.Schema:return x.fromJSON(i);case E.RecordBatch:return bt.fromJSON(i);case E.DictionaryBatch:return Jt.fromJSON(i)}throw new Error(`Unrecognized Message type: { name: ${E[t]}, type: ${t} }`)}}function Bu(i,t){return()=>{switch(t){case E.Schema:return x.decode(i.header(new xt));case E.RecordBatch:return bt.decode(i.header(new Zt),i.version());case E.DictionaryBatch:return Jt.decode(i.header(new Re),i.version())}throw new Error(`Unrecognized Message type: { name: ${E[t]}, type: ${t} }`)}}Y.encode=xu;Y.decode=Eu;Y.fromJSON=_u;x.encode=Nu;x.decode=Ou;x.fromJSON=mu;bt.encode=Ru;bt.decode=Au;bt.fromJSON=ma;Jt.encode=Uu;Jt.decode=Du;Jt.fromJSON=gu;Ce.encode=ku;Ce.decode=Tu;Wt.encode=Pu;Wt.decode=Fu;function Ou(i,t=new Map){const e=Lu(i,t);return new x(e,Ri(i),t)}function Au(i,t=mt.V4){if(i.compression()!==null)throw new Error("Record batch compression not implemented");return new bt(i.length(),Mu(i),Cu(i,t))}function Du(i,t=mt.V4){return new Jt(bt.decode(i.data(),t),i.id(),i.isDelta())}function Fu(i){return new Wt(i.offset(),i.length())}function Tu(i){return new Ce(i.length(),i.nullCount())}function Mu(i){const t=[];for(let e,n=-1,r=-1,s=i.nodesLength();++n<s;)(e=i.nodes(n))&&(t[++r]=Ce.decode(e));return t}function Cu(i,t){const e=[];for(let n,r=-1,s=-1,o=i.buffersLength();++r<o;)(n=i.buffers(r))&&(t<mt.V4&&(n.bb_pos+=8*(r+1)),e[++s]=Wt.decode(n));return e}function Lu(i,t){const e=[];for(let n,r=-1,s=-1,o=i.fieldsLength();++r<o;)(n=i.fields(r))&&(e[++s]=Y.decode(n,t));return e}function ds(i,t){const e=[];for(let n,r=-1,s=-1,o=i.childrenLength();++r<o;)(n=i.children(r))&&(e[++s]=Y.decode(n,t));return e}function Eu(i,t){let e,n,r,s,o,a;return!t||!(a=i.dictionary())?(r=ps(i,ds(i,t)),n=new Y(i.name(),r,i.nullable(),Ri(i))):t.has(e=a.id().low)?(s=(s=a.indexType())?fs(s):new ui,o=new Ve(t.get(e),s,e,a.isOrdered()),n=new Y(i.name(),o,i.nullable(),Ri(i))):(s=(s=a.indexType())?fs(s):new ui,t.set(e,r=ps(i,ds(i,t))),o=new Ve(r,s,e,a.isOrdered()),n=new Y(i.name(),o,i.nullable(),Ri(i))),n||null}function Ri(i){const t=new Map;if(i)for(let e,n,r=-1,s=Math.trunc(i.customMetadataLength());++r<s;)(e=i.customMetadata(r))&&(n=e.key())!=null&&t.set(n,e.value());return t}function fs(i){return new pe(i.isSigned(),i.bitWidth())}function ps(i,t){const e=i.typeType();switch(e){case H.NONE:return new fe;case H.Null:return new fe;case H.Binary:return new ki;case H.Utf8:return new Pi;case H.Bool:return new zi;case H.List:return new Yi((t||[])[0]);case H.Struct_:return new nt(t||[])}switch(e){case H.Int:{const n=i.type(new yt);return new pe(n.isSigned(),n.bitWidth())}case H.FloatingPoint:{const n=i.type(new $t);return new hi(n.precision())}case H.Decimal:{const n=i.type(new ot);return new $i(n.scale(),n.precision(),n.bitWidth())}case H.Date:{const n=i.type(new Ci);return new ji(n.unit())}case H.Time:{const n=i.type(new Bt);return new di(n.unit(),n.bitWidth())}case H.Timestamp:{const n=i.type(new Ot);return new Vi(n.unit(),n.timezone())}case H.Interval:{const n=i.type(new jt);return new Wi(n.unit())}case H.Union:{const n=i.type(new at);return new Hi(n.mode(),n.typeIdsArray()||[],t||[])}case H.FixedSizeBinary:{const n=i.type(new Pt);return new Ji(n.byteWidth())}case H.FixedSizeList:{const n=i.type(new zt);return new Gi(n.listSize(),(t||[])[0])}case H.Map:{const n=i.type(new Li);return new qi((t||[])[0],n.keysSorted())}}throw new Error(`Unrecognized type: "${H[e]}" (${e})`)}function Nu(i,t){const e=t.fields.map(s=>Y.encode(i,s));xt.startFieldsVector(i,e.length);const n=xt.createFieldsVector(i,e),r=t.metadata&&t.metadata.size>0?xt.createCustomMetadataVector(i,[...t.metadata].map(([s,o])=>{const a=i.createString(`${s}`),c=i.createString(`${o}`);return X.startKeyValue(i),X.addKey(i,a),X.addValue(i,c),X.endKeyValue(i)})):-1;return xt.startSchema(i),xt.addFields(i,n),xt.addEndianness(i,zu?He.Little:He.Big),r!==-1&&xt.addCustomMetadata(i,r),xt.endSchema(i)}function xu(i,t){let e=-1,n=-1,r=-1;const s=t.type;let o=t.typeId;g.isDictionary(s)?(o=s.dictionary.typeId,r=Nn.visit(s,i),n=Nn.visit(s.dictionary,i)):n=Nn.visit(s,i);const a=(s.children||[]).map(u=>Y.encode(i,u)),c=St.createChildrenVector(i,a),l=t.metadata&&t.metadata.size>0?St.createCustomMetadataVector(i,[...t.metadata].map(([u,d])=>{const p=i.createString(`${u}`),f=i.createString(`${d}`);return X.startKeyValue(i),X.addKey(i,p),X.addValue(i,f),X.endKeyValue(i)})):-1;return t.name&&(e=i.createString(t.name)),St.startField(i),St.addType(i,n),St.addTypeType(i,o),St.addChildren(i,c),St.addNullable(i,!!t.nullable),e!==-1&&St.addName(i,e),r!==-1&&St.addDictionary(i,r),l!==-1&&St.addCustomMetadata(i,l),St.endField(i)}function Ru(i,t){const e=t.nodes||[],n=t.buffers||[];Zt.startNodesVector(i,e.length);for(const o of e.slice().reverse())Ce.encode(i,o);const r=i.endVector();Zt.startBuffersVector(i,n.length);for(const o of n.slice().reverse())Wt.encode(i,o);const s=i.endVector();return Zt.startRecordBatch(i),Zt.addLength(i,new Me(t.length,0)),Zt.addNodes(i,r),Zt.addBuffers(i,s),Zt.endRecordBatch(i)}function Uu(i,t){const e=bt.encode(i,t.data);return Re.startDictionaryBatch(i),Re.addId(i,new Me(t.id,0)),Re.addIsDelta(i,t.isDelta),Re.addData(i,e),Re.endDictionaryBatch(i)}function ku(i,t){return ya.createFieldNode(i,new Me(t.length,0),new Me(t.nullCount,0))}function Pu(i,t){return pa.createBuffer(i,new Me(t.offset,0),new Me(t.length,0))}const zu=(()=>{const i=new ArrayBuffer(2);return new DataView(i).setInt16(0,256,!0),new Int16Array(i)[0]===256})(),Er=i=>`Expected ${E[i]} Message in stream, but was null or length 0.`,Nr=i=>`Header pointer of flatbuffer-encoded ${E[i]} Message is null or length 0.`,va=(i,t)=>`Expected to read ${i} metadata bytes, but only read ${t}.`,_a=(i,t)=>`Expected to read ${i} bytes for message body, but only read ${t}.`;class wa{constructor(t){this.source=t instanceof sn?t:new sn(t)}[Symbol.iterator](){return this}next(){let t;return(t=this.readMetadataLength()).done||t.value===-1&&(t=this.readMetadataLength()).done||(t=this.readMetadata(t.value)).done?J:t}throw(t){return this.source.throw(t)}return(t){return this.source.return(t)}readMessage(t){let e;if((e=this.next()).done)return null;if(t!=null&&e.value.headerType!==t)throw new Error(Er(t));return e.value}readMessageBody(t){if(t<=0)return new Uint8Array(0);const e=C(this.source.read(t));if(e.byteLength<t)throw new Error(_a(t,e.byteLength));return e.byteOffset%8===0&&e.byteOffset+e.byteLength<=e.buffer.byteLength?e:e.slice()}readSchema(t=!1){const e=E.Schema,n=this.readMessage(e),r=n==null?void 0:n.header();if(t&&!r)throw new Error(Nr(e));return r}readMetadataLength(){const t=this.source.read(Dn),e=t&&new We(t),n=(e==null?void 0:e.readInt32(0))||0;return{done:n===0,value:n}}readMetadata(t){const e=this.source.read(t);if(!e)return J;if(e.byteLength<t)throw new Error(va(t,e.byteLength));return{done:!1,value:rt.decode(e)}}}class $u{constructor(t,e){this.source=t instanceof Ge?t:$s(t)?new on(t,e):new Ge(t)}[Symbol.asyncIterator](){return this}next(){return m(this,void 0,void 0,function*(){let t;return(t=yield this.readMetadataLength()).done||t.value===-1&&(t=yield this.readMetadataLength()).done||(t=yield this.readMetadata(t.value)).done?J:t})}throw(t){return m(this,void 0,void 0,function*(){return yield this.source.throw(t)})}return(t){return m(this,void 0,void 0,function*(){return yield this.source.return(t)})}readMessage(t){return m(this,void 0,void 0,function*(){let e;if((e=yield this.next()).done)return null;if(t!=null&&e.value.headerType!==t)throw new Error(Er(t));return e.value})}readMessageBody(t){return m(this,void 0,void 0,function*(){if(t<=0)return new Uint8Array(0);const e=C(yield this.source.read(t));if(e.byteLength<t)throw new Error(_a(t,e.byteLength));return e.byteOffset%8===0&&e.byteOffset+e.byteLength<=e.buffer.byteLength?e:e.slice()})}readSchema(t=!1){return m(this,void 0,void 0,function*(){const e=E.Schema,n=yield this.readMessage(e),r=n==null?void 0:n.header();if(t&&!r)throw new Error(Nr(e));return r})}readMetadataLength(){return m(this,void 0,void 0,function*(){const t=yield this.source.read(Dn),e=t&&new We(t),n=(e==null?void 0:e.readInt32(0))||0;return{done:n===0,value:n}})}readMetadata(t){return m(this,void 0,void 0,function*(){const e=yield this.source.read(t);if(!e)return J;if(e.byteLength<t)throw new Error(va(t,e.byteLength));return{done:!1,value:rt.decode(e)}})}}class ju extends wa{constructor(t){super(new Uint8Array(0)),this._schema=!1,this._body=[],this._batchIndex=0,this._dictionaryIndex=0,this._json=t instanceof os?t:new os(t)}next(){const{_json:t}=this;if(!this._schema)return this._schema=!0,{done:!1,value:rt.fromJSON(t.schema,E.Schema)};if(this._dictionaryIndex<t.dictionaries.length){const e=t.dictionaries[this._dictionaryIndex++];return this._body=e.data.columns,{done:!1,value:rt.fromJSON(e,E.DictionaryBatch)}}if(this._batchIndex<t.batches.length){const e=t.batches[this._batchIndex++];return this._body=e.columns,{done:!1,value:rt.fromJSON(e,E.RecordBatch)}}return this._body=[],J}readMessageBody(t){return e(this._body);function e(n){return(n||[]).reduce((r,s)=>[...r,...s.VALIDITY&&[s.VALIDITY]||[],...s.TYPE&&[s.TYPE]||[],...s.OFFSET&&[s.OFFSET]||[],...s.DATA&&[s.DATA]||[],...e(s.children)],[])}}readMessage(t){let e;if((e=this.next()).done)return null;if(t!=null&&e.value.headerType!==t)throw new Error(Er(t));return e.value}readSchema(){const t=E.Schema,e=this.readMessage(t),n=e==null?void 0:e.header();if(!e||!n)throw new Error(Nr(t));return n}}const Dn=4,tr="ARROW1",pi=new Uint8Array(tr.length);for(let i=0;i<tr.length;i+=1)pi[i]=tr.codePointAt(i);function xr(i,t=0){for(let e=-1,n=pi.length;++e<n;)if(pi[e]!==i[t+e])return!1;return!0}const Bi=pi.length,Sa=Bi+Dn,Vu=Bi*2+Dn;class ie extends Dr{constructor(t){super(),this._impl=t}get closed(){return this._impl.closed}get schema(){return this._impl.schema}get autoDestroy(){return this._impl.autoDestroy}get dictionaries(){return this._impl.dictionaries}get numDictionaries(){return this._impl.numDictionaries}get numRecordBatches(){return this._impl.numRecordBatches}get footer(){return this._impl.isFile()?this._impl.footer:null}isSync(){return this._impl.isSync()}isAsync(){return this._impl.isAsync()}isFile(){return this._impl.isFile()}isStream(){return this._impl.isStream()}next(){return this._impl.next()}throw(t){return this._impl.throw(t)}return(t){return this._impl.return(t)}cancel(){return this._impl.cancel()}reset(t){return this._impl.reset(t),this._DOMStream=void 0,this._nodeStream=void 0,this}open(t){const e=this._impl.open(t);return he(e)?e.then(()=>this):this}readRecordBatch(t){return this._impl.isFile()?this._impl.readRecordBatch(t):null}[Symbol.iterator](){return this._impl[Symbol.iterator]()}[Symbol.asyncIterator](){return this._impl[Symbol.asyncIterator]()}toDOMStream(){return It.toDOMStream(this.isSync()?{[Symbol.iterator]:()=>this}:{[Symbol.asyncIterator]:()=>this})}toNodeStream(){return It.toNodeStream(this.isSync()?{[Symbol.iterator]:()=>this}:{[Symbol.asyncIterator]:()=>this},{objectMode:!0})}static throughNode(t){throw new Error('"throughNode" not available in this environment')}static throughDOM(t,e){throw new Error('"throughDOM" not available in this environment')}static from(t){return t instanceof ie?t:Vn(t)?Ju(t):$s(t)?Ku(t):he(t)?m(this,void 0,void 0,function*(){return yield ie.from(yield t)}):js(t)||fr(t)||Vs(t)||Ze(t)?qu(new Ge(t)):Gu(new sn(t))}static readAll(t){return t instanceof ie?t.isSync()?ys(t):ms(t):Vn(t)||ArrayBuffer.isView(t)||_i(t)||zs(t)?ys(t):ms(t)}}class un extends ie{constructor(t){super(t),this._impl=t}readAll(){return[...this]}[Symbol.iterator](){return this._impl[Symbol.iterator]()}[Symbol.asyncIterator](){return Vt(this,arguments,function*(){yield A(yield*Mi(Fe(this[Symbol.iterator]())))})}}class hn extends ie{constructor(t){super(t),this._impl=t}readAll(){var t,e;return m(this,void 0,void 0,function*(){const n=new Array;try{for(var r=Fe(this),s;s=yield r.next(),!s.done;){const o=s.value;n.push(o)}}catch(o){t={error:o}}finally{try{s&&!s.done&&(e=r.return)&&(yield e.call(r))}finally{if(t)throw t.error}}return n})}[Symbol.iterator](){throw new Error("AsyncRecordBatchStreamReader is not Iterable")}[Symbol.asyncIterator](){return this._impl[Symbol.asyncIterator]()}}class Ia extends un{constructor(t){super(t),this._impl=t}}class Wu extends hn{constructor(t){super(t),this._impl=t}}class Ba{constructor(t=new Map){this.closed=!1,this.autoDestroy=!0,this._dictionaryIndex=0,this._recordBatchIndex=0,this.dictionaries=t}get numDictionaries(){return this._dictionaryIndex}get numRecordBatches(){return this._recordBatchIndex}isSync(){return!1}isAsync(){return!1}isFile(){return!1}isStream(){return!1}reset(t){return this._dictionaryIndex=0,this._recordBatchIndex=0,this.schema=t,this.dictionaries=new Map,this}_loadRecordBatch(t,e){const n=this._loadVectors(t,e,this.schema.fields),r=T({type:new nt(this.schema.fields),length:t.length,children:n});return new ct(this.schema,r)}_loadDictionaryBatch(t,e){const{id:n,isDelta:r}=t,{dictionaries:s,schema:o}=this,a=s.get(n);if(r||!a){const c=o.dictionaries.get(n),l=this._loadVectors(t.data,e,[c]);return(a&&r?a.concat(new N(l)):new N(l)).memoize()}return a.memoize()}_loadVectors(t,e,n){return new ua(e,t.nodes,t.buffers,this.dictionaries).visitMany(n)}}class dn extends Ba{constructor(t,e){super(e),this._reader=Vn(t)?new ju(this._handle=t):new wa(this._handle=t)}isSync(){return!0}isStream(){return!0}[Symbol.iterator](){return this}cancel(){!this.closed&&(this.closed=!0)&&(this.reset()._reader.return(),this._reader=null,this.dictionaries=null)}open(t){return this.closed||(this.autoDestroy=Aa(this,t),this.schema||(this.schema=this._reader.readSchema())||this.cancel()),this}throw(t){return!this.closed&&this.autoDestroy&&(this.closed=!0)?this.reset()._reader.throw(t):J}return(t){return!this.closed&&this.autoDestroy&&(this.closed=!0)?this.reset()._reader.return(t):J}next(){if(this.closed)return J;let t;const{_reader:e}=this;for(;t=this._readNextMessageAndValidate();)if(t.isSchema())this.reset(t.header());else if(t.isRecordBatch()){this._recordBatchIndex++;const n=t.header(),r=e.readMessageBody(t.bodyLength);return{done:!1,value:this._loadRecordBatch(n,r)}}else if(t.isDictionaryBatch()){this._dictionaryIndex++;const n=t.header(),r=e.readMessageBody(t.bodyLength),s=this._loadDictionaryBatch(n,r);this.dictionaries.set(n.id,s)}return this.schema&&this._recordBatchIndex===0?(this._recordBatchIndex++,{done:!1,value:new Lr(this.schema)}):this.return()}_readNextMessageAndValidate(t){return this._reader.readMessage(t)}}class fn extends Ba{constructor(t,e){super(e),this._reader=new $u(this._handle=t)}isAsync(){return!0}isStream(){return!0}[Symbol.asyncIterator](){return this}cancel(){return m(this,void 0,void 0,function*(){!this.closed&&(this.closed=!0)&&(yield this.reset()._reader.return(),this._reader=null,this.dictionaries=null)})}open(t){return m(this,void 0,void 0,function*(){return this.closed||(this.autoDestroy=Aa(this,t),this.schema||(this.schema=yield this._reader.readSchema())||(yield this.cancel())),this})}throw(t){return m(this,void 0,void 0,function*(){return!this.closed&&this.autoDestroy&&(this.closed=!0)?yield this.reset()._reader.throw(t):J})}return(t){return m(this,void 0,void 0,function*(){return!this.closed&&this.autoDestroy&&(this.closed=!0)?yield this.reset()._reader.return(t):J})}next(){return m(this,void 0,void 0,function*(){if(this.closed)return J;let t;const{_reader:e}=this;for(;t=yield this._readNextMessageAndValidate();)if(t.isSchema())yield this.reset(t.header());else if(t.isRecordBatch()){this._recordBatchIndex++;const n=t.header(),r=yield e.readMessageBody(t.bodyLength);return{done:!1,value:this._loadRecordBatch(n,r)}}else if(t.isDictionaryBatch()){this._dictionaryIndex++;const n=t.header(),r=yield e.readMessageBody(t.bodyLength),s=this._loadDictionaryBatch(n,r);this.dictionaries.set(n.id,s)}return this.schema&&this._recordBatchIndex===0?(this._recordBatchIndex++,{done:!1,value:new Lr(this.schema)}):yield this.return()})}_readNextMessageAndValidate(t){return m(this,void 0,void 0,function*(){return yield this._reader.readMessage(t)})}}class Oa extends dn{constructor(t,e){super(t instanceof as?t:new as(t),e)}get footer(){return this._footer}get numDictionaries(){return this._footer?this._footer.numDictionaries:0}get numRecordBatches(){return this._footer?this._footer.numRecordBatches:0}isSync(){return!0}isFile(){return!0}open(t){if(!this.closed&&!this._footer){this.schema=(this._footer=this._readFooter()).schema;for(const e of this._footer.dictionaryBatches())e&&this._readDictionaryBatch(this._dictionaryIndex++)}return super.open(t)}readRecordBatch(t){var e;if(this.closed)return null;this._footer||this.open();const n=(e=this._footer)===null||e===void 0?void 0:e.getRecordBatch(t);if(n&&this._handle.seek(n.offset)){const r=this._reader.readMessage(E.RecordBatch);if(r!=null&&r.isRecordBatch()){const s=r.header(),o=this._reader.readMessageBody(r.bodyLength);return this._loadRecordBatch(s,o)}}return null}_readDictionaryBatch(t){var e;const n=(e=this._footer)===null||e===void 0?void 0:e.getDictionaryBatch(t);if(n&&this._handle.seek(n.offset)){const r=this._reader.readMessage(E.DictionaryBatch);if(r!=null&&r.isDictionaryBatch()){const s=r.header(),o=this._reader.readMessageBody(r.bodyLength),a=this._loadDictionaryBatch(s,o);this.dictionaries.set(s.id,a)}}}_readFooter(){const{_handle:t}=this,e=t.size-Sa,n=t.readInt32(e),r=t.readAt(e-n,n);return fi.decode(r)}_readNextMessageAndValidate(t){var e;if(this._footer||this.open(),this._footer&&this._recordBatchIndex<this.numRecordBatches){const n=(e=this._footer)===null||e===void 0?void 0:e.getRecordBatch(this._recordBatchIndex);if(n&&this._handle.seek(n.offset))return this._reader.readMessage(t)}return null}}class Yu extends fn{constructor(t,...e){const n=typeof e[0]!="number"?e.shift():void 0,r=e[0]instanceof Map?e.shift():void 0;super(t instanceof on?t:new on(t,n),r)}get footer(){return this._footer}get numDictionaries(){return this._footer?this._footer.numDictionaries:0}get numRecordBatches(){return this._footer?this._footer.numRecordBatches:0}isFile(){return!0}isAsync(){return!0}open(t){const e=Object.create(null,{open:{get:()=>super.open}});return m(this,void 0,void 0,function*(){if(!this.closed&&!this._footer){this.schema=(this._footer=yield this._readFooter()).schema;for(const n of this._footer.dictionaryBatches())n&&(yield this._readDictionaryBatch(this._dictionaryIndex++))}return yield e.open.call(this,t)})}readRecordBatch(t){var e;return m(this,void 0,void 0,function*(){if(this.closed)return null;this._footer||(yield this.open());const n=(e=this._footer)===null||e===void 0?void 0:e.getRecordBatch(t);if(n&&(yield this._handle.seek(n.offset))){const r=yield this._reader.readMessage(E.RecordBatch);if(r!=null&&r.isRecordBatch()){const s=r.header(),o=yield this._reader.readMessageBody(r.bodyLength);return this._loadRecordBatch(s,o)}}return null})}_readDictionaryBatch(t){var e;return m(this,void 0,void 0,function*(){const n=(e=this._footer)===null||e===void 0?void 0:e.getDictionaryBatch(t);if(n&&(yield this._handle.seek(n.offset))){const r=yield this._reader.readMessage(E.DictionaryBatch);if(r!=null&&r.isDictionaryBatch()){const s=r.header(),o=yield this._reader.readMessageBody(r.bodyLength),a=this._loadDictionaryBatch(s,o);this.dictionaries.set(s.id,a)}}})}_readFooter(){return m(this,void 0,void 0,function*(){const{_handle:t}=this;t._pending&&(yield t._pending);const e=t.size-Sa,n=yield t.readInt32(e),r=yield t.readAt(e-n,n);return fi.decode(r)})}_readNextMessageAndValidate(t){return m(this,void 0,void 0,function*(){if(this._footer||(yield this.open()),this._footer&&this._recordBatchIndex<this.numRecordBatches){const e=this._footer.getRecordBatch(this._recordBatchIndex);if(e&&(yield this._handle.seek(e.offset)))return yield this._reader.readMessage(t)}return null})}}class Hu extends dn{constructor(t,e){super(t,e)}_loadVectors(t,e,n){return new ru(e,t.nodes,t.buffers,this.dictionaries).visitMany(n)}}function Aa(i,t){return t&&typeof t.autoDestroy=="boolean"?t.autoDestroy:i.autoDestroy}function*ys(i){const t=ie.from(i);try{if(!t.open({autoDestroy:!1}).closed)do yield t;while(!t.reset().open().closed)}finally{t.cancel()}}function ms(i){return Vt(this,arguments,function*(){const e=yield A(ie.from(i));try{if(!(yield A(e.open({autoDestroy:!1}))).closed)do yield yield A(e);while(!(yield A(e.reset().open())).closed)}finally{yield A(e.cancel())}})}function Ju(i){return new un(new Hu(i))}function Gu(i){const t=i.peek(Bi+7&-8);return t&&t.byteLength>=4?xr(t)?new Ia(new Oa(i.read())):new un(new dn(i)):new un(new dn(function*(){}()))}function qu(i){return m(this,void 0,void 0,function*(){const t=yield i.peek(Bi+7&-8);return t&&t.byteLength>=4?xr(t)?new Ia(new Oa(yield i.read())):new hn(new fn(i)):new hn(new fn(function(){return Vt(this,arguments,function*(){})}()))})}function Ku(i){return m(this,void 0,void 0,function*(){const{size:t}=yield i.stat(),e=new on(i,t);return t>=Vu&&xr(yield e.readAt(0,Bi+7&-8))?new Wu(new Yu(e)):new hn(new fn(e))})}class q extends M{constructor(){super(),this._byteLength=0,this._nodes=[],this._buffers=[],this._bufferRegions=[]}static assemble(...t){const e=r=>r.flatMap(s=>Array.isArray(s)?e(s):s instanceof ct?s.data.children:s.data),n=new q;return n.visitMany(e(t)),n}visit(t){if(t instanceof N)return this.visitMany(t.data),this;const{type:e}=t;if(!g.isDictionary(e)){const{length:n,nullCount:r}=t;if(n>2147483647)throw new RangeError("Cannot write arrays larger than 2^31 - 1 in length");g.isNull(e)||Tt.call(this,r<=0?new Uint8Array(0):Sr(t.offset,n,t.nullBitmap)),this.nodes.push(new Ce(n,r))}return super.visit(t)}visitNull(t){return this}visitDictionary(t){return this.visit(t.clone(t.type.indices))}get nodes(){return this._nodes}get buffers(){return this._buffers}get byteLength(){return this._byteLength}get bufferRegions(){return this._bufferRegions}}function Tt(i){const t=i.byteLength+7&-8;return this.buffers.push(i),this.bufferRegions.push(new Wt(this._byteLength,t)),this._byteLength+=t,this}function Xu(i){const{type:t,length:e,typeIds:n,valueOffsets:r}=i;if(Tt.call(this,n),t.mode===gt.Sparse)return er.call(this,i);if(t.mode===gt.Dense){if(i.offset<=0)return Tt.call(this,r),er.call(this,i);{const s=n.reduce((u,d)=>Math.max(u,d),n[0]),o=new Int32Array(s+1),a=new Int32Array(s+1).fill(-1),c=new Int32Array(e),l=yr(-r[0],e,r);for(let u,d,p=-1;++p<e;)(d=a[u=n[p]])===-1&&(d=a[u]=l[u]),c[p]=l[p]-d,++o[u];Tt.call(this,c);for(let u,d=-1,p=t.children.length;++d<p;)if(u=i.children[d]){const f=t.typeIds[d],y=Math.min(e,o[f]);this.visit(u.slice(a[f],y))}}}return this}function Zu(i){let t;return i.nullCount>=i.length?Tt.call(this,new Uint8Array(0)):(t=i.values)instanceof Uint8Array?Tt.call(this,Sr(i.offset,i.length,t)):Tt.call(this,Ki(i.values))}function _e(i){return Tt.call(this,i.values.subarray(0,i.length*i.stride))}function Da(i){const{length:t,values:e,valueOffsets:n}=i,r=n[0],s=n[t],o=Math.min(s-r,e.byteLength-r);return Tt.call(this,yr(-n[0],t,n)),Tt.call(this,e.subarray(r,r+o)),this}function Rr(i){const{length:t,valueOffsets:e}=i;return e&&Tt.call(this,yr(e[0],t,e)),this.visit(i.children[0])}function er(i){return this.visitMany(i.type.children.map((t,e)=>i.children[e]).filter(Boolean))[0]}q.prototype.visitBool=Zu;q.prototype.visitInt=_e;q.prototype.visitFloat=_e;q.prototype.visitUtf8=Da;q.prototype.visitBinary=Da;q.prototype.visitFixedSizeBinary=_e;q.prototype.visitDate=_e;q.prototype.visitTimestamp=_e;q.prototype.visitTime=_e;q.prototype.visitDecimal=_e;q.prototype.visitList=Rr;q.prototype.visitStruct=er;q.prototype.visitUnion=Xu;q.prototype.visitInterval=_e;q.prototype.visitFixedSizeList=Rr;q.prototype.visitMap=Rr;class Fa extends Dr{constructor(t){super(),this._position=0,this._started=!1,this._sink=new Ni,this._schema=null,this._dictionaryBlocks=[],this._recordBatchBlocks=[],this._dictionaryDeltaOffsets=new Map,ut(t)||(t={autoDestroy:!0,writeLegacyIpcFormat:!1}),this._autoDestroy=typeof t.autoDestroy=="boolean"?t.autoDestroy:!0,this._writeLegacyIpcFormat=typeof t.writeLegacyIpcFormat=="boolean"?t.writeLegacyIpcFormat:!1}static throughNode(t){throw new Error('"throughNode" not available in this environment')}static throughDOM(t,e){throw new Error('"throughDOM" not available in this environment')}toString(t=!1){return this._sink.toString(t)}toUint8Array(t=!1){return this._sink.toUint8Array(t)}writeAll(t){return he(t)?t.then(e=>this.writeAll(e)):Ze(t)?zr(this,t):Pr(this,t)}get closed(){return this._sink.closed}[Symbol.asyncIterator](){return this._sink[Symbol.asyncIterator]()}toDOMStream(t){return this._sink.toDOMStream(t)}toNodeStream(t){return this._sink.toNodeStream(t)}close(){return this.reset()._sink.close()}abort(t){return this.reset()._sink.abort(t)}finish(){return this._autoDestroy?this.close():this.reset(this._sink,this._schema),this}reset(t=this._sink,e=null){return t===this._sink||t instanceof Ni?this._sink=t:(this._sink=new Ni,t&&vc(t)?this.toDOMStream({type:"bytes"}).pipeTo(t):t&&_c(t)&&this.toNodeStream({objectMode:!1}).pipe(t)),this._started&&this._schema&&this._writeFooter(this._schema),this._started=!1,this._dictionaryBlocks=[],this._recordBatchBlocks=[],this._dictionaryDeltaOffsets=new Map,(!e||!Xn(e,this._schema))&&(e==null?(this._position=0,this._schema=null):(this._started=!0,this._schema=e,this._writeSchema(e))),this}write(t){let e=null;if(this._sink){if(t==null)return this.finish()&&void 0;if(t instanceof it&&!(e=t.schema))return this.finish()&&void 0;if(t instanceof ct&&!(e=t.schema))return this.finish()&&void 0}else throw new Error("RecordBatchWriter is closed");if(e&&!Xn(e,this._schema)){if(this._started&&this._autoDestroy)return this.close();this.reset(this._sink,e)}t instanceof ct?t instanceof Lr||this._writeRecordBatch(t):t instanceof it?this.writeAll(t.batches):_i(t)&&this.writeAll(t)}_writeMessage(t,e=8){const n=e-1,r=rt.encode(t),s=r.byteLength,o=this._writeLegacyIpcFormat?4:8,a=s+o+n&~n,c=a-s-o;return t.headerType===E.RecordBatch?this._recordBatchBlocks.push(new ye(a,t.bodyLength,this._position)):t.headerType===E.DictionaryBatch&&this._dictionaryBlocks.push(new ye(a,t.bodyLength,this._position)),this._writeLegacyIpcFormat||this._write(Int32Array.of(-1)),this._write(Int32Array.of(a-o)),s>0&&this._write(r),this._writePadding(c)}_write(t){if(this._started){const e=C(t);e&&e.byteLength>0&&(this._sink.write(e),this._position+=e.byteLength)}return this}_writeSchema(t){return this._writeMessage(rt.from(t))}_writeFooter(t){return this._writeLegacyIpcFormat?this._write(Int32Array.of(0)):this._write(Int32Array.of(-1,0))}_writeMagic(){return this._write(pi)}_writePadding(t){return t>0?this._write(new Uint8Array(t)):this}_writeRecordBatch(t){const{byteLength:e,nodes:n,bufferRegions:r,buffers:s}=q.assemble(t),o=new bt(t.numRows,n,r),a=rt.from(o,e);return this._writeDictionaries(t)._writeMessage(a)._writeBodyBuffers(s)}_writeDictionaryBatch(t,e,n=!1){this._dictionaryDeltaOffsets.set(e,t.length+(this._dictionaryDeltaOffsets.get(e)||0));const{byteLength:r,nodes:s,bufferRegions:o,buffers:a}=q.assemble(new N([t])),c=new bt(t.length,s,o),l=new Jt(c,e,n),u=rt.from(l,r);return this._writeMessage(u)._writeBodyBuffers(a)}_writeBodyBuffers(t){let e,n,r;for(let s=-1,o=t.length;++s<o;)(e=t[s])&&(n=e.byteLength)>0&&(this._write(e),(r=(n+7&-8)-n)>0&&this._writePadding(r));return this}_writeDictionaries(t){for(let[e,n]of t.dictionaries){let r=this._dictionaryDeltaOffsets.get(e)||0;if(r===0||(n=n==null?void 0:n.slice(r)).length>0)for(const s of n.data)this._writeDictionaryBatch(s,e,r>0),r+=s.length}return this}}class Ur extends Fa{static writeAll(t,e){const n=new Ur(e);return he(t)?t.then(r=>n.writeAll(r)):Ze(t)?zr(n,t):Pr(n,t)}}class kr extends Fa{static writeAll(t){const e=new kr;return he(t)?t.then(n=>e.writeAll(n)):Ze(t)?zr(e,t):Pr(e,t)}constructor(){super(),this._autoDestroy=!0}_writeSchema(t){return this._writeMagic()._writePadding(2)}_writeFooter(t){const e=fi.encode(new fi(t,mt.V4,this._recordBatchBlocks,this._dictionaryBlocks));return super._writeFooter(t)._write(e)._write(Int32Array.of(e.byteLength))._writeMagic()}}function Pr(i,t){let e=t;t instanceof it&&(e=t.batches,i.reset(void 0,t.schema));for(const n of e)i.write(n);return i.finish()}function zr(i,t){var e,n,r,s;return m(this,void 0,void 0,function*(){try{for(e=Fe(t);n=yield e.next(),!n.done;){const o=n.value;i.write(o)}}catch(o){r={error:o}}finally{try{n&&!n.done&&(s=e.return)&&(yield s.call(e))}finally{if(r)throw r.error}}return i.finish()})}function ri(i){const t=ie.from(i);return he(t)?t.then(e=>ri(e)):t.isAsync()?t.readAll().then(e=>new it(e)):new it(t.readAll())}function xn(i,t="stream"){return(t==="stream"?Ur:kr).writeAll(i).toUint8Array(!0)}var gs=function(){function i(t,e,n,r){var s=this;this.getCell=function(o,a){var c=o<s.headerRows&&a<s.headerColumns,l=o>=s.headerRows&&a<s.headerColumns,u=o<s.headerRows&&a>=s.headerColumns;if(c){var d=["blank"];return a>0&&d.push("level"+o),{type:"blank",classNames:d.join(" "),content:""}}else if(u){var p=a-s.headerColumns,d=["col_heading","level"+o,"col"+p];return{type:"columns",classNames:d.join(" "),content:s.getContent(s.columnsTable,p,o)}}else if(l){var f=o-s.headerRows,d=["row_heading","level"+a,"row"+f];return{type:"index",id:"T_".concat(s.uuid,"level").concat(a,"_row").concat(f),classNames:d.join(" "),content:s.getContent(s.indexTable,f,a)}}else{var f=o-s.headerRows,p=a-s.headerColumns,d=["data","row"+f,"col"+p],y=s.styler?s.getContent(s.styler.displayValuesTable,f,p):s.getContent(s.dataTable,f,p);return{type:"data",id:"T_".concat(s.uuid,"row").concat(f,"_col").concat(p),classNames:d.join(" "),content:y}}},this.getContent=function(o,a,c){var l=o.getChildAt(c);if(l===null)return"";var u=s.getColumnTypeId(o,c);switch(u){case h.Timestamp:return s.nanosToDate(l.get(a));default:return l.get(a)}},this.dataTable=ri(t),this.indexTable=ri(e),this.columnsTable=ri(n),this.styler=r?{caption:r.caption,displayValuesTable:ri(r.displayValues),styles:r.styles,uuid:r.uuid}:void 0}return Object.defineProperty(i.prototype,"rows",{get:function(){return this.indexTable.numRows+this.columnsTable.numCols},enumerable:!1,configurable:!0}),Object.defineProperty(i.prototype,"columns",{get:function(){return this.indexTable.numCols+this.columnsTable.numRows},enumerable:!1,configurable:!0}),Object.defineProperty(i.prototype,"headerRows",{get:function(){return this.rows-this.dataRows},enumerable:!1,configurable:!0}),Object.defineProperty(i.prototype,"headerColumns",{get:function(){return this.columns-this.dataColumns},enumerable:!1,configurable:!0}),Object.defineProperty(i.prototype,"dataRows",{get:function(){return this.dataTable.numRows},enumerable:!1,configurable:!0}),Object.defineProperty(i.prototype,"dataColumns",{get:function(){return this.dataTable.numCols},enumerable:!1,configurable:!0}),Object.defineProperty(i.prototype,"uuid",{get:function(){return this.styler&&this.styler.uuid},enumerable:!1,configurable:!0}),Object.defineProperty(i.prototype,"caption",{get:function(){return this.styler&&this.styler.caption},enumerable:!1,configurable:!0}),Object.defineProperty(i.prototype,"styles",{get:function(){return this.styler&&this.styler.styles},enumerable:!1,configurable:!0}),Object.defineProperty(i.prototype,"table",{get:function(){return this.dataTable},enumerable:!1,configurable:!0}),Object.defineProperty(i.prototype,"index",{get:function(){return this.indexTable},enumerable:!1,configurable:!0}),Object.defineProperty(i.prototype,"columnTable",{get:function(){return this.columnsTable},enumerable:!1,configurable:!0}),i.prototype.serialize=function(){return{data:xn(this.dataTable),index:xn(this.indexTable),columns:xn(this.columnsTable)}},i.prototype.getColumnTypeId=function(t,e){return t.schema.fields[e].type.typeId},i.prototype.nanosToDate=function(t){return new Date(t/1e6)},i}(),oi=function(){return oi=Object.assign||function(i){for(var t,e=1,n=arguments.length;e<n;e++){t=arguments[e];for(var r in t)Object.prototype.hasOwnProperty.call(t,r)&&(i[r]=t[r])}return i},oi.apply(this,arguments)},ai;(function(i){i.COMPONENT_READY="streamlit:componentReady",i.SET_COMPONENT_VALUE="streamlit:setComponentValue",i.SET_FRAME_HEIGHT="streamlit:setFrameHeight"})(ai||(ai={}));var ge=function(){function i(){}return i.API_VERSION=1,i.RENDER_EVENT="streamlit:render",i.events=new EventTarget,i.registeredMessageListener=!1,i.setComponentReady=function(){i.registeredMessageListener||(window.addEventListener("message",i.onMessageEvent),i.registeredMessageListener=!0),i.sendBackMsg(ai.COMPONENT_READY,{apiVersion:i.API_VERSION})},i.setFrameHeight=function(t){t===void 0&&(t=document.body.scrollHeight),t!==i.lastFrameHeight&&(i.lastFrameHeight=t,i.sendBackMsg(ai.SET_FRAME_HEIGHT,{height:t}))},i.setComponentValue=function(t){var e;t instanceof gs?(e="dataframe",t=t.serialize()):th(t)?(e="bytes",t=new Uint8Array(t.buffer)):t instanceof ArrayBuffer?(e="bytes",t=new Uint8Array(t)):e="json",i.sendBackMsg(ai.SET_COMPONENT_VALUE,{value:t,dataType:e})},i.onMessageEvent=function(t){var e=t.data.type;switch(e){case i.RENDER_EVENT:i.onRenderMessage(t.data);break}},i.onRenderMessage=function(t){var e=t.args;e==null&&(console.error("Got null args in onRenderMessage. This should never happen"),e={});var n=t.dfs&&t.dfs.length>0?i.argsDataframeToObject(t.dfs):{};e=oi(oi({},e),n);var r=!!t.disabled,s=t.theme;s&&Qu(s);var o={disabled:r,args:e,theme:s},a=new CustomEvent(i.RENDER_EVENT,{detail:o});i.events.dispatchEvent(a)},i.argsDataframeToObject=function(t){var e=t.map(function(n){var r=n.key,s=n.value;return[r,i.toArrowTable(s)]});return Object.fromEntries(e)},i.toArrowTable=function(t){var e,n=(e=t.data,e.data),r=e.index,s=e.columns,o=e.styler;return new gs(n,r,s,o)},i.sendBackMsg=function(t,e){window.parent.postMessage(oi({isStreamlitMessage:!0,type:t},e),"*")},i}(),Qu=function(i){var t=document.createElement("style");document.head.appendChild(t),t.innerHTML=`
    :root {
      --primary-color: `.concat(i.primaryColor,`;
      --background-color: `).concat(i.backgroundColor,`;
      --secondary-background-color: `).concat(i.secondaryBackgroundColor,`;
      --text-color: `).concat(i.textColor,`;
      --font: `).concat(i.font,`;
    }

    body {
      background-color: var(--background-color);
      color: var(--text-color);
    }
  `)};function th(i){var t=!1;try{t=i instanceof BigInt64Array||i instanceof BigUint64Array}catch{}return i instanceof Int8Array||i instanceof Uint8Array||i instanceof Uint8ClampedArray||i instanceof Int16Array||i instanceof Uint16Array||i instanceof Int32Array||i instanceof Uint32Array||i instanceof Float32Array||i instanceof Float64Array||t}var eh=function(){var i=function(t,e){return i=Object.setPrototypeOf||{__proto__:[]}instanceof Array&&function(n,r){n.__proto__=r}||function(n,r){for(var s in r)Object.prototype.hasOwnProperty.call(r,s)&&(n[s]=r[s])},i(t,e)};return function(t,e){if(typeof e!="function"&&e!==null)throw new TypeError("Class extends value "+String(e)+" is not a constructor or null");i(t,e);function n(){this.constructor=t}t.prototype=e===null?Object.create(e):(n.prototype=e.prototype,new n)}}();(function(i){eh(t,i);function t(){return i!==null&&i.apply(this,arguments)||this}return t.prototype.componentDidMount=function(){ge.setFrameHeight()},t.prototype.componentDidUpdate=function(){ge.setFrameHeight()},t})(pc.PureComponent);let Fi=1,Mt=[],$r=0,ue,ir;const bs=document.getElementById("playpause"),ih=document.getElementById("save"),jr=document.getElementById("transcription"),Gt=nr.create();function nh(i){const t=i.detail;ue=kn.create({container:"#waveform",waveColor:"#FFFFFF",progressColor:"#fbbf24",url:t.args.audio_path,plugins:[Gt],dragToSeek:!0}),ir=t.args.text_path,ge.setFrameHeight()}function vs(i){return Number(i.slice(1,-1))}function Ta(i){let t=document.createElement("p");return t.id="ts-"+i.id,t.className="mt-2 ",t.innerHTML=i.tscript,t.addEventListener("dblclick",()=>{t.setAttribute("contenteditable","true"),t.focus()}),t.addEventListener("blur",()=>{t.removeAttribute("contenteditable"),Mt.find(e=>e.id==i.id).tscript=t.textContent}),t.addEventListener("click",()=>{ue.setTime(i.start)}),t}function Ke(i,t){let e=document.getElementById("ts-"+i.id);if(e!=null)if(e.classList.remove("text-[#fbbf24]","text-gray-400"),t=="in"){for(let n of Mt)if(n.start>i.start)Ke(n,"pre");else{if(n.start==i.start)continue;Ke(n,"out")}rh(i.id),e.classList.add("text-[#fbbf24]")}else t=="out"&&e.classList.add("text-gray-400")}function Ma(i){for(let t of Mt)if(t.start-i>0||t.start<i&&i<t.end)return t;return null}function Ca(){Mt.sort((i,t)=>i.start-t.start)}function rh(i){Ca();let t=Mt.findIndex(s=>s.id==i),e=t>=3?t-3:0,r=document.getElementById("ts-"+Mt[e].id).offsetTop-216;jr.scrollTop=r}function sh(i){document.getElementById("ts-"+i).remove();let e=Mt.findIndex(n=>n.id==i);e!==-1&&Mt.splice(e,1),Gt.getRegions().find(n=>n.id==i).remove()}function oh(){Ca();let i=Gt.getRegions(),t=`[0.000]
<no-speech>
`;for(let e of Mt){let n=i.find(r=>r.id==e.id);t+=`[${n.start.toLocaleString(void 0,{minimumFractionDigits:3})}]
`,t+=`${e.tscript}
`,t+=`[${n.end.toLocaleString(void 0,{minimumFractionDigits:3})}]
`,t+=`<no-speech>
`}t+=`[${ue.getDuration()}]
`,ge.setComponentValue(t)}ue.once("decode",()=>{bs.addEventListener("click",()=>{ue.playPause()}),document.addEventListener("keydown",i=>{document.activeElement.tagName!="P"&&i.code=="Space"&&document.activeElement!==bs&&(i.preventDefault(),ue.playPause())}),document.addEventListener("wheel",i=>{if(i.target.parentElement.id=="waveform")i.preventDefault();else return;Fi+=i.deltaY*-.01,Fi=Math.min(Math.max(10,Fi),100),ue.zoom(Fi)},{passive:!1}),ir!=null&&fetch(ir).then(i=>i.text()).then(i=>{const t=i.split(`
`),e=t.length;for(let n=1;n<e-1;n+=2){if(t[n]=="<no-speech>")continue;let r={start:vs(t[n-1]),end:vs(t[n+1]),color:"rgba(0, 50, 100, 0.2)",id:n,tscript:t[n]};jr.appendChild(Ta(r)),Mt.push(r),Gt.addRegion(r)}}).catch(i=>console.error(i))});Gt.enableDragSelection();Gt.on("region-in",i=>{Ke(i,"in"),setTimeout(()=>{$r=i.id},50)});Gt.on("region-out",i=>{Ke(i,"out"),$r=null});Gt.on("region-clicked",(i,t)=>{Ke(i,"in")});Gt.on("region-created",i=>{if(i.id.toString().startsWith("region")){let t={start:i.start,end:i.end,color:"rgba(0, 50, 100, 0.2)",id:i.id,tscript:"[TRANSCRIBE HERE]"};i.tscript=t.tscript,console.log(Gt.getRegions());let e=document.getElementById("ts-"+Ma(t.start).id);jr.insertBefore(Ta(t),e),Mt.push(t)}});ue.on("interaction",i=>{Ke(Ma(i),"in")});ih.addEventListener("click",oh);document.addEventListener("keydown",i=>{document.activeElement.tagName!="P"&&i.code=="Backspace"&&(i.preventDefault(),sh($r))});ge.events.addEventListener(ge.RENDER_EVENT,nh);ge.setComponentReady();ge.setFrameHeight();
